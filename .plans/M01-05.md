# M01-05 â€” OpenAI Integration Layer

Create the OpenAI API client wrapper in PHP: 1) AgentWP\AI\OpenAIClient class with methods: chat(array $messages, array $functions): Response, validateKey(string $key): bool. 2) Implement Function Calling (Tools API) with strict mode enabled. 3) Define function schemas in AgentWP\AI\Functions\* classes (one per function). 4) Retry logic with exponential backoff: initial 1s, max 60s, 10 retries, add random jitter 0-1s. 5) Handle rate limits (429), server errors (5xx), and network timeouts gracefully. 6) Stream response support for long-running queries (SSE). 7) Token counting using tiktoken-php for cost estimation. 8) Model abstraction allowing easy switching between gpt-4o and gpt-4o-mini. Acceptance Criteria: Function calls return properly structured responses, retry logic handles transient failures without user intervention, streaming works for responses >10 seconds, token counts accurate within 5%.
