All requirements from the spec are met:

**Self-review summary:**

The changes are correct and minimal:

1. **Imports added** (lines 28-29): `FunctionRegistry` and `HandlerRegistry` - follows existing import style
2. **Registration calls added** (lines 46-47): `registerFunctionRegistry()` and `registerHandlerRegistry()` called before `registerEngine()` to ensure dependencies are available
3. **`registerFunctionRegistry()` method** (lines 111-119): Registers as singleton, includes `class_exists` guard matching other registration methods
4. **`registerHandlerRegistry()` method** (lines 127-135): Registers as singleton, includes `class_exists` guard matching other registration methods
5. **`registerEngine()` updated** (lines 153-161): Now injects all 6 dependencies instead of passing `null` for `FunctionRegistry` and omitting `HandlerRegistry`

The changes are consistent with the existing code style:
- Uses arrow functions (`fn()`) for simple factories
- Uses `class_exists` guards like other registration methods
- Uses fully-qualified class names in the singleton factory closure
- Proper PHPDoc blocks

No issues found in self-review.
