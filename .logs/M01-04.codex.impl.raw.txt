Implemented a shared REST base controller with auth, rate limiting, schema validation, standardized responses, and logging; added intent/health endpoints and an OpenAPI spec to document the API.

**Status**
- DONE

**Summary of changes**
- Added base REST controller with auth, rate limiting, schema validation, response formatting, and transient logging in `src/API/RestController.php`.
- Updated settings/usage/api-key routes to use the base controller and JSON schema validation in `src/Rest/SettingsController.php`.
- Added new `/intent` and `/health` endpoints in `src/Rest/IntentController.php` and `src/Rest/HealthController.php`, and wired them with response normalization/logging in `src/Plugin.php`.
- Generated OpenAPI spec covering the REST endpoints in `docs/openapi.json`.

**How to verify**
- No format/lint/test commands provided.

**Risks / follow-ups**
- `/intent` currently returns a stub response (no AI processing yet) in `src/Rest/IntentController.php`.
- Settings/api-key schema validation is strict; unknown fields will be rejected in `src/Rest/SettingsController.php`.
- No automated tests were run (none specified).

OpenAI Codex v0.77.0 (research preview)
--------
workdir: /Users/ahmedyounis/Documents/Projects/agentwp
model: gpt-5.2-codex
provider: openai
approval: never
sandbox: workspace-write [workdir, /tmp, $TMPDIR]
reasoning effort: high
reasoning summaries: auto
session id: 019b94a4-5f87-7de2-92e0-b27fcd76231e
--------
user
You are implementing task M01-04 in this git repository.

1) Read the spec: .plans/M01-04.md
2) Read handoff/context: .t2/handoff/M01-04.md

Implement the spec fully.

Verification commands (run if non-empty):
- format: 
- lint: 
- test: 

In your final response, include:
- Status: DONE or NEEDS-REVIEW
- Summary of changes
- How to verify (exact commands)
- Risks / follow-ups

mcp startup: no servers

thinking
**Reading specification and preparing handoff**
exec
/bin/zsh -lc ls in /Users/ahmedyounis/Documents/Projects/agentwp succeeded in 33ms:
agentwp.php
assets
composer.json
docker
docker-compose.yml
docs
includes
languages
react
README.md
scripts
setup.sh
src
tasks.csv
uninstall.php
exec
/bin/zsh -lc 'cat .plans/M01-04.md' in /Users/ahmedyounis/Documents/Projects/agentwp succeeded in 54ms:
# M01-04 — REST API Framework

Build the REST API infrastructure in PHP: 1) Create AgentWP\API\RestController base class extending WP_REST_Controller with common auth, validation, and response formatting. 2) Register namespace 'agentwp/v1'. 3) Implement permission callbacks using current_user_can('manage_woocommerce'). 4) Create rate limiter using transients: 60 requests/minute per user, return 429 with Retry-After header when exceeded. 5) Endpoints to create: POST /intent (main AI endpoint), GET/POST /settings, GET /usage, GET /health. 6) Request validation with JSON schemas. 7) Standardized response format: {success: bool, data: any, error?: {code: string, message: string}}. 8) Add request logging for debugging (stored in transients, auto-expire 24h). Acceptance Criteria: All endpoints require authentication, rate limiter triggers at 61st request within 60 seconds, invalid requests return descriptive errors with correct HTTP codes, OpenAPI/Swagger spec generated.
exec
/bin/zsh -lc 'cat .t2/handoff/M01-04.md' in /Users/ahmedyounis/Documents/Projects/agentwp succeeded in 52ms:
# Handoff: M01-04

Created: 2026-01-06T18:49:18.944438Z

Spec: .plans/M01-04.md

thinking
**Preparing to implement and explore structure**
exec
/bin/zsh -lc 'rg "REST" -n src includes' in /Users/ahmedyounis/Documents/Projects/agentwp succeeded in 47ms:
src/Rest/SettingsController.php:3: * Settings REST controller.
src/Rest/SettingsController.php:13:use WP_REST_Request;
src/Rest/SettingsController.php:14:use WP_REST_Response;
src/Rest/SettingsController.php:15:use WP_REST_Server;
src/Rest/SettingsController.php:19:	 * REST namespace.
src/Rest/SettingsController.php:21:	const REST_NAMESPACE = 'agentwp/v1';
src/Rest/SettingsController.php:24:	 * Register REST routes.
src/Rest/SettingsController.php:30:			self::REST_NAMESPACE,
src/Rest/SettingsController.php:34:					'methods'             => WP_REST_Server::READABLE,
src/Rest/SettingsController.php:39:					'methods'             => WP_REST_Server::EDITABLE,
src/Rest/SettingsController.php:67:			self::REST_NAMESPACE,
src/Rest/SettingsController.php:70:				'methods'             => WP_REST_Server::EDITABLE,
src/Rest/SettingsController.php:82:			self::REST_NAMESPACE,
src/Rest/SettingsController.php:85:				'methods'             => WP_REST_Server::READABLE,
src/Rest/SettingsController.php:110:	 * @param WP_REST_Request $request Request instance.
src/Rest/SettingsController.php:111:	 * @return WP_REST_Response
src/Rest/SettingsController.php:133:	 * @param WP_REST_Request $request Request instance.
src/Rest/SettingsController.php:134:	 * @return WP_REST_Response
src/Rest/SettingsController.php:155:	 * @param WP_REST_Request $request Request instance.
src/Rest/SettingsController.php:156:	 * @return WP_REST_Response
exec
/bin/zsh -lc "sed -n '1,220p' src/Rest/SettingsController.php" in /Users/ahmedyounis/Documents/Projects/agentwp succeeded in 54ms:
<?php
/**
 * Settings REST controller.
 *
 * @package AgentWP
 */

namespace AgentWP\Rest;

use AgentWP\Plugin;
use AgentWP\Security\Encryption;
use WP_Error;
use WP_REST_Request;
use WP_REST_Response;
use WP_REST_Server;

class SettingsController {
	/**
	 * REST namespace.
	 */
exec
/bin/zsh -lc "sed -n '220,520p' src/Rest/SettingsController.php" in /Users/ahmedyounis/Documents/Projects/agentwp succeeded in 44ms:

		$usage['last_sync'] = gmdate( 'c' );
		update_option( Plugin::OPTION_USAGE_STATS, $usage, false );

		return $this->response_success(
			array(
				'period' => $period,
				'usage'  => $usage,
			)
		);
	}

	/**
	 * Read stored settings with defaults.
	 *
	 * @return array
	 */
	private function read_settings() {
		$settings = get_option( Plugin::OPTION_SETTINGS, array() );
		$settings = is_array( $settings ) ? $settings : array();

thinking
**Reviewing API structure and plugin routing**
exec
/bin/zsh -lc "sed -n '130,240p' src/Plugin.php" in /Users/ahmedyounis/Documents/Projects/agentwp succeeded in 53ms:
	public function enqueue_admin_assets( $hook_suffix ) {
		$screen = function_exists( 'get_current_screen' ) ? get_current_screen() : null;

		$is_agentwp_screen = ( $hook_suffix === $this->menu_hook );
		$is_wc_screen      = $screen ? $this->is_woocommerce_screen( $screen ) : false;

		if ( ! $is_agentwp_screen && ! $is_wc_screen ) {
			return;
		}

		$script_path = AGENTWP_PLUGIN_DIR . 'assets/agentwp-admin.js';
		$style_path  = AGENTWP_PLUGIN_DIR . 'assets/agentwp-admin.css';

		if ( file_exists( $script_path ) ) {
			wp_enqueue_script(
				'agentwp-admin',
				AGENTWP_PLUGIN_URL . 'assets/agentwp-admin.js',
				array( 'wp-element', 'wp-components', 'wp-api-fetch', 'wp-i18n' ),
				filemtime( $script_path ),
				true

thinking
**Designing base REST controller**
exec
/bin/zsh -lc 'rg "OpenAPI|Swagger|swagger" -n' in /Users/ahmedyounis/Documents/Projects/agentwp succeeded in 60ms:
tasks.csv:8:M01-04,"REST API Framework","Build the REST API infrastructure in PHP: 1) Create AgentWP\API\RestController base class extending WP_REST_Controller with common auth, validation, and response formatting. 2) Register namespace 'agentwp/v1'. 3) Implement permission callbacks using current_user_can('manage_woocommerce'). 4) Create rate limiter using transients: 60 requests/minute per user, return 429 with Retry-After header when exceeded. 5) Endpoints to create: POST /intent (main AI endpoint), GET/POST /settings, GET /usage, GET /health. 6) Request validation with JSON schemas. 7) Standardized response format: {success: bool, data: any, error?: {code: string, message: string}}. 8) Add request logging for debugging (stored in transients, auto-expire 24h). Acceptance Criteria: All endpoints require authentication, rate limiter triggers at 61st request within 60 seconds, invalid requests return descriptive errors with correct HTTP codes, OpenAPI/Swagger spec generated."
tasks.csv:34:M06-01,"Documentation Suite","Create comprehensive documentation: 1) README.md: quick start, requirements, installation, first command tutorial. 2) docs/USER-GUIDE.md: complete feature walkthrough with screenshots, common workflows, tips. 3) docs/API.md: REST endpoint reference with examples (curl and JavaScript). 4) docs/DEVELOPER.md: architecture overview, hook/filter reference, extension guide. 5) docs/FAQ.md: common questions and troubleshooting. 6) docs/CHANGELOG.md: version history following Keep a Changelog format. 7) Inline PHP documentation: DocBlocks on all public methods. 8) JSDoc comments on exported React components. 9) OpenAPI 3.0 spec generated from endpoint annotations. Acceptance Criteria: New user can install and execute first command within 10 minutes following docs, developer can build custom intent handler within 30 minutes, FAQ covers top 20 support questions."

thinking
**Checking for OpenAPI specs**
exec
/bin/zsh -lc 'rg "settings" -n src/Rest' in /Users/ahmedyounis/Documents/Projects/agentwp succeeded in 57ms:
src/Rest/SettingsController.php:31:			'/settings',
src/Rest/SettingsController.php:35:					'callback'            => array( $this, 'get_settings' ),
src/Rest/SettingsController.php:40:					'callback'            => array( $this, 'update_settings' ),
src/Rest/SettingsController.php:68:			'/settings/api-key',
src/Rest/SettingsController.php:99:	 * Permissions check for settings routes.
src/Rest/SettingsController.php:108:	 * Get settings payload.
src/Rest/SettingsController.php:113:	public function get_settings( $request ) {
src/Rest/SettingsController.php:116:		$settings = $this->read_settings();
src/Rest/SettingsController.php:122:				'settings'       => $settings,
src/Rest/SettingsController.php:131:	 * Update settings payload.
src/Rest/SettingsController.php:136:	public function update_settings( $request ) {
src/Rest/SettingsController.php:139:		$settings = $this->read_settings();
src/Rest/SettingsController.php:140:		$updated  = $this->apply_settings_updates( $settings, $payload );
src/Rest/SettingsController.php:147:				'settings' => $updated,
src/Rest/SettingsController.php:233:	 * Read stored settings with defaults.
src/Rest/SettingsController.php:237:	private function read_settings() {
src/Rest/SettingsController.php:238:		$settings = get_option( Plugin::OPTION_SETTINGS, array() );
src/Rest/SettingsController.php:239:		$settings = is_array( $settings ) ? $settings : array();
src/Rest/SettingsController.php:241:		return wp_parse_args( $settings, Plugin::get_default_settings() );
src/Rest/SettingsController.php:245:	 * Apply settings updates with sanitization.

thinking
**Designing base REST controller and features**

I'll create a base REST controller class in a new src/API folder following the spec namespace and update existing controllers to extend it. I'll include a namespace constant, implement per-user rate limiting with transients and Retry-After headers, add transient-based request logging for debugging, integrate JSON schema request validation using WP REST features, and unify success/error response formatting for consistent API behavior.
exec
/bin/zsh -lc 'rg "agentwp/v1" -n' in /Users/ahmedyounis/Documents/Projects/agentwp succeeded in 52ms:
src/Rest/SettingsController.php:21:	const REST_NAMESPACE = 'agentwp/v1';
assets/agentwp-admin.js:166:					var response = await apiFetch({ path: '/agentwp/v1/settings' });
assets/agentwp-admin.js:197:					var response = await apiFetch({ path: '/agentwp/v1/usage?period=month' });
assets/agentwp-admin.js:251:				path: '/agentwp/v1/settings',
assets/agentwp-admin.js:317:					path: '/agentwp/v1/settings/api-key',
assets/agentwp-admin.js:406:			apiFetch({ path: '/agentwp/v1/usage?period=month' })
tasks.csv:2:M00-01,"Technical Architecture Document","Create a comprehensive technical architecture document in Markdown format covering: 1) System overview diagram showing WordPress plugin structure, React frontend, PHP backend, and OpenAI API integration. 2) Database schema using only standard WooCommerce tables plus wp_options for settings (no custom tables). 3) REST API endpoint specification for /wp-json/agentwp/v1/* routes. 4) Security architecture for BYOK (Bring Your Own Key) with AES-256 encryption. 5) Data flow diagrams for the Draft-Confirm protocol. 6) Component hierarchy for React Command Deck. Save to /docs/ARCHITECTURE.md. Acceptance Criteria: Document covers all major subsystems, includes Mermaid diagrams, specifies all API endpoints with request/response schemas, and passes technical review."
tasks.csv:7:M01-03,"API Key Encryption System","Implement secure API key storage in PHP: 1) Create AgentWP\Security\Encryption class using AES-256-CTR with WordPress salts (LOGGED_IN_KEY and LOGGED_IN_SALT) as encryption materials. 2) Methods: encrypt(string $plaintext): string, decrypt(string $ciphertext): string, isEncrypted(string $data): bool. 3) Store encrypted key in wp_options table under 'agentwp_api_key'. 4) Create REST endpoint POST /agentwp/v1/settings/api-key that validates key format (sk-*), tests against OpenAI /v1/models endpoint, encrypts and stores on success. 5) Never log or expose plaintext keys. 6) Add key rotation support (re-encrypt with new salts). Acceptance Criteria: Stored key is unreadable without WordPress salts, key validation catches invalid/expired keys, encryption/decryption round-trips correctly, no plaintext keys in logs or database queries."
tasks.csv:8:M01-04,"REST API Framework","Build the REST API infrastructure in PHP: 1) Create AgentWP\API\RestController base class extending WP_REST_Controller with common auth, validation, and response formatting. 2) Register namespace 'agentwp/v1'. 3) Implement permission callbacks using current_user_can('manage_woocommerce'). 4) Create rate limiter using transients: 60 requests/minute per user, return 429 with Retry-After header when exceeded. 5) Endpoints to create: POST /intent (main AI endpoint), GET/POST /settings, GET /usage, GET /health. 6) Request validation with JSON schemas. 7) Standardized response format: {success: bool, data: any, error?: {code: string, message: string}}. 8) Add request logging for debugging (stored in transients, auto-expire 24h). Acceptance Criteria: All endpoints require authentication, rate limiter triggers at 61st request within 60 seconds, invalid requests return descriptive errors with correct HTTP codes, OpenAPI/Swagger spec generated."
tasks.csv:10:M01-06,"Command Deck Modal - Basic","Build the React modal interface (Command Deck) using React 18 and TailwindCSS: 1) Floating modal overlay with semi-transparent backdrop. 2) Trigger: global hotkey listener (Cmd+K Mac, Ctrl+K Windows), admin bar button click. 3) Visual style: Linear.app aesthetic, dark mode default, 600px max width, centered vertically. 4) Components: Omnibox (text input with placeholder 'Ask AgentWP anything...'), Stage (results area), Status Bar (latency + token cost). 5) Input handling: submit on Enter, close on Escape, focus trap within modal. 6) Loading state with skeleton animation. 7) Basic request/response flow to /agentwp/v1/intent endpoint. 8) Render markdown in responses using react-markdown. 9) Persist modal open state in session. Acceptance Criteria: Modal opens within 100ms of hotkey press, doesn't conflict with browser/OS shortcuts, closes cleanly without memory leaks, works across Chrome/Firefox/Safari/Edge, meets WCAG 2.1 AA accessibility."
tasks.csv:23:M04-01,"Typeahead Search System","Build real-time search suggestions: 1) Create searchable index in PHP: AgentWP\Search\Index class. 2) Index sources: products (name, SKU), orders (ID, customer name, email), customers (name, email). 3) REST endpoint GET /agentwp/v1/search?q={query}&types={products,orders,customers}. 4) Return top 5 results per type within 200ms. 5) React Typeahead component: debounce input (150ms), dropdown with categorized results, keyboard navigation (up/down arrows, Enter to select). 6) Show result type icon, primary text (name/ID), secondary text (SKU/email/status). 7) Clicking suggestion populates Omnibox with structured query. 8) Index updates on product/order save hooks. Acceptance Criteria: Results appear within 200ms of typing pause, handles 50k+ products without performance degradation, keyboard navigation intuitive, search terms highlighted in results."
tasks.csv:26:M04-04,"Token Cost Tracking","Implement OpenAI usage and cost tracking: 1) AgentWP\Billing\UsageTracker class. 2) Log each API call: model, input_tokens, output_tokens, timestamp, intent_type. 3) Store in custom DB table (exception to no-custom-tables rule for analytics only). 4) Calculate costs using current OpenAI pricing: gpt-4o input/output, gpt-4o-mini input/output. 5) REST endpoint GET /agentwp/v1/usage?period=day|week|month. 6) Return: total_tokens, total_cost_usd, breakdown_by_intent, daily_trend. 7) Status Bar component showing: session tokens used, session cost, account-wide monthly total. 8) Warning when approaching user-defined budget threshold. 9) Settings option to set monthly budget limit with notification. Acceptance Criteria: Token counts match OpenAI dashboard within 5%, costs calculated accurately, budget warnings trigger at 80% and 100%, usage data queryable for last 90 days."
docs/ARCHITECTURE.md:5:AgentWP is a WordPress plugin that provides a React-powered admin UI (Command Deck) and a PHP backend that integrates with WooCommerce and the OpenAI API. The plugin exposes REST endpoints under `/wp-json/agentwp/v1` and uses standard WooCommerce tables plus `wp_options` for settings and encrypted BYOK storage.
docs/ARCHITECTURE.md:20:    REST[REST API /wp-json/agentwp/v1/*]
docs/ARCHITECTURE.md:131:Base path: `/wp-json/agentwp/v1`

thinking
**Checking asset update response format**
exec
/bin/zsh -lc "sed -n '140,220p' assets/agentwp-admin.js" in /Users/ahmedyounis/Documents/Projects/agentwp succeeded in 54ms:

		var _useState8 = useState(false);
		var saving = _useState8[0];
		var setSaving = _useState8[1];

		var _useState9 = useState(null);
		var notice = _useState9[0];
		var setNotice = _useState9[1];

		var _useState10 = useState(null);
		var validationNotice = _useState10[0];
		var setValidationNotice = _useState10[1];

		var _useState11 = useState(false);
		var apiKeyBusy = _useState11[0];
		var setApiKeyBusy = _useState11[1];

		var _useState12 = useState(false);
		var usageLoading = _useState12[0];
		var setUsageLoading = _useState12[1];

thinking
**Checking API response handling and spec generation**
exec
/bin/zsh -lc 'rg "openapi" -n docs src' in /Users/ahmedyounis/Documents/Projects/agentwp exited 1 in 54ms:


thinking
**Planning OpenAPI spec creation**
exec
/bin/zsh -lc 'rg "intent" -n src' in /Users/ahmedyounis/Documents/Projects/agentwp exited 1 in 51ms:


thinking
**Designing base controller with validation and permissions**

I'm planning a base controller to handle permission checks, rate limiting, schema validation, response formatting, and logging. Since WordPress REST permissions use callbacks returning bool or WP_Error, I'll implement permission and validation logic there but also consider wrapping responses globally with a filter for consistent error formats within our plugin's namespace. This approach balances native WP behavior with the spec's requirement for standardized responses and debugging support.
exec
/bin/zsh -lc "sed -n '1,200p' src/Plugin.php" in /Users/ahmedyounis/Documents/Projects/agentwp succeeded in 50ms:
<?php
/**
 * Core plugin bootstrap.
 *
 * @package AgentWP
 */

namespace AgentWP;

class Plugin {
	const OPTION_SETTINGS     = 'agentwp_settings';
	const OPTION_API_KEY      = 'agentwp_api_key';
	const OPTION_API_KEY_LAST4 = 'agentwp_api_key_last4';
	const OPTION_BUDGET_LIMIT = 'agentwp_budget_limit';
	const OPTION_DRAFT_TTL    = 'agentwp_draft_ttl_minutes';
	const OPTION_USAGE_STATS  = 'agentwp_usage_stats';
	const TRANSIENT_PREFIX    = 'agentwp_';

	/**
	 * @var Plugin|null

thinking
**Planning REST route integration**
exec
/bin/zsh -lc 'cat composer.json' in /Users/ahmedyounis/Documents/Projects/agentwp succeeded in 54ms:
{
  "name": "agentwp/agentwp",
  "description": "AgentWP WordPress plugin.",
  "type": "wordpress-plugin",
  "license": "GPL-2.0-or-later",
  "autoload": {
    "psr-4": {
      "AgentWP\\": "src/"
    }
  },
  "require": {
    "php": ">=7.4"
  }
}


thinking
**Designing base REST controller and request handling**

I'm mapping out a new abstract RestController in src/API to unify permission checks, standardized responses, rate limiting, request logging, and schema validation for the API. This includes leveraging WP transients for rate limits and logs, implementing permission callbacks based on capabilities, and using filters like rest_request_before_callbacks and rest_post_dispatch to enforce rate limits and add headers. I'm also planning how to validate requests against JSON schemas and ensure all endpoints follow consistent error and success formats while sanitizing logged data carefully.
thinking
**Clarifying request lifecycle and controller updates**

I'm verifying the WordPress REST dispatch flow to ensure rate limiting runs before permission checks—so unauthorized requests won’t be blocked by rate limiting. I plan to log all requests in the post-dispatch filter for full coverage. I’m also refactoring SettingsController to extend the new base RestController, updating permission checks, response formats, and adding JSON schema validation for request bodies. For new endpoints like /intent and /health, I’ll create new controllers with proper validation and stub responses, keeping namespaces consistent and preparing openapi specs accordingly.
exec
/bin/zsh -lc 'rg "VERSION" -n src agentwp.php' in /Users/ahmedyounis/Documents/Projects/agentwp succeeded in 58ms:
agentwp.php:19:define( 'AGENTWP_VERSION', '0.1.0' );
src/Security/Encryption.php:11:	const VERSION = 'awp1';
src/Security/Encryption.php:58:		return self::VERSION . self::DELIMITER . $fingerprint . self::DELIMITER . base64_encode( $iv . $ciphertext );
src/Security/Encryption.php:168:		if ( 0 !== strpos( $data, self::VERSION . self::DELIMITER ) ) {
src/Security/Encryption.php:178:		if ( self::VERSION !== $version || '' === $fingerprint || '' === $payload ) {
exec
/bin/zsh -lc "sed -n '1,60p' agentwp.php" in /Users/ahmedyounis/Documents/Projects/agentwp succeeded in 55ms:
<?php
/**
 * Plugin Name: AgentWP
 * Plugin URI: https://agentwp.example
 * Description: React-powered admin UI for WooCommerce automation.
 * Version: 0.1.0
 * Requires at least: 6.4
 * Requires PHP: 7.4
 * WC requires at least: 8.0
 * Author: AgentWP
 * Text Domain: agentwp
 * Domain Path: /languages
 */

if ( ! defined( 'ABSPATH' ) ) {
	exit;
}

define( 'AGENTWP_VERSION', '0.1.0' );
define( 'AGENTWP_PLUGIN_FILE', __FILE__ );


thinking
**Designing API base controller and features**
thinking
**Preparing OpenAPI docs and coding style**
Plan update
  ✓ Review current REST controllers and plugin hooks to align new base controller, endpoints, and response/permission behavior.
  → Implement AgentWP\API\RestController, update existing SettingsController, and add new Intent/Health controllers plus plugin wiring/filters.
  • Add OpenAPI spec file documenting the new endpoints and verify responses/rate limiting/logging wiring.

thinking
**Implementing new RestController file**
file update
A /Users/ahmedyounis/Documents/Projects/agentwp/src/API/RestController.php
<?php
/**
 * Base REST controller.
 *
 * @package AgentWP
 */

namespace AgentWP\API;

use AgentWP\Plugin;
use WP_Error;
use WP_REST_Controller;
use WP_REST_Request;
use WP_REST_Response;

abstract class RestController extends WP_REST_Controller {
	const REST_NAMESPACE = 'agentwp/v1';
	const RATE_LIMIT     = 60;
	const RATE_WINDOW    = 60;
	const LOG_LIMIT      = 50;

	public function __construct() {
		$this->namespace = self::REST_NAMESPACE;
	}

	/**
	 * Permissions check for REST endpoints.
	 *
	 * @param WP_REST_Request $request Request instance.
	 * @return true|WP_Error
	 */
	public function permissions_check( $request ) {
		if ( ! current_user_can( 'manage_woocommerce' ) ) {
			return new WP_Error(
				'agentwp_forbidden',
				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
				array( 'status' => rest_authorization_required_code() )
			);
		}

		$rate_error = self::check_rate_limit( $request );
		if ( is_wp_error( $rate_error ) ) {
			return $rate_error;
		}

		return true;
	}

	/**
	 * Validate request payload against a JSON schema.
	 *
	 * @param WP_REST_Request $request Request instance.
	 * @param array           $schema JSON schema.
	 * @param string          $source Payload source ("json" or "query").
	 * @return array|WP_Error
	 */
	protected function validate_request( $request, array $schema, $source = 'json' ) {
		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
		$payload = is_array( $payload ) ? $payload : array();

		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );

		if ( is_wp_error( $valid ) ) {
			return $valid;
		}

		return $payload;
	}

	/**
	 * Build success response.
	 *
	 * @param mixed $data Response data.
	 * @param int   $status HTTP status.
	 * @return WP_REST_Response
	 */
	protected function response_success( $data, $status = 200 ) {
		$response = rest_ensure_response(
			array(
				'success' => true,
				'data'    => $data,
			)
		);

		if ( $response instanceof WP_REST_Response ) {
			$response->set_status( $status );
		}

		return $response;
	}

	/**
	 * Build error response.
	 *
	 * @param string $code Error code.
	 * @param string $message Error message.
	 * @param int    $status HTTP status.
	 * @return WP_REST_Response
	 */
	protected function response_error( $code, $message, $status = 400 ) {
		$response = rest_ensure_response(
			array(
				'success' => false,
				'data'    => array(),
				'error'   => array(
					'code'    => $code,
					'message' => $message,
				),
			)
		);

		if ( $response instanceof WP_REST_Response ) {
			$response->set_status( $status );
		}

		return $response;
	}

	/**
	 * Rate limiter using per-user transients.
	 *
	 * @param WP_REST_Request $request Request instance.
	 * @return true|WP_Error
	 */
	public static function check_rate_limit( $request ) {
		if ( ! current_user_can( 'manage_woocommerce' ) ) {
			return true;
		}

		$user_id = get_current_user_id();
		if ( $user_id <= 0 ) {
			return true;
		}

		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
		$bucket = get_transient( $key );
		$now    = time();

		if ( ! is_array( $bucket ) ) {
			$bucket = array(
				'start' => $now,
				'count' => 0,
			);
		}

		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
			$bucket = array(
				'start' => $now,
				'count' => 0,
			);
		}

		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );

			return new WP_Error(
				'agentwp_rate_limited',
				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
				array(
					'status'      => 429,
					'retry_after' => $retry_after,
				)
			);
		}

		$bucket['count'] = intval( $bucket['count'] ) + 1;
		set_transient( $key, $bucket, self::RATE_WINDOW );

		return true;
	}

	/**
	 * Log REST request metadata for debugging.
	 *
	 * @param WP_REST_Request $request Request instance.
	 * @param int             $status HTTP status.
	 * @param string          $error_code Optional error code.
	 * @return void
	 */
	public static function log_request( $request, $status, $error_code = '' ) {
		$user_id = get_current_user_id();
		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
		$logs    = get_transient( $key );
		$logs    = is_array( $logs ) ? $logs : array();

		$body      = $request->get_json_params();
		$body_keys = is_array( $body ) ? array_keys( $body ) : array();

		$entry = array(
			'time'      => gmdate( 'c' ),
			'route'     => $request->get_route(),
			'method'    => $request->get_method(),
			'status'    => intval( $status ),
			'error'     => $error_code,
			'user_id'   => intval( $user_id ),
			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
			'query'     => $request->get_query_params(),
			'body_keys' => $body_keys,
		);

		$logs[] = $entry;
		if ( count( $logs ) > self::LOG_LIMIT ) {
			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
		}

		set_transient( $key, $logs, DAY_IN_SECONDS );
	}
}
apply_patch(auto_approved=true) exited 0 in 36ms:
Success. Updated the following files:
A src/API/RestController.php
file update:
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}

file update:
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}


thinking
**Refactoring SettingsController to use base class**
file update
M /Users/ahmedyounis/Documents/Projects/agentwp/src/Rest/SettingsController.php
@@ -9,2 +9,3 @@
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
@@ -16,7 +17,3 @@
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
@@ -29,3 +26,3 @@
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
@@ -41,22 +38,2 @@
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
@@ -66,3 +43,3 @@
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
@@ -72,7 +49,2 @@
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
@@ -81,3 +53,3 @@
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
@@ -87,8 +59,2 @@
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
@@ -98,11 +64,2 @@
 	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
-	}
-
-	/**
 	 * Get settings payload.
@@ -136,2 +93,7 @@
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
@@ -158,2 +120,7 @@
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
@@ -208,2 +175,7 @@
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
@@ -369,11 +341,31 @@
 	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
-
-		return $response;
 	}
@@ -381,26 +373,34 @@
 	/**
-	 * Format error response.
+	 * Schema for API key payload.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
+	}
 
-		return $response;
+	/**
+	 * Schema for usage query params.
+	 *
+	 * @return array
+	 */
+	private function get_usage_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
+				),
+			),
+		);
 	}
apply_patch(auto_approved=true) exited 0 in 30ms:
Success. Updated the following files:
M src/Rest/SettingsController.php
file update:
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..3b7db437169bfbd79976880c92f43b6fffcf1323
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,6 +7,7 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
@@ -14,11 +15,7 @@
 use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +24,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,72 +36,32 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
 	}
 
 	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
-	}
-
-	/**
 	 * Get settings payload.
 	 *
 	 * @param WP_REST_Request $request Request instance.
@@ -134,6 +91,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +118,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +173,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -367,41 +339,69 @@
 	 * @return WP_REST_Response
 	 */
 	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
-
-		return $response;
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for API key payload.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
+	}
 
-		return $response;
+	/**
+	 * Schema for usage query params.
+	 *
+	 * @return array
+	 */
+	private function get_usage_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
+				),
+			),
+		);
 	}
 }

file update:
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..3b7db437169bfbd79976880c92f43b6fffcf1323
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,6 +7,7 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
@@ -14,11 +15,7 @@
 use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +24,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,72 +36,32 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
 	}
 
 	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
-	}
-
-	/**
 	 * Get settings payload.
 	 *
 	 * @param WP_REST_Request $request Request instance.
@@ -134,6 +91,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +118,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +173,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -367,41 +339,69 @@
 	 * @return WP_REST_Response
 	 */
 	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
-
-		return $response;
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for API key payload.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
+	}
 
-		return $response;
+	/**
+	 * Schema for usage query params.
+	 *
+	 * @return array
+	 */
+	private function get_usage_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
+				),
+			),
+		);
 	}
 }


thinking
**Checking file integrity after patch**
exec
/bin/zsh -lc "sed -n '340,520p' src/Rest/SettingsController.php" in /Users/ahmedyounis/Documents/Projects/agentwp succeeded in 45ms:
	 */
	private function response_success( array $data ) {
	private function get_settings_update_schema() {
		return array(
			'type'                 => 'object',
			'additionalProperties' => false,
			'properties'           => array(
				'model'             => array(
					'type' => 'string',
					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
				),
				'budget_limit'      => array(
					'type'    => 'number',
					'minimum' => 0,
				),
				'draft_ttl_minutes' => array(
					'type'    => 'integer',
					'minimum' => 0,
				),
				'hotkey'            => array(
file update:
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..3b7db437169bfbd79976880c92f43b6fffcf1323
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,6 +7,7 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
@@ -14,11 +15,7 @@
 use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +24,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,72 +36,32 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
 	}
 
 	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
-	}
-
-	/**
 	 * Get settings payload.
 	 *
 	 * @param WP_REST_Request $request Request instance.
@@ -134,6 +91,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +118,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +173,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -367,41 +339,69 @@
 	 * @return WP_REST_Response
 	 */
 	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
-
-		return $response;
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for API key payload.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
+	}
 
-		return $response;
+	/**
+	 * Schema for usage query params.
+	 *
+	 * @return array
+	 */
+	private function get_usage_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
+				),
+			),
+		);
 	}
 }


thinking
**Removing empty private function**
exec
/bin/zsh -lc "sed -n '300,380p' src/Rest/SettingsController.php" in /Users/ahmedyounis/Documents/Projects/agentwp succeeded in 49ms:
	 * @param string $api_key API key.
	 * @return string|WP_Error
	 */
	private function encrypt_api_key( $api_key ) {
		$encryption = new Encryption();
		$encrypted  = $encryption->encrypt( $api_key );

		if ( '' === $encrypted ) {
			return new WP_Error( 'agentwp_encryption_failed', __( 'Unable to encrypt the API key.', 'agentwp' ) );
		}

		return $encrypted;
	}

	/**
	 * Re-encrypt stored API key with current salts when needed.
	 *
	 * @return void
	 */
	private function maybe_rotate_api_key() {
file update:
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..3b7db437169bfbd79976880c92f43b6fffcf1323
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,6 +7,7 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
@@ -14,11 +15,7 @@
 use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +24,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,72 +36,32 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
 	}
 
 	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
-	}
-
-	/**
 	 * Get settings payload.
 	 *
 	 * @param WP_REST_Request $request Request instance.
@@ -134,6 +91,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +118,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +173,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -367,41 +339,69 @@
 	 * @return WP_REST_Response
 	 */
 	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
-
-		return $response;
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for API key payload.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
+	}
 
-		return $response;
+	/**
+	 * Schema for usage query params.
+	 *
+	 * @return array
+	 */
+	private function get_usage_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
+				),
+			),
+		);
 	}
 }


thinking
**Cleaning up leftover code and adding doc comment**
file update
M /Users/ahmedyounis/Documents/Projects/agentwp/src/Rest/SettingsController.php
@@ -335,8 +335,6 @@
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
 	private function get_settings_update_schema() {
apply_patch(auto_approved=true) exited 0 in 39ms:
Success. Updated the following files:
M src/Rest/SettingsController.php
file update:
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..0ea7d9a4c7c3d863f65832d3fcdbfcc68812dbc2
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,6 +7,7 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
@@ -14,11 +15,7 @@
 use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +24,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +36,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +91,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +118,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +173,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +333,73 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
+	}
 
-		return $response;
+	/**
+	 * Schema for API key payload.
+	 *
+	 * @return array
+	 */
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
+				),
+			),
+		);
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for usage query params.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_usage_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
 	}
 }

file update:
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..0ea7d9a4c7c3d863f65832d3fcdbfcc68812dbc2
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,6 +7,7 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
@@ -14,11 +15,7 @@
 use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +24,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +36,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +91,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +118,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +173,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +333,73 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
+	}
 
-		return $response;
+	/**
+	 * Schema for API key payload.
+	 *
+	 * @return array
+	 */
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
+				),
+			),
+		);
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for usage query params.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_usage_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
 	}
 }


thinking
**Adding new REST controllers and intent schema**

I'm cleaning up unused imports like WP_REST_Response, then planning to create `IntentController` and `HealthController` PHP classes with REST routes. For intent creation, I’ll implement validation using a JSON schema requiring a 'prompt' string, allowing optional 'context' and 'metadata' objects, and respond with a generated UUID and status. I’m deciding to keep the response minimal without echoing the prompt back.
file update
A /Users/ahmedyounis/Documents/Projects/agentwp/src/Rest/IntentController.php
<?php
/**
 * Intent REST controller.
 *
 * @package AgentWP
 */

namespace AgentWP\Rest;

use AgentWP\API\RestController;
use WP_REST_Request;
use WP_REST_Server;

class IntentController extends RestController {
	/**
	 * Register REST routes.
	 *
	 * @return void
	 */
	public function register_routes() {
		register_rest_route(
			$this->namespace,
			'/intent',
			array(
				'methods'             => WP_REST_Server::CREATABLE,
				'callback'            => array( $this, 'create_intent' ),
				'permission_callback' => array( $this, 'permissions_check' ),
			)
		);
	}

	/**
	 * Handle intent requests.
	 *
	 * @param WP_REST_Request $request Request instance.
	 * @return \WP_REST_Response
	 */
	public function create_intent( $request ) {
		$validation = $this->validate_request( $request, $this->get_intent_schema() );
		if ( is_wp_error( $validation ) ) {
			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
		}

		return $this->response_success(
			array(
				'intent_id' => wp_generate_uuid4(),
				'status'    => 'received',
				'message'   => __( 'Intent received for processing.', 'agentwp' ),
			)
		);
	}

	/**
	 * Schema for intent payload.
	 *
	 * @return array
	 */
	private function get_intent_schema() {
		return array(
			'type'                 => 'object',
			'additionalProperties' => false,
			'required'             => array( 'prompt' ),
			'properties'           => array(
				'prompt'   => array(
					'type'      => 'string',
					'minLength' => 1,
				),
				'context'  => array(
					'type' => 'object',
				),
				'metadata' => array(
					'type' => 'object',
				),
			),
		);
	}
}
apply_patch(auto_approved=true) exited 0 in 49ms:
Success. Updated the following files:
A src/Rest/IntentController.php
file update:
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..966a5d28f44e2459f3199e1ea2757e352af4a4ab
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,77 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..0ea7d9a4c7c3d863f65832d3fcdbfcc68812dbc2
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,6 +7,7 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
@@ -14,11 +15,7 @@
 use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +24,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +36,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +91,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +118,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +173,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +333,73 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
+	}
 
-		return $response;
+	/**
+	 * Schema for API key payload.
+	 *
+	 * @return array
+	 */
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
+				),
+			),
+		);
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for usage query params.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_usage_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
 	}
 }

file update:
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..966a5d28f44e2459f3199e1ea2757e352af4a4ab
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,77 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..0ea7d9a4c7c3d863f65832d3fcdbfcc68812dbc2
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,6 +7,7 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
@@ -14,11 +15,7 @@
 use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +24,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +36,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +91,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +118,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +173,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +333,73 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
+	}
 
-		return $response;
+	/**
+	 * Schema for API key payload.
+	 *
+	 * @return array
+	 */
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
+				),
+			),
+		);
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for usage query params.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_usage_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
 	}
 }


thinking
**Starting review of HealthController**
file update
A /Users/ahmedyounis/Documents/Projects/agentwp/src/Rest/HealthController.php
<?php
/**
 * Health REST controller.
 *
 * @package AgentWP
 */

namespace AgentWP\Rest;

use AgentWP\API\RestController;
use WP_REST_Request;
use WP_REST_Server;

class HealthController extends RestController {
	/**
	 * Register REST routes.
	 *
	 * @return void
	 */
	public function register_routes() {
		register_rest_route(
			$this->namespace,
			'/health',
			array(
				'methods'             => WP_REST_Server::READABLE,
				'callback'            => array( $this, 'get_health' ),
				'permission_callback' => array( $this, 'permissions_check' ),
			)
		);
	}

	/**
	 * Return health status.
	 *
	 * @param WP_REST_Request $request Request instance.
	 * @return \WP_REST_Response
	 */
	public function get_health( $request ) {
		return $this->response_success(
			array(
				'status'  => 'ok',
				'time'    => gmdate( 'c' ),
				'version' => defined( 'AGENTWP_VERSION' ) ? AGENTWP_VERSION : '',
			)
		);
	}
}
apply_patch(auto_approved=true) exited 0 in 52ms:
Success. Updated the following files:
A src/Rest/HealthController.php
file update:
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Rest/HealthController.php b/src/Rest/HealthController.php
new file mode 100644
index 0000000000000000000000000000000000000000..4895348e00e2a1fd0e544e52c52a986c07050caa
--- /dev/null
+++ b/src/Rest/HealthController.php
@@ -0,0 +1,47 @@
+<?php
+/**
+ * Health REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class HealthController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/health',
+			array(
+				'methods'             => WP_REST_Server::READABLE,
+				'callback'            => array( $this, 'get_health' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Return health status.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function get_health( $request ) {
+		return $this->response_success(
+			array(
+				'status'  => 'ok',
+				'time'    => gmdate( 'c' ),
+				'version' => defined( 'AGENTWP_VERSION' ) ? AGENTWP_VERSION : '',
+			)
+		);
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..966a5d28f44e2459f3199e1ea2757e352af4a4ab
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,77 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..0ea7d9a4c7c3d863f65832d3fcdbfcc68812dbc2
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,6 +7,7 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
@@ -14,11 +15,7 @@
 use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +24,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +36,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +91,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +118,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +173,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +333,73 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
+	}
 
-		return $response;
+	/**
+	 * Schema for API key payload.
+	 *
+	 * @return array
+	 */
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
+				),
+			),
+		);
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for usage query params.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_usage_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
 	}
 }

file update:
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Rest/HealthController.php b/src/Rest/HealthController.php
new file mode 100644
index 0000000000000000000000000000000000000000..4895348e00e2a1fd0e544e52c52a986c07050caa
--- /dev/null
+++ b/src/Rest/HealthController.php
@@ -0,0 +1,47 @@
+<?php
+/**
+ * Health REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class HealthController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/health',
+			array(
+				'methods'             => WP_REST_Server::READABLE,
+				'callback'            => array( $this, 'get_health' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Return health status.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function get_health( $request ) {
+		return $this->response_success(
+			array(
+				'status'  => 'ok',
+				'time'    => gmdate( 'c' ),
+				'version' => defined( 'AGENTWP_VERSION' ) ? AGENTWP_VERSION : '',
+			)
+		);
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..966a5d28f44e2459f3199e1ea2757e352af4a4ab
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,77 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..0ea7d9a4c7c3d863f65832d3fcdbfcc68812dbc2
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,6 +7,7 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
@@ -14,11 +15,7 @@
 use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +24,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +36,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +91,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +118,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +173,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +333,73 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
+	}
 
-		return $response;
+	/**
+	 * Schema for API key payload.
+	 *
+	 * @return array
+	 */
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
+				),
+			),
+		);
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for usage query params.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_usage_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
 	}
 }


thinking
**Enhancing REST route registration**
file update
M /Users/ahmedyounis/Documents/Projects/agentwp/src/Plugin.php
@@ -75,2 +75,3 @@
 		add_action( 'rest_api_init', array( $this, 'register_rest_routes' ) );
+		add_filter( 'rest_post_dispatch', array( $this, 'format_rest_response' ), 10, 3 );
 	}
@@ -185,2 +186,92 @@
 		}
+
+		if ( class_exists( 'AgentWP\\Rest\\IntentController' ) ) {
+			$controller = new Rest\IntentController();
+			$controller->register_routes();
+		}
+
+		if ( class_exists( 'AgentWP\\Rest\\HealthController' ) ) {
+			$controller = new Rest\HealthController();
+			$controller->register_routes();
+		}
+	}
+
+	/**
+	 * Normalize REST responses and log requests.
+	 *
+	 * @param mixed           $result Response value.
+	 * @param \WP_REST_Server $server REST server instance.
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return mixed
+	 */
+	public function format_rest_response( $result, $server, $request ) {
+		if ( ! $this->is_agentwp_route( $request ) ) {
+			return $result;
+		}
+
+		$status     = 200;
+		$error_code = '';
+
+		if ( is_wp_error( $result ) ) {
+			$error_code = $result->get_error_code();
+			$message    = $result->get_error_message();
+			$data       = $result->get_error_data();
+			$status     = ( is_array( $data ) && isset( $data['status'] ) ) ? intval( $data['status'] ) : 500;
+
+			$response = rest_ensure_response(
+				array(
+					'success' => false,
+					'data'    => array(),
+					'error'   => array(
+						'code'    => $error_code,
+						'message' => $message,
+					),
+				)
+			);
+
+			if ( $response instanceof \WP_REST_Response ) {
+				$response->set_status( $status );
+				if ( is_array( $data ) && isset( $data['retry_after'] ) ) {
+					$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+				}
+			}
+
+			$result = $response;
+		} elseif ( $result instanceof \WP_REST_Response ) {
+			$status = $result->get_status();
+			$body   = $result->get_data();
+			if ( is_array( $body ) && isset( $body['error']['code'] ) ) {
+				$error_code = (string) $body['error']['code'];
+			}
+		} else {
+			$result = rest_ensure_response(
+				array(
+					'success' => true,
+					'data'    => $result,
+				)
+			);
+
+			if ( $result instanceof \WP_REST_Response ) {
+				$status = $result->get_status();
+			}
+		}
+
+		if ( class_exists( 'AgentWP\\API\\RestController' ) ) {
+			API\RestController::log_request( $request, $status, $error_code );
+		}
+
+		return $result;
+	}
+
+	/**
+	 * Check whether request targets AgentWP REST routes.
+	 *
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return bool
+	 */
+	private function is_agentwp_route( $request ) {
+		$route = $request->get_route();
+		$route = is_string( $route ) ? $route : '';
+
+		return ( 0 === strpos( $route, '/' . API\RestController::REST_NAMESPACE ) );
 	}
apply_patch(auto_approved=true) exited 0 in 35ms:
Success. Updated the following files:
M src/Plugin.php
file update:
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Plugin.php b/src/Plugin.php
index 98ff7ef58454d6f962b466d44ec14f8341d83ba0..5fe2ce7777091ff9d5d68add118e7e9db98ca1a1
--- a/src/Plugin.php
+++ b/src/Plugin.php
@@ -73,6 +73,7 @@
 		add_action( 'admin_menu', array( $this, 'register_menu' ) );
 		add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_admin_assets' ) );
 		add_action( 'rest_api_init', array( $this, 'register_rest_routes' ) );
+		add_filter( 'rest_post_dispatch', array( $this, 'format_rest_response' ), 10, 3 );
 	}
 
 	/**
@@ -183,6 +184,96 @@
 			$controller = new Rest\SettingsController();
 			$controller->register_routes();
 		}
+
+		if ( class_exists( 'AgentWP\\Rest\\IntentController' ) ) {
+			$controller = new Rest\IntentController();
+			$controller->register_routes();
+		}
+
+		if ( class_exists( 'AgentWP\\Rest\\HealthController' ) ) {
+			$controller = new Rest\HealthController();
+			$controller->register_routes();
+		}
+	}
+
+	/**
+	 * Normalize REST responses and log requests.
+	 *
+	 * @param mixed           $result Response value.
+	 * @param \WP_REST_Server $server REST server instance.
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return mixed
+	 */
+	public function format_rest_response( $result, $server, $request ) {
+		if ( ! $this->is_agentwp_route( $request ) ) {
+			return $result;
+		}
+
+		$status     = 200;
+		$error_code = '';
+
+		if ( is_wp_error( $result ) ) {
+			$error_code = $result->get_error_code();
+			$message    = $result->get_error_message();
+			$data       = $result->get_error_data();
+			$status     = ( is_array( $data ) && isset( $data['status'] ) ) ? intval( $data['status'] ) : 500;
+
+			$response = rest_ensure_response(
+				array(
+					'success' => false,
+					'data'    => array(),
+					'error'   => array(
+						'code'    => $error_code,
+						'message' => $message,
+					),
+				)
+			);
+
+			if ( $response instanceof \WP_REST_Response ) {
+				$response->set_status( $status );
+				if ( is_array( $data ) && isset( $data['retry_after'] ) ) {
+					$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+				}
+			}
+
+			$result = $response;
+		} elseif ( $result instanceof \WP_REST_Response ) {
+			$status = $result->get_status();
+			$body   = $result->get_data();
+			if ( is_array( $body ) && isset( $body['error']['code'] ) ) {
+				$error_code = (string) $body['error']['code'];
+			}
+		} else {
+			$result = rest_ensure_response(
+				array(
+					'success' => true,
+					'data'    => $result,
+				)
+			);
+
+			if ( $result instanceof \WP_REST_Response ) {
+				$status = $result->get_status();
+			}
+		}
+
+		if ( class_exists( 'AgentWP\\API\\RestController' ) ) {
+			API\RestController::log_request( $request, $status, $error_code );
+		}
+
+		return $result;
+	}
+
+	/**
+	 * Check whether request targets AgentWP REST routes.
+	 *
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return bool
+	 */
+	private function is_agentwp_route( $request ) {
+		$route = $request->get_route();
+		$route = is_string( $route ) ? $route : '';
+
+		return ( 0 === strpos( $route, '/' . API\RestController::REST_NAMESPACE ) );
 	}
 
 	/**
diff --git a/src/Rest/HealthController.php b/src/Rest/HealthController.php
new file mode 100644
index 0000000000000000000000000000000000000000..4895348e00e2a1fd0e544e52c52a986c07050caa
--- /dev/null
+++ b/src/Rest/HealthController.php
@@ -0,0 +1,47 @@
+<?php
+/**
+ * Health REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class HealthController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/health',
+			array(
+				'methods'             => WP_REST_Server::READABLE,
+				'callback'            => array( $this, 'get_health' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Return health status.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function get_health( $request ) {
+		return $this->response_success(
+			array(
+				'status'  => 'ok',
+				'time'    => gmdate( 'c' ),
+				'version' => defined( 'AGENTWP_VERSION' ) ? AGENTWP_VERSION : '',
+			)
+		);
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..966a5d28f44e2459f3199e1ea2757e352af4a4ab
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,77 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..0ea7d9a4c7c3d863f65832d3fcdbfcc68812dbc2
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,6 +7,7 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
@@ -14,11 +15,7 @@
 use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +24,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +36,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +91,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +118,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +173,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +333,73 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
+	}
 
-		return $response;
+	/**
+	 * Schema for API key payload.
+	 *
+	 * @return array
+	 */
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
+				),
+			),
+		);
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for usage query params.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_usage_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
 	}
 }

file update:
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Plugin.php b/src/Plugin.php
index 98ff7ef58454d6f962b466d44ec14f8341d83ba0..5fe2ce7777091ff9d5d68add118e7e9db98ca1a1
--- a/src/Plugin.php
+++ b/src/Plugin.php
@@ -73,6 +73,7 @@
 		add_action( 'admin_menu', array( $this, 'register_menu' ) );
 		add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_admin_assets' ) );
 		add_action( 'rest_api_init', array( $this, 'register_rest_routes' ) );
+		add_filter( 'rest_post_dispatch', array( $this, 'format_rest_response' ), 10, 3 );
 	}
 
 	/**
@@ -183,6 +184,96 @@
 			$controller = new Rest\SettingsController();
 			$controller->register_routes();
 		}
+
+		if ( class_exists( 'AgentWP\\Rest\\IntentController' ) ) {
+			$controller = new Rest\IntentController();
+			$controller->register_routes();
+		}
+
+		if ( class_exists( 'AgentWP\\Rest\\HealthController' ) ) {
+			$controller = new Rest\HealthController();
+			$controller->register_routes();
+		}
+	}
+
+	/**
+	 * Normalize REST responses and log requests.
+	 *
+	 * @param mixed           $result Response value.
+	 * @param \WP_REST_Server $server REST server instance.
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return mixed
+	 */
+	public function format_rest_response( $result, $server, $request ) {
+		if ( ! $this->is_agentwp_route( $request ) ) {
+			return $result;
+		}
+
+		$status     = 200;
+		$error_code = '';
+
+		if ( is_wp_error( $result ) ) {
+			$error_code = $result->get_error_code();
+			$message    = $result->get_error_message();
+			$data       = $result->get_error_data();
+			$status     = ( is_array( $data ) && isset( $data['status'] ) ) ? intval( $data['status'] ) : 500;
+
+			$response = rest_ensure_response(
+				array(
+					'success' => false,
+					'data'    => array(),
+					'error'   => array(
+						'code'    => $error_code,
+						'message' => $message,
+					),
+				)
+			);
+
+			if ( $response instanceof \WP_REST_Response ) {
+				$response->set_status( $status );
+				if ( is_array( $data ) && isset( $data['retry_after'] ) ) {
+					$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+				}
+			}
+
+			$result = $response;
+		} elseif ( $result instanceof \WP_REST_Response ) {
+			$status = $result->get_status();
+			$body   = $result->get_data();
+			if ( is_array( $body ) && isset( $body['error']['code'] ) ) {
+				$error_code = (string) $body['error']['code'];
+			}
+		} else {
+			$result = rest_ensure_response(
+				array(
+					'success' => true,
+					'data'    => $result,
+				)
+			);
+
+			if ( $result instanceof \WP_REST_Response ) {
+				$status = $result->get_status();
+			}
+		}
+
+		if ( class_exists( 'AgentWP\\API\\RestController' ) ) {
+			API\RestController::log_request( $request, $status, $error_code );
+		}
+
+		return $result;
+	}
+
+	/**
+	 * Check whether request targets AgentWP REST routes.
+	 *
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return bool
+	 */
+	private function is_agentwp_route( $request ) {
+		$route = $request->get_route();
+		$route = is_string( $route ) ? $route : '';
+
+		return ( 0 === strpos( $route, '/' . API\RestController::REST_NAMESPACE ) );
 	}
 
 	/**
diff --git a/src/Rest/HealthController.php b/src/Rest/HealthController.php
new file mode 100644
index 0000000000000000000000000000000000000000..4895348e00e2a1fd0e544e52c52a986c07050caa
--- /dev/null
+++ b/src/Rest/HealthController.php
@@ -0,0 +1,47 @@
+<?php
+/**
+ * Health REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class HealthController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/health',
+			array(
+				'methods'             => WP_REST_Server::READABLE,
+				'callback'            => array( $this, 'get_health' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Return health status.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function get_health( $request ) {
+		return $this->response_success(
+			array(
+				'status'  => 'ok',
+				'time'    => gmdate( 'c' ),
+				'version' => defined( 'AGENTWP_VERSION' ) ? AGENTWP_VERSION : '',
+			)
+		);
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..966a5d28f44e2459f3199e1ea2757e352af4a4ab
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,77 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..0ea7d9a4c7c3d863f65832d3fcdbfcc68812dbc2
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,6 +7,7 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
@@ -14,11 +15,7 @@
 use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +24,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +36,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +91,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +118,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +173,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +333,73 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
+	}
 
-		return $response;
+	/**
+	 * Schema for API key payload.
+	 *
+	 * @return array
+	 */
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
+				),
+			),
+		);
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for usage query params.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_usage_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
 	}
 }


thinking
**Reviewing API and controller references**
exec
/bin/zsh -lc "sed -n '1,200p' src/Rest/SettingsController.php" in /Users/ahmedyounis/Documents/Projects/agentwp succeeded in 48ms:
<?php
/**
 * Settings REST controller.
 *
 * @package AgentWP
 */

namespace AgentWP\Rest;

use AgentWP\API\RestController;
use AgentWP\Plugin;
use AgentWP\Security\Encryption;
use WP_Error;
use WP_REST_Request;
use WP_REST_Response;
use WP_REST_Server;

class SettingsController extends RestController {

	/**
file update:
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Plugin.php b/src/Plugin.php
index 98ff7ef58454d6f962b466d44ec14f8341d83ba0..5fe2ce7777091ff9d5d68add118e7e9db98ca1a1
--- a/src/Plugin.php
+++ b/src/Plugin.php
@@ -73,6 +73,7 @@
 		add_action( 'admin_menu', array( $this, 'register_menu' ) );
 		add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_admin_assets' ) );
 		add_action( 'rest_api_init', array( $this, 'register_rest_routes' ) );
+		add_filter( 'rest_post_dispatch', array( $this, 'format_rest_response' ), 10, 3 );
 	}
 
 	/**
@@ -183,6 +184,96 @@
 			$controller = new Rest\SettingsController();
 			$controller->register_routes();
 		}
+
+		if ( class_exists( 'AgentWP\\Rest\\IntentController' ) ) {
+			$controller = new Rest\IntentController();
+			$controller->register_routes();
+		}
+
+		if ( class_exists( 'AgentWP\\Rest\\HealthController' ) ) {
+			$controller = new Rest\HealthController();
+			$controller->register_routes();
+		}
+	}
+
+	/**
+	 * Normalize REST responses and log requests.
+	 *
+	 * @param mixed           $result Response value.
+	 * @param \WP_REST_Server $server REST server instance.
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return mixed
+	 */
+	public function format_rest_response( $result, $server, $request ) {
+		if ( ! $this->is_agentwp_route( $request ) ) {
+			return $result;
+		}
+
+		$status     = 200;
+		$error_code = '';
+
+		if ( is_wp_error( $result ) ) {
+			$error_code = $result->get_error_code();
+			$message    = $result->get_error_message();
+			$data       = $result->get_error_data();
+			$status     = ( is_array( $data ) && isset( $data['status'] ) ) ? intval( $data['status'] ) : 500;
+
+			$response = rest_ensure_response(
+				array(
+					'success' => false,
+					'data'    => array(),
+					'error'   => array(
+						'code'    => $error_code,
+						'message' => $message,
+					),
+				)
+			);
+
+			if ( $response instanceof \WP_REST_Response ) {
+				$response->set_status( $status );
+				if ( is_array( $data ) && isset( $data['retry_after'] ) ) {
+					$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+				}
+			}
+
+			$result = $response;
+		} elseif ( $result instanceof \WP_REST_Response ) {
+			$status = $result->get_status();
+			$body   = $result->get_data();
+			if ( is_array( $body ) && isset( $body['error']['code'] ) ) {
+				$error_code = (string) $body['error']['code'];
+			}
+		} else {
+			$result = rest_ensure_response(
+				array(
+					'success' => true,
+					'data'    => $result,
+				)
+			);
+
+			if ( $result instanceof \WP_REST_Response ) {
+				$status = $result->get_status();
+			}
+		}
+
+		if ( class_exists( 'AgentWP\\API\\RestController' ) ) {
+			API\RestController::log_request( $request, $status, $error_code );
+		}
+
+		return $result;
+	}
+
+	/**
+	 * Check whether request targets AgentWP REST routes.
+	 *
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return bool
+	 */
+	private function is_agentwp_route( $request ) {
+		$route = $request->get_route();
+		$route = is_string( $route ) ? $route : '';
+
+		return ( 0 === strpos( $route, '/' . API\RestController::REST_NAMESPACE ) );
 	}
 
 	/**
diff --git a/src/Rest/HealthController.php b/src/Rest/HealthController.php
new file mode 100644
index 0000000000000000000000000000000000000000..4895348e00e2a1fd0e544e52c52a986c07050caa
--- /dev/null
+++ b/src/Rest/HealthController.php
@@ -0,0 +1,47 @@
+<?php
+/**
+ * Health REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class HealthController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/health',
+			array(
+				'methods'             => WP_REST_Server::READABLE,
+				'callback'            => array( $this, 'get_health' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Return health status.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function get_health( $request ) {
+		return $this->response_success(
+			array(
+				'status'  => 'ok',
+				'time'    => gmdate( 'c' ),
+				'version' => defined( 'AGENTWP_VERSION' ) ? AGENTWP_VERSION : '',
+			)
+		);
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..966a5d28f44e2459f3199e1ea2757e352af4a4ab
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,77 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..0ea7d9a4c7c3d863f65832d3fcdbfcc68812dbc2
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,6 +7,7 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
@@ -14,11 +15,7 @@
 use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +24,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +36,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +91,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +118,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +173,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +333,73 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
+	}
 
-		return $response;
+	/**
+	 * Schema for API key payload.
+	 *
+	 * @return array
+	 */
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
+				),
+			),
+		);
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for usage query params.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_usage_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
 	}
 }


thinking
**Preparing OpenAPI specification**

I'm starting to build a minimal OpenAPI JSON file for the REST API, deciding on formatting and including key paths and components like security schemes and standard response schemas for clarity and documentation.
file update
A /Users/ahmedyounis/Documents/Projects/agentwp/docs/openapi.json
{
  "openapi": "3.0.3",
  "info": {
    "title": "AgentWP REST API",
    "version": "0.1.0",
    "description": "OpenAPI specification for AgentWP REST endpoints."
  },
  "servers": [
    {
      "url": "/wp-json"
    }
  ],
  "paths": {
    "/agentwp/v1/intent": {
      "post": {
        "summary": "Submit an intent",
        "security": [
          {
            "nonceAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/IntentRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Intent accepted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/IntentResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid payload",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "429": {
            "description": "Rate limit exceeded",
            "headers": {
              "Retry-After": {
                "schema": {
                  "type": "integer"
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/agentwp/v1/settings": {
      "get": {
        "summary": "Get settings",
        "security": [
          {
            "nonceAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Settings payload",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SettingsResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Update settings",
        "security": [
          {
            "nonceAuth": []
          }
        ],
        "requestBody": {
          "required": false,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SettingsUpdateRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Updated settings",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SettingsResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid payload",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/agentwp/v1/settings/api-key": {
      "post": {
        "summary": "Store OpenAI API key",
        "security": [
          {
            "nonceAuth": []
          }
        ],
        "requestBody": {
          "required": false,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ApiKeyRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "API key stored",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiKeyResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid API key",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/agentwp/v1/usage": {
      "get": {
        "summary": "Get usage stats",
        "security": [
          {
            "nonceAuth": []
          }
        ],
        "parameters": [
          {
            "name": "period",
            "in": "query",
            "schema": {
              "type": "string",
              "enum": [
                "day",
                "week",
                "month"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Usage stats",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UsageResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid period",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/agentwp/v1/health": {
      "get": {
        "summary": "Health check",
        "security": [
          {
            "nonceAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Health status",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthResponse"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "nonceAuth": {
        "type": "apiKey",
        "in": "header",
        "name": "X-WP-Nonce"
      }
    },
    "schemas": {
      "StandardResponse": {
        "type": "object",
        "required": [
          "success",
          "data"
        ],
        "properties": {
          "success": {
            "type": "boolean"
          },
          "data": {},
          "error": {
            "$ref": "#/components/schemas/ErrorObject"
          }
        }
      },
      "ErrorObject": {
        "type": "object",
        "required": [
          "code",
          "message"
        ],
        "properties": {
          "code": {
            "type": "string"
          },
          "message": {
            "type": "string"
          }
        }
      },
      "ErrorResponse": {
        "allOf": [
          {
            "$ref": "#/components/schemas/StandardResponse"
          }
        ]
      },
      "Settings": {
        "type": "object",
        "properties": {
          "model": {
            "type": "string"
          },
          "budget_limit": {
            "type": "number"
          },
          "draft_ttl_minutes": {
            "type": "integer"
          },
          "hotkey": {
            "type": "string"
          },
          "theme": {
            "type": "string"
          }
        }
      },
      "SettingsResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean"
          },
          "data": {
            "type": "object",
            "properties": {
              "settings": {
                "$ref": "#/components/schemas/Settings"
              },
              "api_key_last4": {
                "type": "string"
              },
              "has_api_key": {
                "type": "boolean"
              },
              "api_key_status": {
                "type": "string"
              },
              "updated": {
                "type": "boolean"
              },
              "period": {
                "type": "string"
              },
              "usage": {
                "$ref": "#/components/schemas/Usage"
              }
            }
          }
        }
      },
      "SettingsUpdateRequest": {
        "type": "object",
        "properties": {
          "model": {
            "type": "string",
            "enum": [
              "gpt-4o",
              "gpt-4o-mini"
            ]
          },
          "budget_limit": {
            "type": "number",
            "minimum": 0
          },
          "draft_ttl_minutes": {
            "type": "integer",
            "minimum": 0
          },
          "hotkey": {
            "type": "string"
          },
          "theme": {
            "type": "string",
            "enum": [
              "light",
              "dark"
            ]
          },
          "dark_mode": {
            "type": "boolean"
          }
        }
      },
      "ApiKeyRequest": {
        "type": "object",
        "properties": {
          "api_key": {
            "type": "string"
          }
        }
      },
      "ApiKeyResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean"
          },
          "data": {
            "type": "object",
            "properties": {
              "stored": {
                "type": "boolean"
              },
              "last4": {
                "type": "string"
              }
            }
          }
        }
      },
      "Usage": {
        "type": "object",
        "properties": {
          "total_commands_month": {
            "type": "integer"
          },
          "estimated_cost": {
            "type": "number"
          },
          "last_sync": {
            "type": "string"
          }
        }
      },
      "UsageResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean"
          },
          "data": {
            "type": "object",
            "properties": {
              "period": {
                "type": "string"
              },
              "usage": {
                "$ref": "#/components/schemas/Usage"
              }
            }
          }
        }
      },
      "IntentRequest": {
        "type": "object",
        "required": [
          "prompt"
        ],
        "properties": {
          "prompt": {
            "type": "string"
          },
          "context": {
            "type": "object"
          },
          "metadata": {
            "type": "object"
          }
        }
      },
      "IntentResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean"
          },
          "data": {
            "type": "object",
            "properties": {
              "intent_id": {
                "type": "string"
              },
              "status": {
                "type": "string"
              },
              "message": {
                "type": "string"
              }
            }
          }
        }
      },
      "HealthResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean"
          },
          "data": {
            "type": "object",
            "properties": {
              "status": {
                "type": "string"
              },
              "time": {
                "type": "string"
              },
              "version": {
                "type": "string"
              }
            }
          }
        }
      }
    }
  }
}
apply_patch(auto_approved=true) exited 0 in 66ms:
Success. Updated the following files:
A docs/openapi.json
file update:
diff --git a/docs/openapi.json b/docs/openapi.json
new file mode 100644
index 0000000000000000000000000000000000000000..849f15d93104fabd8a394dc4195b96a609c010a0
--- /dev/null
+++ b/docs/openapi.json
@@ -0,0 +1,503 @@
+{
+  "openapi": "3.0.3",
+  "info": {
+    "title": "AgentWP REST API",
+    "version": "0.1.0",
+    "description": "OpenAPI specification for AgentWP REST endpoints."
+  },
+  "servers": [
+    {
+      "url": "/wp-json"
+    }
+  ],
+  "paths": {
+    "/agentwp/v1/intent": {
+      "post": {
+        "summary": "Submit an intent",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": true,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/IntentRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Intent accepted",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/IntentResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          },
+          "429": {
+            "description": "Rate limit exceeded",
+            "headers": {
+              "Retry-After": {
+                "schema": {
+                  "type": "integer"
+                }
+              }
+            },
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings": {
+      "get": {
+        "summary": "Get settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Settings payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          }
+        }
+      },
+      "post": {
+        "summary": "Update settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/SettingsUpdateRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Updated settings",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings/api-key": {
+      "post": {
+        "summary": "Store OpenAI API key",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/ApiKeyRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "API key stored",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ApiKeyResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid API key",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/usage": {
+      "get": {
+        "summary": "Get usage stats",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "parameters": [
+          {
+            "name": "period",
+            "in": "query",
+            "schema": {
+              "type": "string",
+              "enum": [
+                "day",
+                "week",
+                "month"
+              ]
+            }
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Usage stats",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/UsageResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid period",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/health": {
+      "get": {
+        "summary": "Health check",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Health status",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/HealthResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    }
+  },
+  "components": {
+    "securitySchemes": {
+      "nonceAuth": {
+        "type": "apiKey",
+        "in": "header",
+        "name": "X-WP-Nonce"
+      }
+    },
+    "schemas": {
+      "StandardResponse": {
+        "type": "object",
+        "required": [
+          "success",
+          "data"
+        ],
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {},
+          "error": {
+            "$ref": "#/components/schemas/ErrorObject"
+          }
+        }
+      },
+      "ErrorObject": {
+        "type": "object",
+        "required": [
+          "code",
+          "message"
+        ],
+        "properties": {
+          "code": {
+            "type": "string"
+          },
+          "message": {
+            "type": "string"
+          }
+        }
+      },
+      "ErrorResponse": {
+        "allOf": [
+          {
+            "$ref": "#/components/schemas/StandardResponse"
+          }
+        ]
+      },
+      "Settings": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string"
+          },
+          "budget_limit": {
+            "type": "number"
+          },
+          "draft_ttl_minutes": {
+            "type": "integer"
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string"
+          }
+        }
+      },
+      "SettingsResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "settings": {
+                "$ref": "#/components/schemas/Settings"
+              },
+              "api_key_last4": {
+                "type": "string"
+              },
+              "has_api_key": {
+                "type": "boolean"
+              },
+              "api_key_status": {
+                "type": "string"
+              },
+              "updated": {
+                "type": "boolean"
+              },
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "SettingsUpdateRequest": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string",
+            "enum": [
+              "gpt-4o",
+              "gpt-4o-mini"
+            ]
+          },
+          "budget_limit": {
+            "type": "number",
+            "minimum": 0
+          },
+          "draft_ttl_minutes": {
+            "type": "integer",
+            "minimum": 0
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string",
+            "enum": [
+              "light",
+              "dark"
+            ]
+          },
+          "dark_mode": {
+            "type": "boolean"
+          }
+        }
+      },
+      "ApiKeyRequest": {
+        "type": "object",
+        "properties": {
+          "api_key": {
+            "type": "string"
+          }
+        }
+      },
+      "ApiKeyResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "stored": {
+                "type": "boolean"
+              },
+              "last4": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "Usage": {
+        "type": "object",
+        "properties": {
+          "total_commands_month": {
+            "type": "integer"
+          },
+          "estimated_cost": {
+            "type": "number"
+          },
+          "last_sync": {
+            "type": "string"
+          }
+        }
+      },
+      "UsageResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "IntentRequest": {
+        "type": "object",
+        "required": [
+          "prompt"
+        ],
+        "properties": {
+          "prompt": {
+            "type": "string"
+          },
+          "context": {
+            "type": "object"
+          },
+          "metadata": {
+            "type": "object"
+          }
+        }
+      },
+      "IntentResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "intent_id": {
+                "type": "string"
+              },
+              "status": {
+                "type": "string"
+              },
+              "message": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "HealthResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "status": {
+                "type": "string"
+              },
+              "time": {
+                "type": "string"
+              },
+              "version": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      }
+    }
+  }
+}
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Plugin.php b/src/Plugin.php
index 98ff7ef58454d6f962b466d44ec14f8341d83ba0..5fe2ce7777091ff9d5d68add118e7e9db98ca1a1
--- a/src/Plugin.php
+++ b/src/Plugin.php
@@ -73,6 +73,7 @@
 		add_action( 'admin_menu', array( $this, 'register_menu' ) );
 		add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_admin_assets' ) );
 		add_action( 'rest_api_init', array( $this, 'register_rest_routes' ) );
+		add_filter( 'rest_post_dispatch', array( $this, 'format_rest_response' ), 10, 3 );
 	}
 
 	/**
@@ -183,6 +184,96 @@
 			$controller = new Rest\SettingsController();
 			$controller->register_routes();
 		}
+
+		if ( class_exists( 'AgentWP\\Rest\\IntentController' ) ) {
+			$controller = new Rest\IntentController();
+			$controller->register_routes();
+		}
+
+		if ( class_exists( 'AgentWP\\Rest\\HealthController' ) ) {
+			$controller = new Rest\HealthController();
+			$controller->register_routes();
+		}
+	}
+
+	/**
+	 * Normalize REST responses and log requests.
+	 *
+	 * @param mixed           $result Response value.
+	 * @param \WP_REST_Server $server REST server instance.
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return mixed
+	 */
+	public function format_rest_response( $result, $server, $request ) {
+		if ( ! $this->is_agentwp_route( $request ) ) {
+			return $result;
+		}
+
+		$status     = 200;
+		$error_code = '';
+
+		if ( is_wp_error( $result ) ) {
+			$error_code = $result->get_error_code();
+			$message    = $result->get_error_message();
+			$data       = $result->get_error_data();
+			$status     = ( is_array( $data ) && isset( $data['status'] ) ) ? intval( $data['status'] ) : 500;
+
+			$response = rest_ensure_response(
+				array(
+					'success' => false,
+					'data'    => array(),
+					'error'   => array(
+						'code'    => $error_code,
+						'message' => $message,
+					),
+				)
+			);
+
+			if ( $response instanceof \WP_REST_Response ) {
+				$response->set_status( $status );
+				if ( is_array( $data ) && isset( $data['retry_after'] ) ) {
+					$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+				}
+			}
+
+			$result = $response;
+		} elseif ( $result instanceof \WP_REST_Response ) {
+			$status = $result->get_status();
+			$body   = $result->get_data();
+			if ( is_array( $body ) && isset( $body['error']['code'] ) ) {
+				$error_code = (string) $body['error']['code'];
+			}
+		} else {
+			$result = rest_ensure_response(
+				array(
+					'success' => true,
+					'data'    => $result,
+				)
+			);
+
+			if ( $result instanceof \WP_REST_Response ) {
+				$status = $result->get_status();
+			}
+		}
+
+		if ( class_exists( 'AgentWP\\API\\RestController' ) ) {
+			API\RestController::log_request( $request, $status, $error_code );
+		}
+
+		return $result;
+	}
+
+	/**
+	 * Check whether request targets AgentWP REST routes.
+	 *
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return bool
+	 */
+	private function is_agentwp_route( $request ) {
+		$route = $request->get_route();
+		$route = is_string( $route ) ? $route : '';
+
+		return ( 0 === strpos( $route, '/' . API\RestController::REST_NAMESPACE ) );
 	}
 
 	/**
diff --git a/src/Rest/HealthController.php b/src/Rest/HealthController.php
new file mode 100644
index 0000000000000000000000000000000000000000..4895348e00e2a1fd0e544e52c52a986c07050caa
--- /dev/null
+++ b/src/Rest/HealthController.php
@@ -0,0 +1,47 @@
+<?php
+/**
+ * Health REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class HealthController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/health',
+			array(
+				'methods'             => WP_REST_Server::READABLE,
+				'callback'            => array( $this, 'get_health' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Return health status.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function get_health( $request ) {
+		return $this->response_success(
+			array(
+				'status'  => 'ok',
+				'time'    => gmdate( 'c' ),
+				'version' => defined( 'AGENTWP_VERSION' ) ? AGENTWP_VERSION : '',
+			)
+		);
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..966a5d28f44e2459f3199e1ea2757e352af4a4ab
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,77 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..0ea7d9a4c7c3d863f65832d3fcdbfcc68812dbc2
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,6 +7,7 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
@@ -14,11 +15,7 @@
 use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +24,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +36,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +91,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +118,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +173,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +333,73 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
+	}
 
-		return $response;
+	/**
+	 * Schema for API key payload.
+	 *
+	 * @return array
+	 */
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
+				),
+			),
+		);
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for usage query params.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_usage_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
 	}
 }

file update:
diff --git a/docs/openapi.json b/docs/openapi.json
new file mode 100644
index 0000000000000000000000000000000000000000..849f15d93104fabd8a394dc4195b96a609c010a0
--- /dev/null
+++ b/docs/openapi.json
@@ -0,0 +1,503 @@
+{
+  "openapi": "3.0.3",
+  "info": {
+    "title": "AgentWP REST API",
+    "version": "0.1.0",
+    "description": "OpenAPI specification for AgentWP REST endpoints."
+  },
+  "servers": [
+    {
+      "url": "/wp-json"
+    }
+  ],
+  "paths": {
+    "/agentwp/v1/intent": {
+      "post": {
+        "summary": "Submit an intent",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": true,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/IntentRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Intent accepted",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/IntentResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          },
+          "429": {
+            "description": "Rate limit exceeded",
+            "headers": {
+              "Retry-After": {
+                "schema": {
+                  "type": "integer"
+                }
+              }
+            },
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings": {
+      "get": {
+        "summary": "Get settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Settings payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          }
+        }
+      },
+      "post": {
+        "summary": "Update settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/SettingsUpdateRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Updated settings",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings/api-key": {
+      "post": {
+        "summary": "Store OpenAI API key",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/ApiKeyRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "API key stored",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ApiKeyResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid API key",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/usage": {
+      "get": {
+        "summary": "Get usage stats",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "parameters": [
+          {
+            "name": "period",
+            "in": "query",
+            "schema": {
+              "type": "string",
+              "enum": [
+                "day",
+                "week",
+                "month"
+              ]
+            }
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Usage stats",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/UsageResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid period",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/health": {
+      "get": {
+        "summary": "Health check",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Health status",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/HealthResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    }
+  },
+  "components": {
+    "securitySchemes": {
+      "nonceAuth": {
+        "type": "apiKey",
+        "in": "header",
+        "name": "X-WP-Nonce"
+      }
+    },
+    "schemas": {
+      "StandardResponse": {
+        "type": "object",
+        "required": [
+          "success",
+          "data"
+        ],
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {},
+          "error": {
+            "$ref": "#/components/schemas/ErrorObject"
+          }
+        }
+      },
+      "ErrorObject": {
+        "type": "object",
+        "required": [
+          "code",
+          "message"
+        ],
+        "properties": {
+          "code": {
+            "type": "string"
+          },
+          "message": {
+            "type": "string"
+          }
+        }
+      },
+      "ErrorResponse": {
+        "allOf": [
+          {
+            "$ref": "#/components/schemas/StandardResponse"
+          }
+        ]
+      },
+      "Settings": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string"
+          },
+          "budget_limit": {
+            "type": "number"
+          },
+          "draft_ttl_minutes": {
+            "type": "integer"
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string"
+          }
+        }
+      },
+      "SettingsResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "settings": {
+                "$ref": "#/components/schemas/Settings"
+              },
+              "api_key_last4": {
+                "type": "string"
+              },
+              "has_api_key": {
+                "type": "boolean"
+              },
+              "api_key_status": {
+                "type": "string"
+              },
+              "updated": {
+                "type": "boolean"
+              },
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "SettingsUpdateRequest": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string",
+            "enum": [
+              "gpt-4o",
+              "gpt-4o-mini"
+            ]
+          },
+          "budget_limit": {
+            "type": "number",
+            "minimum": 0
+          },
+          "draft_ttl_minutes": {
+            "type": "integer",
+            "minimum": 0
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string",
+            "enum": [
+              "light",
+              "dark"
+            ]
+          },
+          "dark_mode": {
+            "type": "boolean"
+          }
+        }
+      },
+      "ApiKeyRequest": {
+        "type": "object",
+        "properties": {
+          "api_key": {
+            "type": "string"
+          }
+        }
+      },
+      "ApiKeyResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "stored": {
+                "type": "boolean"
+              },
+              "last4": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "Usage": {
+        "type": "object",
+        "properties": {
+          "total_commands_month": {
+            "type": "integer"
+          },
+          "estimated_cost": {
+            "type": "number"
+          },
+          "last_sync": {
+            "type": "string"
+          }
+        }
+      },
+      "UsageResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "IntentRequest": {
+        "type": "object",
+        "required": [
+          "prompt"
+        ],
+        "properties": {
+          "prompt": {
+            "type": "string"
+          },
+          "context": {
+            "type": "object"
+          },
+          "metadata": {
+            "type": "object"
+          }
+        }
+      },
+      "IntentResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "intent_id": {
+                "type": "string"
+              },
+              "status": {
+                "type": "string"
+              },
+              "message": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "HealthResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "status": {
+                "type": "string"
+              },
+              "time": {
+                "type": "string"
+              },
+              "version": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      }
+    }
+  }
+}
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Plugin.php b/src/Plugin.php
index 98ff7ef58454d6f962b466d44ec14f8341d83ba0..5fe2ce7777091ff9d5d68add118e7e9db98ca1a1
--- a/src/Plugin.php
+++ b/src/Plugin.php
@@ -73,6 +73,7 @@
 		add_action( 'admin_menu', array( $this, 'register_menu' ) );
 		add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_admin_assets' ) );
 		add_action( 'rest_api_init', array( $this, 'register_rest_routes' ) );
+		add_filter( 'rest_post_dispatch', array( $this, 'format_rest_response' ), 10, 3 );
 	}
 
 	/**
@@ -183,6 +184,96 @@
 			$controller = new Rest\SettingsController();
 			$controller->register_routes();
 		}
+
+		if ( class_exists( 'AgentWP\\Rest\\IntentController' ) ) {
+			$controller = new Rest\IntentController();
+			$controller->register_routes();
+		}
+
+		if ( class_exists( 'AgentWP\\Rest\\HealthController' ) ) {
+			$controller = new Rest\HealthController();
+			$controller->register_routes();
+		}
+	}
+
+	/**
+	 * Normalize REST responses and log requests.
+	 *
+	 * @param mixed           $result Response value.
+	 * @param \WP_REST_Server $server REST server instance.
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return mixed
+	 */
+	public function format_rest_response( $result, $server, $request ) {
+		if ( ! $this->is_agentwp_route( $request ) ) {
+			return $result;
+		}
+
+		$status     = 200;
+		$error_code = '';
+
+		if ( is_wp_error( $result ) ) {
+			$error_code = $result->get_error_code();
+			$message    = $result->get_error_message();
+			$data       = $result->get_error_data();
+			$status     = ( is_array( $data ) && isset( $data['status'] ) ) ? intval( $data['status'] ) : 500;
+
+			$response = rest_ensure_response(
+				array(
+					'success' => false,
+					'data'    => array(),
+					'error'   => array(
+						'code'    => $error_code,
+						'message' => $message,
+					),
+				)
+			);
+
+			if ( $response instanceof \WP_REST_Response ) {
+				$response->set_status( $status );
+				if ( is_array( $data ) && isset( $data['retry_after'] ) ) {
+					$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+				}
+			}
+
+			$result = $response;
+		} elseif ( $result instanceof \WP_REST_Response ) {
+			$status = $result->get_status();
+			$body   = $result->get_data();
+			if ( is_array( $body ) && isset( $body['error']['code'] ) ) {
+				$error_code = (string) $body['error']['code'];
+			}
+		} else {
+			$result = rest_ensure_response(
+				array(
+					'success' => true,
+					'data'    => $result,
+				)
+			);
+
+			if ( $result instanceof \WP_REST_Response ) {
+				$status = $result->get_status();
+			}
+		}
+
+		if ( class_exists( 'AgentWP\\API\\RestController' ) ) {
+			API\RestController::log_request( $request, $status, $error_code );
+		}
+
+		return $result;
+	}
+
+	/**
+	 * Check whether request targets AgentWP REST routes.
+	 *
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return bool
+	 */
+	private function is_agentwp_route( $request ) {
+		$route = $request->get_route();
+		$route = is_string( $route ) ? $route : '';
+
+		return ( 0 === strpos( $route, '/' . API\RestController::REST_NAMESPACE ) );
 	}
 
 	/**
diff --git a/src/Rest/HealthController.php b/src/Rest/HealthController.php
new file mode 100644
index 0000000000000000000000000000000000000000..4895348e00e2a1fd0e544e52c52a986c07050caa
--- /dev/null
+++ b/src/Rest/HealthController.php
@@ -0,0 +1,47 @@
+<?php
+/**
+ * Health REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class HealthController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/health',
+			array(
+				'methods'             => WP_REST_Server::READABLE,
+				'callback'            => array( $this, 'get_health' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Return health status.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function get_health( $request ) {
+		return $this->response_success(
+			array(
+				'status'  => 'ok',
+				'time'    => gmdate( 'c' ),
+				'version' => defined( 'AGENTWP_VERSION' ) ? AGENTWP_VERSION : '',
+			)
+		);
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..966a5d28f44e2459f3199e1ea2757e352af4a4ab
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,77 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..0ea7d9a4c7c3d863f65832d3fcdbfcc68812dbc2
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,6 +7,7 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
@@ -14,11 +15,7 @@
 use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +24,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +36,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +91,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +118,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +173,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +333,73 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
+	}
 
-		return $response;
+	/**
+	 * Schema for API key payload.
+	 *
+	 * @return array
+	 */
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
+				),
+			),
+		);
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for usage query params.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_usage_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
 	}
 }


thinking
**Reviewing controller and plugin integration**

I'm tracking the plan updates, marking step 2 and step 3 mostly done as we added the OpenAPI spec. Now I'm verifying implementation details in the controllers and plugin, checking response helpers, type imports, authorization code usage, constants like `TRANSIENT_PREFIX`, and making sure error handling fits the expected patterns. I want to confirm nothing is missed before finalizing these steps.
Plan update
  ✓ Review current REST controllers and plugin hooks to align new base controller, endpoints, and response/permission behavior.
  ✓ Implement AgentWP\API\RestController, update existing SettingsController, and add new Intent/Health controllers plus plugin wiring/filters.
  ✓ Add OpenAPI spec file documenting the new endpoints and verify responses/rate limiting/logging wiring.
file update:
diff --git a/docs/openapi.json b/docs/openapi.json
new file mode 100644
index 0000000000000000000000000000000000000000..849f15d93104fabd8a394dc4195b96a609c010a0
--- /dev/null
+++ b/docs/openapi.json
@@ -0,0 +1,503 @@
+{
+  "openapi": "3.0.3",
+  "info": {
+    "title": "AgentWP REST API",
+    "version": "0.1.0",
+    "description": "OpenAPI specification for AgentWP REST endpoints."
+  },
+  "servers": [
+    {
+      "url": "/wp-json"
+    }
+  ],
+  "paths": {
+    "/agentwp/v1/intent": {
+      "post": {
+        "summary": "Submit an intent",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": true,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/IntentRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Intent accepted",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/IntentResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          },
+          "429": {
+            "description": "Rate limit exceeded",
+            "headers": {
+              "Retry-After": {
+                "schema": {
+                  "type": "integer"
+                }
+              }
+            },
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings": {
+      "get": {
+        "summary": "Get settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Settings payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          }
+        }
+      },
+      "post": {
+        "summary": "Update settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/SettingsUpdateRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Updated settings",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings/api-key": {
+      "post": {
+        "summary": "Store OpenAI API key",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/ApiKeyRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "API key stored",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ApiKeyResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid API key",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/usage": {
+      "get": {
+        "summary": "Get usage stats",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "parameters": [
+          {
+            "name": "period",
+            "in": "query",
+            "schema": {
+              "type": "string",
+              "enum": [
+                "day",
+                "week",
+                "month"
+              ]
+            }
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Usage stats",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/UsageResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid period",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/health": {
+      "get": {
+        "summary": "Health check",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Health status",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/HealthResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    }
+  },
+  "components": {
+    "securitySchemes": {
+      "nonceAuth": {
+        "type": "apiKey",
+        "in": "header",
+        "name": "X-WP-Nonce"
+      }
+    },
+    "schemas": {
+      "StandardResponse": {
+        "type": "object",
+        "required": [
+          "success",
+          "data"
+        ],
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {},
+          "error": {
+            "$ref": "#/components/schemas/ErrorObject"
+          }
+        }
+      },
+      "ErrorObject": {
+        "type": "object",
+        "required": [
+          "code",
+          "message"
+        ],
+        "properties": {
+          "code": {
+            "type": "string"
+          },
+          "message": {
+            "type": "string"
+          }
+        }
+      },
+      "ErrorResponse": {
+        "allOf": [
+          {
+            "$ref": "#/components/schemas/StandardResponse"
+          }
+        ]
+      },
+      "Settings": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string"
+          },
+          "budget_limit": {
+            "type": "number"
+          },
+          "draft_ttl_minutes": {
+            "type": "integer"
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string"
+          }
+        }
+      },
+      "SettingsResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "settings": {
+                "$ref": "#/components/schemas/Settings"
+              },
+              "api_key_last4": {
+                "type": "string"
+              },
+              "has_api_key": {
+                "type": "boolean"
+              },
+              "api_key_status": {
+                "type": "string"
+              },
+              "updated": {
+                "type": "boolean"
+              },
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "SettingsUpdateRequest": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string",
+            "enum": [
+              "gpt-4o",
+              "gpt-4o-mini"
+            ]
+          },
+          "budget_limit": {
+            "type": "number",
+            "minimum": 0
+          },
+          "draft_ttl_minutes": {
+            "type": "integer",
+            "minimum": 0
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string",
+            "enum": [
+              "light",
+              "dark"
+            ]
+          },
+          "dark_mode": {
+            "type": "boolean"
+          }
+        }
+      },
+      "ApiKeyRequest": {
+        "type": "object",
+        "properties": {
+          "api_key": {
+            "type": "string"
+          }
+        }
+      },
+      "ApiKeyResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "stored": {
+                "type": "boolean"
+              },
+              "last4": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "Usage": {
+        "type": "object",
+        "properties": {
+          "total_commands_month": {
+            "type": "integer"
+          },
+          "estimated_cost": {
+            "type": "number"
+          },
+          "last_sync": {
+            "type": "string"
+          }
+        }
+      },
+      "UsageResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "IntentRequest": {
+        "type": "object",
+        "required": [
+          "prompt"
+        ],
+        "properties": {
+          "prompt": {
+            "type": "string"
+          },
+          "context": {
+            "type": "object"
+          },
+          "metadata": {
+            "type": "object"
+          }
+        }
+      },
+      "IntentResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "intent_id": {
+                "type": "string"
+              },
+              "status": {
+                "type": "string"
+              },
+              "message": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "HealthResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "status": {
+                "type": "string"
+              },
+              "time": {
+                "type": "string"
+              },
+              "version": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      }
+    }
+  }
+}
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Plugin.php b/src/Plugin.php
index 98ff7ef58454d6f962b466d44ec14f8341d83ba0..5fe2ce7777091ff9d5d68add118e7e9db98ca1a1
--- a/src/Plugin.php
+++ b/src/Plugin.php
@@ -73,6 +73,7 @@
 		add_action( 'admin_menu', array( $this, 'register_menu' ) );
 		add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_admin_assets' ) );
 		add_action( 'rest_api_init', array( $this, 'register_rest_routes' ) );
+		add_filter( 'rest_post_dispatch', array( $this, 'format_rest_response' ), 10, 3 );
 	}
 
 	/**
@@ -183,6 +184,96 @@
 			$controller = new Rest\SettingsController();
 			$controller->register_routes();
 		}
+
+		if ( class_exists( 'AgentWP\\Rest\\IntentController' ) ) {
+			$controller = new Rest\IntentController();
+			$controller->register_routes();
+		}
+
+		if ( class_exists( 'AgentWP\\Rest\\HealthController' ) ) {
+			$controller = new Rest\HealthController();
+			$controller->register_routes();
+		}
+	}
+
+	/**
+	 * Normalize REST responses and log requests.
+	 *
+	 * @param mixed           $result Response value.
+	 * @param \WP_REST_Server $server REST server instance.
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return mixed
+	 */
+	public function format_rest_response( $result, $server, $request ) {
+		if ( ! $this->is_agentwp_route( $request ) ) {
+			return $result;
+		}
+
+		$status     = 200;
+		$error_code = '';
+
+		if ( is_wp_error( $result ) ) {
+			$error_code = $result->get_error_code();
+			$message    = $result->get_error_message();
+			$data       = $result->get_error_data();
+			$status     = ( is_array( $data ) && isset( $data['status'] ) ) ? intval( $data['status'] ) : 500;
+
+			$response = rest_ensure_response(
+				array(
+					'success' => false,
+					'data'    => array(),
+					'error'   => array(
+						'code'    => $error_code,
+						'message' => $message,
+					),
+				)
+			);
+
+			if ( $response instanceof \WP_REST_Response ) {
+				$response->set_status( $status );
+				if ( is_array( $data ) && isset( $data['retry_after'] ) ) {
+					$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+				}
+			}
+
+			$result = $response;
+		} elseif ( $result instanceof \WP_REST_Response ) {
+			$status = $result->get_status();
+			$body   = $result->get_data();
+			if ( is_array( $body ) && isset( $body['error']['code'] ) ) {
+				$error_code = (string) $body['error']['code'];
+			}
+		} else {
+			$result = rest_ensure_response(
+				array(
+					'success' => true,
+					'data'    => $result,
+				)
+			);
+
+			if ( $result instanceof \WP_REST_Response ) {
+				$status = $result->get_status();
+			}
+		}
+
+		if ( class_exists( 'AgentWP\\API\\RestController' ) ) {
+			API\RestController::log_request( $request, $status, $error_code );
+		}
+
+		return $result;
+	}
+
+	/**
+	 * Check whether request targets AgentWP REST routes.
+	 *
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return bool
+	 */
+	private function is_agentwp_route( $request ) {
+		$route = $request->get_route();
+		$route = is_string( $route ) ? $route : '';
+
+		return ( 0 === strpos( $route, '/' . API\RestController::REST_NAMESPACE ) );
 	}
 
 	/**
diff --git a/src/Rest/HealthController.php b/src/Rest/HealthController.php
new file mode 100644
index 0000000000000000000000000000000000000000..4895348e00e2a1fd0e544e52c52a986c07050caa
--- /dev/null
+++ b/src/Rest/HealthController.php
@@ -0,0 +1,47 @@
+<?php
+/**
+ * Health REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class HealthController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/health',
+			array(
+				'methods'             => WP_REST_Server::READABLE,
+				'callback'            => array( $this, 'get_health' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Return health status.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function get_health( $request ) {
+		return $this->response_success(
+			array(
+				'status'  => 'ok',
+				'time'    => gmdate( 'c' ),
+				'version' => defined( 'AGENTWP_VERSION' ) ? AGENTWP_VERSION : '',
+			)
+		);
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..966a5d28f44e2459f3199e1ea2757e352af4a4ab
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,77 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..0ea7d9a4c7c3d863f65832d3fcdbfcc68812dbc2
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,6 +7,7 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
@@ -14,11 +15,7 @@
 use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +24,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +36,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +91,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +118,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +173,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +333,73 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
+	}
 
-		return $response;
+	/**
+	 * Schema for API key payload.
+	 *
+	 * @return array
+	 */
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
+				),
+			),
+		);
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for usage query params.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_usage_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
 	}
 }


thinking
**Reviewing REST filter and schema concerns**
exec
/bin/zsh -lc 'rg "settings" -n assets/agentwp-admin.js | head' in /Users/ahmedyounis/Documents/Projects/agentwp succeeded in 56ms:
50:	function normalizeSettings(settings) {
51:		var merged = Object.assign({}, DEFAULT_SETTINGS, settings || {});
114:		var settings = _useState[0];
166:					var response = await apiFetch({ path: '/agentwp/v1/settings' });
172:						var nextSettings = normalizeSettings(response.data.settings);
180:							message: __('Unable to load settings.', 'agentwp'),
189:						message: getErrorMessage(error, __('Unable to load settings.', 'agentwp')),
247:				message: __('Saving settings...', 'agentwp'),
251:				path: '/agentwp/v1/settings',
257:						var saved = normalizeSettings(response.data.settings);
file update:
diff --git a/docs/openapi.json b/docs/openapi.json
new file mode 100644
index 0000000000000000000000000000000000000000..849f15d93104fabd8a394dc4195b96a609c010a0
--- /dev/null
+++ b/docs/openapi.json
@@ -0,0 +1,503 @@
+{
+  "openapi": "3.0.3",
+  "info": {
+    "title": "AgentWP REST API",
+    "version": "0.1.0",
+    "description": "OpenAPI specification for AgentWP REST endpoints."
+  },
+  "servers": [
+    {
+      "url": "/wp-json"
+    }
+  ],
+  "paths": {
+    "/agentwp/v1/intent": {
+      "post": {
+        "summary": "Submit an intent",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": true,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/IntentRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Intent accepted",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/IntentResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          },
+          "429": {
+            "description": "Rate limit exceeded",
+            "headers": {
+              "Retry-After": {
+                "schema": {
+                  "type": "integer"
+                }
+              }
+            },
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings": {
+      "get": {
+        "summary": "Get settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Settings payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          }
+        }
+      },
+      "post": {
+        "summary": "Update settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/SettingsUpdateRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Updated settings",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings/api-key": {
+      "post": {
+        "summary": "Store OpenAI API key",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/ApiKeyRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "API key stored",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ApiKeyResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid API key",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/usage": {
+      "get": {
+        "summary": "Get usage stats",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "parameters": [
+          {
+            "name": "period",
+            "in": "query",
+            "schema": {
+              "type": "string",
+              "enum": [
+                "day",
+                "week",
+                "month"
+              ]
+            }
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Usage stats",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/UsageResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid period",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/health": {
+      "get": {
+        "summary": "Health check",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Health status",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/HealthResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    }
+  },
+  "components": {
+    "securitySchemes": {
+      "nonceAuth": {
+        "type": "apiKey",
+        "in": "header",
+        "name": "X-WP-Nonce"
+      }
+    },
+    "schemas": {
+      "StandardResponse": {
+        "type": "object",
+        "required": [
+          "success",
+          "data"
+        ],
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {},
+          "error": {
+            "$ref": "#/components/schemas/ErrorObject"
+          }
+        }
+      },
+      "ErrorObject": {
+        "type": "object",
+        "required": [
+          "code",
+          "message"
+        ],
+        "properties": {
+          "code": {
+            "type": "string"
+          },
+          "message": {
+            "type": "string"
+          }
+        }
+      },
+      "ErrorResponse": {
+        "allOf": [
+          {
+            "$ref": "#/components/schemas/StandardResponse"
+          }
+        ]
+      },
+      "Settings": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string"
+          },
+          "budget_limit": {
+            "type": "number"
+          },
+          "draft_ttl_minutes": {
+            "type": "integer"
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string"
+          }
+        }
+      },
+      "SettingsResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "settings": {
+                "$ref": "#/components/schemas/Settings"
+              },
+              "api_key_last4": {
+                "type": "string"
+              },
+              "has_api_key": {
+                "type": "boolean"
+              },
+              "api_key_status": {
+                "type": "string"
+              },
+              "updated": {
+                "type": "boolean"
+              },
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "SettingsUpdateRequest": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string",
+            "enum": [
+              "gpt-4o",
+              "gpt-4o-mini"
+            ]
+          },
+          "budget_limit": {
+            "type": "number",
+            "minimum": 0
+          },
+          "draft_ttl_minutes": {
+            "type": "integer",
+            "minimum": 0
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string",
+            "enum": [
+              "light",
+              "dark"
+            ]
+          },
+          "dark_mode": {
+            "type": "boolean"
+          }
+        }
+      },
+      "ApiKeyRequest": {
+        "type": "object",
+        "properties": {
+          "api_key": {
+            "type": "string"
+          }
+        }
+      },
+      "ApiKeyResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "stored": {
+                "type": "boolean"
+              },
+              "last4": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "Usage": {
+        "type": "object",
+        "properties": {
+          "total_commands_month": {
+            "type": "integer"
+          },
+          "estimated_cost": {
+            "type": "number"
+          },
+          "last_sync": {
+            "type": "string"
+          }
+        }
+      },
+      "UsageResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "IntentRequest": {
+        "type": "object",
+        "required": [
+          "prompt"
+        ],
+        "properties": {
+          "prompt": {
+            "type": "string"
+          },
+          "context": {
+            "type": "object"
+          },
+          "metadata": {
+            "type": "object"
+          }
+        }
+      },
+      "IntentResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "intent_id": {
+                "type": "string"
+              },
+              "status": {
+                "type": "string"
+              },
+              "message": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "HealthResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "status": {
+                "type": "string"
+              },
+              "time": {
+                "type": "string"
+              },
+              "version": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      }
+    }
+  }
+}
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Plugin.php b/src/Plugin.php
index 98ff7ef58454d6f962b466d44ec14f8341d83ba0..5fe2ce7777091ff9d5d68add118e7e9db98ca1a1
--- a/src/Plugin.php
+++ b/src/Plugin.php
@@ -73,6 +73,7 @@
 		add_action( 'admin_menu', array( $this, 'register_menu' ) );
 		add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_admin_assets' ) );
 		add_action( 'rest_api_init', array( $this, 'register_rest_routes' ) );
+		add_filter( 'rest_post_dispatch', array( $this, 'format_rest_response' ), 10, 3 );
 	}
 
 	/**
@@ -183,6 +184,96 @@
 			$controller = new Rest\SettingsController();
 			$controller->register_routes();
 		}
+
+		if ( class_exists( 'AgentWP\\Rest\\IntentController' ) ) {
+			$controller = new Rest\IntentController();
+			$controller->register_routes();
+		}
+
+		if ( class_exists( 'AgentWP\\Rest\\HealthController' ) ) {
+			$controller = new Rest\HealthController();
+			$controller->register_routes();
+		}
+	}
+
+	/**
+	 * Normalize REST responses and log requests.
+	 *
+	 * @param mixed           $result Response value.
+	 * @param \WP_REST_Server $server REST server instance.
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return mixed
+	 */
+	public function format_rest_response( $result, $server, $request ) {
+		if ( ! $this->is_agentwp_route( $request ) ) {
+			return $result;
+		}
+
+		$status     = 200;
+		$error_code = '';
+
+		if ( is_wp_error( $result ) ) {
+			$error_code = $result->get_error_code();
+			$message    = $result->get_error_message();
+			$data       = $result->get_error_data();
+			$status     = ( is_array( $data ) && isset( $data['status'] ) ) ? intval( $data['status'] ) : 500;
+
+			$response = rest_ensure_response(
+				array(
+					'success' => false,
+					'data'    => array(),
+					'error'   => array(
+						'code'    => $error_code,
+						'message' => $message,
+					),
+				)
+			);
+
+			if ( $response instanceof \WP_REST_Response ) {
+				$response->set_status( $status );
+				if ( is_array( $data ) && isset( $data['retry_after'] ) ) {
+					$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+				}
+			}
+
+			$result = $response;
+		} elseif ( $result instanceof \WP_REST_Response ) {
+			$status = $result->get_status();
+			$body   = $result->get_data();
+			if ( is_array( $body ) && isset( $body['error']['code'] ) ) {
+				$error_code = (string) $body['error']['code'];
+			}
+		} else {
+			$result = rest_ensure_response(
+				array(
+					'success' => true,
+					'data'    => $result,
+				)
+			);
+
+			if ( $result instanceof \WP_REST_Response ) {
+				$status = $result->get_status();
+			}
+		}
+
+		if ( class_exists( 'AgentWP\\API\\RestController' ) ) {
+			API\RestController::log_request( $request, $status, $error_code );
+		}
+
+		return $result;
+	}
+
+	/**
+	 * Check whether request targets AgentWP REST routes.
+	 *
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return bool
+	 */
+	private function is_agentwp_route( $request ) {
+		$route = $request->get_route();
+		$route = is_string( $route ) ? $route : '';
+
+		return ( 0 === strpos( $route, '/' . API\RestController::REST_NAMESPACE ) );
 	}
 
 	/**
diff --git a/src/Rest/HealthController.php b/src/Rest/HealthController.php
new file mode 100644
index 0000000000000000000000000000000000000000..4895348e00e2a1fd0e544e52c52a986c07050caa
--- /dev/null
+++ b/src/Rest/HealthController.php
@@ -0,0 +1,47 @@
+<?php
+/**
+ * Health REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class HealthController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/health',
+			array(
+				'methods'             => WP_REST_Server::READABLE,
+				'callback'            => array( $this, 'get_health' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Return health status.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function get_health( $request ) {
+		return $this->response_success(
+			array(
+				'status'  => 'ok',
+				'time'    => gmdate( 'c' ),
+				'version' => defined( 'AGENTWP_VERSION' ) ? AGENTWP_VERSION : '',
+			)
+		);
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..966a5d28f44e2459f3199e1ea2757e352af4a4ab
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,77 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..0ea7d9a4c7c3d863f65832d3fcdbfcc68812dbc2
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,6 +7,7 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
@@ -14,11 +15,7 @@
 use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +24,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +36,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +91,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +118,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +173,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +333,73 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
+	}
 
-		return $response;
+	/**
+	 * Schema for API key payload.
+	 *
+	 * @return array
+	 */
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
+				),
+			),
+		);
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for usage query params.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_usage_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
 	}
 }

exec
/bin/zsh -lc "sed -n '230,280p' assets/agentwp-admin.js" in /Users/ahmedyounis/Documents/Projects/agentwp succeeded in 52ms:
				return next;
			});
		}

		function saveSettings(nextSettings, successMessage) {
			var payload = {
				model: nextSettings.model,
				hotkey: nextSettings.hotkey,
				theme: nextSettings.theme,
			};
			var previous = savedSettings;

			setSettings(nextSettings);
			setSavedSettings(nextSettings);
			setSaving(true);
			setNotice({
				status: 'info',
				message: __('Saving settings...', 'agentwp'),
			});

file update:
diff --git a/docs/openapi.json b/docs/openapi.json
new file mode 100644
index 0000000000000000000000000000000000000000..849f15d93104fabd8a394dc4195b96a609c010a0
--- /dev/null
+++ b/docs/openapi.json
@@ -0,0 +1,503 @@
+{
+  "openapi": "3.0.3",
+  "info": {
+    "title": "AgentWP REST API",
+    "version": "0.1.0",
+    "description": "OpenAPI specification for AgentWP REST endpoints."
+  },
+  "servers": [
+    {
+      "url": "/wp-json"
+    }
+  ],
+  "paths": {
+    "/agentwp/v1/intent": {
+      "post": {
+        "summary": "Submit an intent",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": true,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/IntentRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Intent accepted",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/IntentResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          },
+          "429": {
+            "description": "Rate limit exceeded",
+            "headers": {
+              "Retry-After": {
+                "schema": {
+                  "type": "integer"
+                }
+              }
+            },
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings": {
+      "get": {
+        "summary": "Get settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Settings payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          }
+        }
+      },
+      "post": {
+        "summary": "Update settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/SettingsUpdateRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Updated settings",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings/api-key": {
+      "post": {
+        "summary": "Store OpenAI API key",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/ApiKeyRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "API key stored",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ApiKeyResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid API key",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/usage": {
+      "get": {
+        "summary": "Get usage stats",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "parameters": [
+          {
+            "name": "period",
+            "in": "query",
+            "schema": {
+              "type": "string",
+              "enum": [
+                "day",
+                "week",
+                "month"
+              ]
+            }
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Usage stats",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/UsageResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid period",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/health": {
+      "get": {
+        "summary": "Health check",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Health status",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/HealthResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    }
+  },
+  "components": {
+    "securitySchemes": {
+      "nonceAuth": {
+        "type": "apiKey",
+        "in": "header",
+        "name": "X-WP-Nonce"
+      }
+    },
+    "schemas": {
+      "StandardResponse": {
+        "type": "object",
+        "required": [
+          "success",
+          "data"
+        ],
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {},
+          "error": {
+            "$ref": "#/components/schemas/ErrorObject"
+          }
+        }
+      },
+      "ErrorObject": {
+        "type": "object",
+        "required": [
+          "code",
+          "message"
+        ],
+        "properties": {
+          "code": {
+            "type": "string"
+          },
+          "message": {
+            "type": "string"
+          }
+        }
+      },
+      "ErrorResponse": {
+        "allOf": [
+          {
+            "$ref": "#/components/schemas/StandardResponse"
+          }
+        ]
+      },
+      "Settings": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string"
+          },
+          "budget_limit": {
+            "type": "number"
+          },
+          "draft_ttl_minutes": {
+            "type": "integer"
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string"
+          }
+        }
+      },
+      "SettingsResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "settings": {
+                "$ref": "#/components/schemas/Settings"
+              },
+              "api_key_last4": {
+                "type": "string"
+              },
+              "has_api_key": {
+                "type": "boolean"
+              },
+              "api_key_status": {
+                "type": "string"
+              },
+              "updated": {
+                "type": "boolean"
+              },
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "SettingsUpdateRequest": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string",
+            "enum": [
+              "gpt-4o",
+              "gpt-4o-mini"
+            ]
+          },
+          "budget_limit": {
+            "type": "number",
+            "minimum": 0
+          },
+          "draft_ttl_minutes": {
+            "type": "integer",
+            "minimum": 0
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string",
+            "enum": [
+              "light",
+              "dark"
+            ]
+          },
+          "dark_mode": {
+            "type": "boolean"
+          }
+        }
+      },
+      "ApiKeyRequest": {
+        "type": "object",
+        "properties": {
+          "api_key": {
+            "type": "string"
+          }
+        }
+      },
+      "ApiKeyResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "stored": {
+                "type": "boolean"
+              },
+              "last4": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "Usage": {
+        "type": "object",
+        "properties": {
+          "total_commands_month": {
+            "type": "integer"
+          },
+          "estimated_cost": {
+            "type": "number"
+          },
+          "last_sync": {
+            "type": "string"
+          }
+        }
+      },
+      "UsageResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "IntentRequest": {
+        "type": "object",
+        "required": [
+          "prompt"
+        ],
+        "properties": {
+          "prompt": {
+            "type": "string"
+          },
+          "context": {
+            "type": "object"
+          },
+          "metadata": {
+            "type": "object"
+          }
+        }
+      },
+      "IntentResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "intent_id": {
+                "type": "string"
+              },
+              "status": {
+                "type": "string"
+              },
+              "message": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "HealthResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "status": {
+                "type": "string"
+              },
+              "time": {
+                "type": "string"
+              },
+              "version": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      }
+    }
+  }
+}
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Plugin.php b/src/Plugin.php
index 98ff7ef58454d6f962b466d44ec14f8341d83ba0..5fe2ce7777091ff9d5d68add118e7e9db98ca1a1
--- a/src/Plugin.php
+++ b/src/Plugin.php
@@ -73,6 +73,7 @@
 		add_action( 'admin_menu', array( $this, 'register_menu' ) );
 		add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_admin_assets' ) );
 		add_action( 'rest_api_init', array( $this, 'register_rest_routes' ) );
+		add_filter( 'rest_post_dispatch', array( $this, 'format_rest_response' ), 10, 3 );
 	}
 
 	/**
@@ -183,6 +184,96 @@
 			$controller = new Rest\SettingsController();
 			$controller->register_routes();
 		}
+
+		if ( class_exists( 'AgentWP\\Rest\\IntentController' ) ) {
+			$controller = new Rest\IntentController();
+			$controller->register_routes();
+		}
+
+		if ( class_exists( 'AgentWP\\Rest\\HealthController' ) ) {
+			$controller = new Rest\HealthController();
+			$controller->register_routes();
+		}
+	}
+
+	/**
+	 * Normalize REST responses and log requests.
+	 *
+	 * @param mixed           $result Response value.
+	 * @param \WP_REST_Server $server REST server instance.
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return mixed
+	 */
+	public function format_rest_response( $result, $server, $request ) {
+		if ( ! $this->is_agentwp_route( $request ) ) {
+			return $result;
+		}
+
+		$status     = 200;
+		$error_code = '';
+
+		if ( is_wp_error( $result ) ) {
+			$error_code = $result->get_error_code();
+			$message    = $result->get_error_message();
+			$data       = $result->get_error_data();
+			$status     = ( is_array( $data ) && isset( $data['status'] ) ) ? intval( $data['status'] ) : 500;
+
+			$response = rest_ensure_response(
+				array(
+					'success' => false,
+					'data'    => array(),
+					'error'   => array(
+						'code'    => $error_code,
+						'message' => $message,
+					),
+				)
+			);
+
+			if ( $response instanceof \WP_REST_Response ) {
+				$response->set_status( $status );
+				if ( is_array( $data ) && isset( $data['retry_after'] ) ) {
+					$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+				}
+			}
+
+			$result = $response;
+		} elseif ( $result instanceof \WP_REST_Response ) {
+			$status = $result->get_status();
+			$body   = $result->get_data();
+			if ( is_array( $body ) && isset( $body['error']['code'] ) ) {
+				$error_code = (string) $body['error']['code'];
+			}
+		} else {
+			$result = rest_ensure_response(
+				array(
+					'success' => true,
+					'data'    => $result,
+				)
+			);
+
+			if ( $result instanceof \WP_REST_Response ) {
+				$status = $result->get_status();
+			}
+		}
+
+		if ( class_exists( 'AgentWP\\API\\RestController' ) ) {
+			API\RestController::log_request( $request, $status, $error_code );
+		}
+
+		return $result;
+	}
+
+	/**
+	 * Check whether request targets AgentWP REST routes.
+	 *
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return bool
+	 */
+	private function is_agentwp_route( $request ) {
+		$route = $request->get_route();
+		$route = is_string( $route ) ? $route : '';
+
+		return ( 0 === strpos( $route, '/' . API\RestController::REST_NAMESPACE ) );
 	}
 
 	/**
diff --git a/src/Rest/HealthController.php b/src/Rest/HealthController.php
new file mode 100644
index 0000000000000000000000000000000000000000..4895348e00e2a1fd0e544e52c52a986c07050caa
--- /dev/null
+++ b/src/Rest/HealthController.php
@@ -0,0 +1,47 @@
+<?php
+/**
+ * Health REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class HealthController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/health',
+			array(
+				'methods'             => WP_REST_Server::READABLE,
+				'callback'            => array( $this, 'get_health' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Return health status.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function get_health( $request ) {
+		return $this->response_success(
+			array(
+				'status'  => 'ok',
+				'time'    => gmdate( 'c' ),
+				'version' => defined( 'AGENTWP_VERSION' ) ? AGENTWP_VERSION : '',
+			)
+		);
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..966a5d28f44e2459f3199e1ea2757e352af4a4ab
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,77 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..0ea7d9a4c7c3d863f65832d3fcdbfcc68812dbc2
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,6 +7,7 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
@@ -14,11 +15,7 @@
 use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +24,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +36,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +91,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +118,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +173,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +333,73 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
+	}
 
-		return $response;
+	/**
+	 * Schema for API key payload.
+	 *
+	 * @return array
+	 */
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
+				),
+			),
+		);
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for usage query params.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_usage_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
 	}
 }


thinking
**Analyzing rate limiting and schema validation nuances**

I'm carefully examining the rate limit implementation, noting its sliding window behavior that updates expiration on each request and resets based on elapsed time. I’m also considering the impact of strict JSON schema `additionalProperties: false` on query parameters, since WordPress may add fields like `_locale` and `_fields` that could falsely trigger validation errors, so relaxing or removing that restriction for usage and intent schemas seems safer to avoid blocking legitimate requests.
file update
M /Users/ahmedyounis/Documents/Projects/agentwp/src/Rest/IntentController.php
@@ -59,4 +59,3 @@
 		return array(
-			'type'                 => 'object',
-			'additionalProperties' => false,
+			'type'     => 'object',
 			'required'             => array( 'prompt' ),
apply_patch(auto_approved=true) exited 0 in 68ms:
Success. Updated the following files:
M src/Rest/IntentController.php
file update:
diff --git a/docs/openapi.json b/docs/openapi.json
new file mode 100644
index 0000000000000000000000000000000000000000..849f15d93104fabd8a394dc4195b96a609c010a0
--- /dev/null
+++ b/docs/openapi.json
@@ -0,0 +1,503 @@
+{
+  "openapi": "3.0.3",
+  "info": {
+    "title": "AgentWP REST API",
+    "version": "0.1.0",
+    "description": "OpenAPI specification for AgentWP REST endpoints."
+  },
+  "servers": [
+    {
+      "url": "/wp-json"
+    }
+  ],
+  "paths": {
+    "/agentwp/v1/intent": {
+      "post": {
+        "summary": "Submit an intent",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": true,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/IntentRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Intent accepted",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/IntentResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          },
+          "429": {
+            "description": "Rate limit exceeded",
+            "headers": {
+              "Retry-After": {
+                "schema": {
+                  "type": "integer"
+                }
+              }
+            },
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings": {
+      "get": {
+        "summary": "Get settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Settings payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          }
+        }
+      },
+      "post": {
+        "summary": "Update settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/SettingsUpdateRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Updated settings",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings/api-key": {
+      "post": {
+        "summary": "Store OpenAI API key",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/ApiKeyRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "API key stored",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ApiKeyResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid API key",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/usage": {
+      "get": {
+        "summary": "Get usage stats",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "parameters": [
+          {
+            "name": "period",
+            "in": "query",
+            "schema": {
+              "type": "string",
+              "enum": [
+                "day",
+                "week",
+                "month"
+              ]
+            }
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Usage stats",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/UsageResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid period",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/health": {
+      "get": {
+        "summary": "Health check",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Health status",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/HealthResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    }
+  },
+  "components": {
+    "securitySchemes": {
+      "nonceAuth": {
+        "type": "apiKey",
+        "in": "header",
+        "name": "X-WP-Nonce"
+      }
+    },
+    "schemas": {
+      "StandardResponse": {
+        "type": "object",
+        "required": [
+          "success",
+          "data"
+        ],
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {},
+          "error": {
+            "$ref": "#/components/schemas/ErrorObject"
+          }
+        }
+      },
+      "ErrorObject": {
+        "type": "object",
+        "required": [
+          "code",
+          "message"
+        ],
+        "properties": {
+          "code": {
+            "type": "string"
+          },
+          "message": {
+            "type": "string"
+          }
+        }
+      },
+      "ErrorResponse": {
+        "allOf": [
+          {
+            "$ref": "#/components/schemas/StandardResponse"
+          }
+        ]
+      },
+      "Settings": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string"
+          },
+          "budget_limit": {
+            "type": "number"
+          },
+          "draft_ttl_minutes": {
+            "type": "integer"
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string"
+          }
+        }
+      },
+      "SettingsResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "settings": {
+                "$ref": "#/components/schemas/Settings"
+              },
+              "api_key_last4": {
+                "type": "string"
+              },
+              "has_api_key": {
+                "type": "boolean"
+              },
+              "api_key_status": {
+                "type": "string"
+              },
+              "updated": {
+                "type": "boolean"
+              },
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "SettingsUpdateRequest": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string",
+            "enum": [
+              "gpt-4o",
+              "gpt-4o-mini"
+            ]
+          },
+          "budget_limit": {
+            "type": "number",
+            "minimum": 0
+          },
+          "draft_ttl_minutes": {
+            "type": "integer",
+            "minimum": 0
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string",
+            "enum": [
+              "light",
+              "dark"
+            ]
+          },
+          "dark_mode": {
+            "type": "boolean"
+          }
+        }
+      },
+      "ApiKeyRequest": {
+        "type": "object",
+        "properties": {
+          "api_key": {
+            "type": "string"
+          }
+        }
+      },
+      "ApiKeyResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "stored": {
+                "type": "boolean"
+              },
+              "last4": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "Usage": {
+        "type": "object",
+        "properties": {
+          "total_commands_month": {
+            "type": "integer"
+          },
+          "estimated_cost": {
+            "type": "number"
+          },
+          "last_sync": {
+            "type": "string"
+          }
+        }
+      },
+      "UsageResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "IntentRequest": {
+        "type": "object",
+        "required": [
+          "prompt"
+        ],
+        "properties": {
+          "prompt": {
+            "type": "string"
+          },
+          "context": {
+            "type": "object"
+          },
+          "metadata": {
+            "type": "object"
+          }
+        }
+      },
+      "IntentResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "intent_id": {
+                "type": "string"
+              },
+              "status": {
+                "type": "string"
+              },
+              "message": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "HealthResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "status": {
+                "type": "string"
+              },
+              "time": {
+                "type": "string"
+              },
+              "version": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      }
+    }
+  }
+}
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Plugin.php b/src/Plugin.php
index 98ff7ef58454d6f962b466d44ec14f8341d83ba0..5fe2ce7777091ff9d5d68add118e7e9db98ca1a1
--- a/src/Plugin.php
+++ b/src/Plugin.php
@@ -73,6 +73,7 @@
 		add_action( 'admin_menu', array( $this, 'register_menu' ) );
 		add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_admin_assets' ) );
 		add_action( 'rest_api_init', array( $this, 'register_rest_routes' ) );
+		add_filter( 'rest_post_dispatch', array( $this, 'format_rest_response' ), 10, 3 );
 	}
 
 	/**
@@ -183,6 +184,96 @@
 			$controller = new Rest\SettingsController();
 			$controller->register_routes();
 		}
+
+		if ( class_exists( 'AgentWP\\Rest\\IntentController' ) ) {
+			$controller = new Rest\IntentController();
+			$controller->register_routes();
+		}
+
+		if ( class_exists( 'AgentWP\\Rest\\HealthController' ) ) {
+			$controller = new Rest\HealthController();
+			$controller->register_routes();
+		}
+	}
+
+	/**
+	 * Normalize REST responses and log requests.
+	 *
+	 * @param mixed           $result Response value.
+	 * @param \WP_REST_Server $server REST server instance.
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return mixed
+	 */
+	public function format_rest_response( $result, $server, $request ) {
+		if ( ! $this->is_agentwp_route( $request ) ) {
+			return $result;
+		}
+
+		$status     = 200;
+		$error_code = '';
+
+		if ( is_wp_error( $result ) ) {
+			$error_code = $result->get_error_code();
+			$message    = $result->get_error_message();
+			$data       = $result->get_error_data();
+			$status     = ( is_array( $data ) && isset( $data['status'] ) ) ? intval( $data['status'] ) : 500;
+
+			$response = rest_ensure_response(
+				array(
+					'success' => false,
+					'data'    => array(),
+					'error'   => array(
+						'code'    => $error_code,
+						'message' => $message,
+					),
+				)
+			);
+
+			if ( $response instanceof \WP_REST_Response ) {
+				$response->set_status( $status );
+				if ( is_array( $data ) && isset( $data['retry_after'] ) ) {
+					$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+				}
+			}
+
+			$result = $response;
+		} elseif ( $result instanceof \WP_REST_Response ) {
+			$status = $result->get_status();
+			$body   = $result->get_data();
+			if ( is_array( $body ) && isset( $body['error']['code'] ) ) {
+				$error_code = (string) $body['error']['code'];
+			}
+		} else {
+			$result = rest_ensure_response(
+				array(
+					'success' => true,
+					'data'    => $result,
+				)
+			);
+
+			if ( $result instanceof \WP_REST_Response ) {
+				$status = $result->get_status();
+			}
+		}
+
+		if ( class_exists( 'AgentWP\\API\\RestController' ) ) {
+			API\RestController::log_request( $request, $status, $error_code );
+		}
+
+		return $result;
+	}
+
+	/**
+	 * Check whether request targets AgentWP REST routes.
+	 *
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return bool
+	 */
+	private function is_agentwp_route( $request ) {
+		$route = $request->get_route();
+		$route = is_string( $route ) ? $route : '';
+
+		return ( 0 === strpos( $route, '/' . API\RestController::REST_NAMESPACE ) );
 	}
 
 	/**
diff --git a/src/Rest/HealthController.php b/src/Rest/HealthController.php
new file mode 100644
index 0000000000000000000000000000000000000000..4895348e00e2a1fd0e544e52c52a986c07050caa
--- /dev/null
+++ b/src/Rest/HealthController.php
@@ -0,0 +1,47 @@
+<?php
+/**
+ * Health REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class HealthController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/health',
+			array(
+				'methods'             => WP_REST_Server::READABLE,
+				'callback'            => array( $this, 'get_health' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Return health status.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function get_health( $request ) {
+		return $this->response_success(
+			array(
+				'status'  => 'ok',
+				'time'    => gmdate( 'c' ),
+				'version' => defined( 'AGENTWP_VERSION' ) ? AGENTWP_VERSION : '',
+			)
+		);
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..71b38c9ea8acfdf42086f3000283cebc8f109db0
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,76 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'     => 'object',
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..0ea7d9a4c7c3d863f65832d3fcdbfcc68812dbc2
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,6 +7,7 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
@@ -14,11 +15,7 @@
 use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +24,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +36,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +91,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +118,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +173,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +333,73 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
+	}
 
-		return $response;
+	/**
+	 * Schema for API key payload.
+	 *
+	 * @return array
+	 */
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
+				),
+			),
+		);
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for usage query params.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_usage_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
 	}
 }

file update:
diff --git a/docs/openapi.json b/docs/openapi.json
new file mode 100644
index 0000000000000000000000000000000000000000..849f15d93104fabd8a394dc4195b96a609c010a0
--- /dev/null
+++ b/docs/openapi.json
@@ -0,0 +1,503 @@
+{
+  "openapi": "3.0.3",
+  "info": {
+    "title": "AgentWP REST API",
+    "version": "0.1.0",
+    "description": "OpenAPI specification for AgentWP REST endpoints."
+  },
+  "servers": [
+    {
+      "url": "/wp-json"
+    }
+  ],
+  "paths": {
+    "/agentwp/v1/intent": {
+      "post": {
+        "summary": "Submit an intent",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": true,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/IntentRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Intent accepted",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/IntentResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          },
+          "429": {
+            "description": "Rate limit exceeded",
+            "headers": {
+              "Retry-After": {
+                "schema": {
+                  "type": "integer"
+                }
+              }
+            },
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings": {
+      "get": {
+        "summary": "Get settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Settings payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          }
+        }
+      },
+      "post": {
+        "summary": "Update settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/SettingsUpdateRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Updated settings",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings/api-key": {
+      "post": {
+        "summary": "Store OpenAI API key",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/ApiKeyRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "API key stored",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ApiKeyResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid API key",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/usage": {
+      "get": {
+        "summary": "Get usage stats",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "parameters": [
+          {
+            "name": "period",
+            "in": "query",
+            "schema": {
+              "type": "string",
+              "enum": [
+                "day",
+                "week",
+                "month"
+              ]
+            }
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Usage stats",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/UsageResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid period",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/health": {
+      "get": {
+        "summary": "Health check",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Health status",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/HealthResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    }
+  },
+  "components": {
+    "securitySchemes": {
+      "nonceAuth": {
+        "type": "apiKey",
+        "in": "header",
+        "name": "X-WP-Nonce"
+      }
+    },
+    "schemas": {
+      "StandardResponse": {
+        "type": "object",
+        "required": [
+          "success",
+          "data"
+        ],
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {},
+          "error": {
+            "$ref": "#/components/schemas/ErrorObject"
+          }
+        }
+      },
+      "ErrorObject": {
+        "type": "object",
+        "required": [
+          "code",
+          "message"
+        ],
+        "properties": {
+          "code": {
+            "type": "string"
+          },
+          "message": {
+            "type": "string"
+          }
+        }
+      },
+      "ErrorResponse": {
+        "allOf": [
+          {
+            "$ref": "#/components/schemas/StandardResponse"
+          }
+        ]
+      },
+      "Settings": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string"
+          },
+          "budget_limit": {
+            "type": "number"
+          },
+          "draft_ttl_minutes": {
+            "type": "integer"
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string"
+          }
+        }
+      },
+      "SettingsResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "settings": {
+                "$ref": "#/components/schemas/Settings"
+              },
+              "api_key_last4": {
+                "type": "string"
+              },
+              "has_api_key": {
+                "type": "boolean"
+              },
+              "api_key_status": {
+                "type": "string"
+              },
+              "updated": {
+                "type": "boolean"
+              },
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "SettingsUpdateRequest": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string",
+            "enum": [
+              "gpt-4o",
+              "gpt-4o-mini"
+            ]
+          },
+          "budget_limit": {
+            "type": "number",
+            "minimum": 0
+          },
+          "draft_ttl_minutes": {
+            "type": "integer",
+            "minimum": 0
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string",
+            "enum": [
+              "light",
+              "dark"
+            ]
+          },
+          "dark_mode": {
+            "type": "boolean"
+          }
+        }
+      },
+      "ApiKeyRequest": {
+        "type": "object",
+        "properties": {
+          "api_key": {
+            "type": "string"
+          }
+        }
+      },
+      "ApiKeyResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "stored": {
+                "type": "boolean"
+              },
+              "last4": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "Usage": {
+        "type": "object",
+        "properties": {
+          "total_commands_month": {
+            "type": "integer"
+          },
+          "estimated_cost": {
+            "type": "number"
+          },
+          "last_sync": {
+            "type": "string"
+          }
+        }
+      },
+      "UsageResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "IntentRequest": {
+        "type": "object",
+        "required": [
+          "prompt"
+        ],
+        "properties": {
+          "prompt": {
+            "type": "string"
+          },
+          "context": {
+            "type": "object"
+          },
+          "metadata": {
+            "type": "object"
+          }
+        }
+      },
+      "IntentResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "intent_id": {
+                "type": "string"
+              },
+              "status": {
+                "type": "string"
+              },
+              "message": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "HealthResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "status": {
+                "type": "string"
+              },
+              "time": {
+                "type": "string"
+              },
+              "version": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      }
+    }
+  }
+}
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Plugin.php b/src/Plugin.php
index 98ff7ef58454d6f962b466d44ec14f8341d83ba0..5fe2ce7777091ff9d5d68add118e7e9db98ca1a1
--- a/src/Plugin.php
+++ b/src/Plugin.php
@@ -73,6 +73,7 @@
 		add_action( 'admin_menu', array( $this, 'register_menu' ) );
 		add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_admin_assets' ) );
 		add_action( 'rest_api_init', array( $this, 'register_rest_routes' ) );
+		add_filter( 'rest_post_dispatch', array( $this, 'format_rest_response' ), 10, 3 );
 	}
 
 	/**
@@ -183,6 +184,96 @@
 			$controller = new Rest\SettingsController();
 			$controller->register_routes();
 		}
+
+		if ( class_exists( 'AgentWP\\Rest\\IntentController' ) ) {
+			$controller = new Rest\IntentController();
+			$controller->register_routes();
+		}
+
+		if ( class_exists( 'AgentWP\\Rest\\HealthController' ) ) {
+			$controller = new Rest\HealthController();
+			$controller->register_routes();
+		}
+	}
+
+	/**
+	 * Normalize REST responses and log requests.
+	 *
+	 * @param mixed           $result Response value.
+	 * @param \WP_REST_Server $server REST server instance.
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return mixed
+	 */
+	public function format_rest_response( $result, $server, $request ) {
+		if ( ! $this->is_agentwp_route( $request ) ) {
+			return $result;
+		}
+
+		$status     = 200;
+		$error_code = '';
+
+		if ( is_wp_error( $result ) ) {
+			$error_code = $result->get_error_code();
+			$message    = $result->get_error_message();
+			$data       = $result->get_error_data();
+			$status     = ( is_array( $data ) && isset( $data['status'] ) ) ? intval( $data['status'] ) : 500;
+
+			$response = rest_ensure_response(
+				array(
+					'success' => false,
+					'data'    => array(),
+					'error'   => array(
+						'code'    => $error_code,
+						'message' => $message,
+					),
+				)
+			);
+
+			if ( $response instanceof \WP_REST_Response ) {
+				$response->set_status( $status );
+				if ( is_array( $data ) && isset( $data['retry_after'] ) ) {
+					$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+				}
+			}
+
+			$result = $response;
+		} elseif ( $result instanceof \WP_REST_Response ) {
+			$status = $result->get_status();
+			$body   = $result->get_data();
+			if ( is_array( $body ) && isset( $body['error']['code'] ) ) {
+				$error_code = (string) $body['error']['code'];
+			}
+		} else {
+			$result = rest_ensure_response(
+				array(
+					'success' => true,
+					'data'    => $result,
+				)
+			);
+
+			if ( $result instanceof \WP_REST_Response ) {
+				$status = $result->get_status();
+			}
+		}
+
+		if ( class_exists( 'AgentWP\\API\\RestController' ) ) {
+			API\RestController::log_request( $request, $status, $error_code );
+		}
+
+		return $result;
+	}
+
+	/**
+	 * Check whether request targets AgentWP REST routes.
+	 *
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return bool
+	 */
+	private function is_agentwp_route( $request ) {
+		$route = $request->get_route();
+		$route = is_string( $route ) ? $route : '';
+
+		return ( 0 === strpos( $route, '/' . API\RestController::REST_NAMESPACE ) );
 	}
 
 	/**
diff --git a/src/Rest/HealthController.php b/src/Rest/HealthController.php
new file mode 100644
index 0000000000000000000000000000000000000000..4895348e00e2a1fd0e544e52c52a986c07050caa
--- /dev/null
+++ b/src/Rest/HealthController.php
@@ -0,0 +1,47 @@
+<?php
+/**
+ * Health REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class HealthController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/health',
+			array(
+				'methods'             => WP_REST_Server::READABLE,
+				'callback'            => array( $this, 'get_health' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Return health status.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function get_health( $request ) {
+		return $this->response_success(
+			array(
+				'status'  => 'ok',
+				'time'    => gmdate( 'c' ),
+				'version' => defined( 'AGENTWP_VERSION' ) ? AGENTWP_VERSION : '',
+			)
+		);
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..71b38c9ea8acfdf42086f3000283cebc8f109db0
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,76 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'     => 'object',
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..0ea7d9a4c7c3d863f65832d3fcdbfcc68812dbc2
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,6 +7,7 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
@@ -14,11 +15,7 @@
 use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +24,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +36,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +91,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +118,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +173,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +333,73 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
+	}
 
-		return $response;
+	/**
+	 * Schema for API key payload.
+	 *
+	 * @return array
+	 */
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
+				),
+			),
+		);
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for usage query params.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_usage_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
 	}
 }


thinking
**Updating usage schema**
file update
M /Users/ahmedyounis/Documents/Projects/agentwp/src/Rest/SettingsController.php
@@ -394,4 +394,3 @@
 		return array(
-			'type'                 => 'object',
-			'additionalProperties' => false,
+			'type'       => 'object',
 			'properties'           => array(
apply_patch(auto_approved=true) exited 0 in 97ms:
Success. Updated the following files:
M src/Rest/SettingsController.php
file update:
diff --git a/docs/openapi.json b/docs/openapi.json
new file mode 100644
index 0000000000000000000000000000000000000000..849f15d93104fabd8a394dc4195b96a609c010a0
--- /dev/null
+++ b/docs/openapi.json
@@ -0,0 +1,503 @@
+{
+  "openapi": "3.0.3",
+  "info": {
+    "title": "AgentWP REST API",
+    "version": "0.1.0",
+    "description": "OpenAPI specification for AgentWP REST endpoints."
+  },
+  "servers": [
+    {
+      "url": "/wp-json"
+    }
+  ],
+  "paths": {
+    "/agentwp/v1/intent": {
+      "post": {
+        "summary": "Submit an intent",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": true,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/IntentRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Intent accepted",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/IntentResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          },
+          "429": {
+            "description": "Rate limit exceeded",
+            "headers": {
+              "Retry-After": {
+                "schema": {
+                  "type": "integer"
+                }
+              }
+            },
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings": {
+      "get": {
+        "summary": "Get settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Settings payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          }
+        }
+      },
+      "post": {
+        "summary": "Update settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/SettingsUpdateRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Updated settings",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings/api-key": {
+      "post": {
+        "summary": "Store OpenAI API key",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/ApiKeyRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "API key stored",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ApiKeyResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid API key",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/usage": {
+      "get": {
+        "summary": "Get usage stats",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "parameters": [
+          {
+            "name": "period",
+            "in": "query",
+            "schema": {
+              "type": "string",
+              "enum": [
+                "day",
+                "week",
+                "month"
+              ]
+            }
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Usage stats",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/UsageResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid period",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/health": {
+      "get": {
+        "summary": "Health check",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Health status",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/HealthResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    }
+  },
+  "components": {
+    "securitySchemes": {
+      "nonceAuth": {
+        "type": "apiKey",
+        "in": "header",
+        "name": "X-WP-Nonce"
+      }
+    },
+    "schemas": {
+      "StandardResponse": {
+        "type": "object",
+        "required": [
+          "success",
+          "data"
+        ],
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {},
+          "error": {
+            "$ref": "#/components/schemas/ErrorObject"
+          }
+        }
+      },
+      "ErrorObject": {
+        "type": "object",
+        "required": [
+          "code",
+          "message"
+        ],
+        "properties": {
+          "code": {
+            "type": "string"
+          },
+          "message": {
+            "type": "string"
+          }
+        }
+      },
+      "ErrorResponse": {
+        "allOf": [
+          {
+            "$ref": "#/components/schemas/StandardResponse"
+          }
+        ]
+      },
+      "Settings": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string"
+          },
+          "budget_limit": {
+            "type": "number"
+          },
+          "draft_ttl_minutes": {
+            "type": "integer"
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string"
+          }
+        }
+      },
+      "SettingsResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "settings": {
+                "$ref": "#/components/schemas/Settings"
+              },
+              "api_key_last4": {
+                "type": "string"
+              },
+              "has_api_key": {
+                "type": "boolean"
+              },
+              "api_key_status": {
+                "type": "string"
+              },
+              "updated": {
+                "type": "boolean"
+              },
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "SettingsUpdateRequest": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string",
+            "enum": [
+              "gpt-4o",
+              "gpt-4o-mini"
+            ]
+          },
+          "budget_limit": {
+            "type": "number",
+            "minimum": 0
+          },
+          "draft_ttl_minutes": {
+            "type": "integer",
+            "minimum": 0
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string",
+            "enum": [
+              "light",
+              "dark"
+            ]
+          },
+          "dark_mode": {
+            "type": "boolean"
+          }
+        }
+      },
+      "ApiKeyRequest": {
+        "type": "object",
+        "properties": {
+          "api_key": {
+            "type": "string"
+          }
+        }
+      },
+      "ApiKeyResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "stored": {
+                "type": "boolean"
+              },
+              "last4": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "Usage": {
+        "type": "object",
+        "properties": {
+          "total_commands_month": {
+            "type": "integer"
+          },
+          "estimated_cost": {
+            "type": "number"
+          },
+          "last_sync": {
+            "type": "string"
+          }
+        }
+      },
+      "UsageResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "IntentRequest": {
+        "type": "object",
+        "required": [
+          "prompt"
+        ],
+        "properties": {
+          "prompt": {
+            "type": "string"
+          },
+          "context": {
+            "type": "object"
+          },
+          "metadata": {
+            "type": "object"
+          }
+        }
+      },
+      "IntentResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "intent_id": {
+                "type": "string"
+              },
+              "status": {
+                "type": "string"
+              },
+              "message": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "HealthResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "status": {
+                "type": "string"
+              },
+              "time": {
+                "type": "string"
+              },
+              "version": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      }
+    }
+  }
+}
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Plugin.php b/src/Plugin.php
index 98ff7ef58454d6f962b466d44ec14f8341d83ba0..5fe2ce7777091ff9d5d68add118e7e9db98ca1a1
--- a/src/Plugin.php
+++ b/src/Plugin.php
@@ -73,6 +73,7 @@
 		add_action( 'admin_menu', array( $this, 'register_menu' ) );
 		add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_admin_assets' ) );
 		add_action( 'rest_api_init', array( $this, 'register_rest_routes' ) );
+		add_filter( 'rest_post_dispatch', array( $this, 'format_rest_response' ), 10, 3 );
 	}
 
 	/**
@@ -183,6 +184,96 @@
 			$controller = new Rest\SettingsController();
 			$controller->register_routes();
 		}
+
+		if ( class_exists( 'AgentWP\\Rest\\IntentController' ) ) {
+			$controller = new Rest\IntentController();
+			$controller->register_routes();
+		}
+
+		if ( class_exists( 'AgentWP\\Rest\\HealthController' ) ) {
+			$controller = new Rest\HealthController();
+			$controller->register_routes();
+		}
+	}
+
+	/**
+	 * Normalize REST responses and log requests.
+	 *
+	 * @param mixed           $result Response value.
+	 * @param \WP_REST_Server $server REST server instance.
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return mixed
+	 */
+	public function format_rest_response( $result, $server, $request ) {
+		if ( ! $this->is_agentwp_route( $request ) ) {
+			return $result;
+		}
+
+		$status     = 200;
+		$error_code = '';
+
+		if ( is_wp_error( $result ) ) {
+			$error_code = $result->get_error_code();
+			$message    = $result->get_error_message();
+			$data       = $result->get_error_data();
+			$status     = ( is_array( $data ) && isset( $data['status'] ) ) ? intval( $data['status'] ) : 500;
+
+			$response = rest_ensure_response(
+				array(
+					'success' => false,
+					'data'    => array(),
+					'error'   => array(
+						'code'    => $error_code,
+						'message' => $message,
+					),
+				)
+			);
+
+			if ( $response instanceof \WP_REST_Response ) {
+				$response->set_status( $status );
+				if ( is_array( $data ) && isset( $data['retry_after'] ) ) {
+					$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+				}
+			}
+
+			$result = $response;
+		} elseif ( $result instanceof \WP_REST_Response ) {
+			$status = $result->get_status();
+			$body   = $result->get_data();
+			if ( is_array( $body ) && isset( $body['error']['code'] ) ) {
+				$error_code = (string) $body['error']['code'];
+			}
+		} else {
+			$result = rest_ensure_response(
+				array(
+					'success' => true,
+					'data'    => $result,
+				)
+			);
+
+			if ( $result instanceof \WP_REST_Response ) {
+				$status = $result->get_status();
+			}
+		}
+
+		if ( class_exists( 'AgentWP\\API\\RestController' ) ) {
+			API\RestController::log_request( $request, $status, $error_code );
+		}
+
+		return $result;
+	}
+
+	/**
+	 * Check whether request targets AgentWP REST routes.
+	 *
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return bool
+	 */
+	private function is_agentwp_route( $request ) {
+		$route = $request->get_route();
+		$route = is_string( $route ) ? $route : '';
+
+		return ( 0 === strpos( $route, '/' . API\RestController::REST_NAMESPACE ) );
 	}
 
 	/**
diff --git a/src/Rest/HealthController.php b/src/Rest/HealthController.php
new file mode 100644
index 0000000000000000000000000000000000000000..4895348e00e2a1fd0e544e52c52a986c07050caa
--- /dev/null
+++ b/src/Rest/HealthController.php
@@ -0,0 +1,47 @@
+<?php
+/**
+ * Health REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class HealthController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/health',
+			array(
+				'methods'             => WP_REST_Server::READABLE,
+				'callback'            => array( $this, 'get_health' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Return health status.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function get_health( $request ) {
+		return $this->response_success(
+			array(
+				'status'  => 'ok',
+				'time'    => gmdate( 'c' ),
+				'version' => defined( 'AGENTWP_VERSION' ) ? AGENTWP_VERSION : '',
+			)
+		);
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..71b38c9ea8acfdf42086f3000283cebc8f109db0
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,76 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'     => 'object',
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..94c8bbe2a9b4f7e146df8925a0ab79f0930f4edb
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,6 +7,7 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
@@ -14,11 +15,7 @@
 use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +24,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +36,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +91,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +118,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +173,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +333,72 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
-
-		return $response;
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for API key payload.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
 				),
-			)
+			),
 		);
+	}
 
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
+	/**
+	 * Schema for usage query params.
+	 *
+	 * @return array
+	 */
+	private function get_usage_schema() {
+		return array(
+			'type'       => 'object',
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
+				),
+			),
+		);
 	}
 }

file update:
diff --git a/docs/openapi.json b/docs/openapi.json
new file mode 100644
index 0000000000000000000000000000000000000000..849f15d93104fabd8a394dc4195b96a609c010a0
--- /dev/null
+++ b/docs/openapi.json
@@ -0,0 +1,503 @@
+{
+  "openapi": "3.0.3",
+  "info": {
+    "title": "AgentWP REST API",
+    "version": "0.1.0",
+    "description": "OpenAPI specification for AgentWP REST endpoints."
+  },
+  "servers": [
+    {
+      "url": "/wp-json"
+    }
+  ],
+  "paths": {
+    "/agentwp/v1/intent": {
+      "post": {
+        "summary": "Submit an intent",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": true,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/IntentRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Intent accepted",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/IntentResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          },
+          "429": {
+            "description": "Rate limit exceeded",
+            "headers": {
+              "Retry-After": {
+                "schema": {
+                  "type": "integer"
+                }
+              }
+            },
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings": {
+      "get": {
+        "summary": "Get settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Settings payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          }
+        }
+      },
+      "post": {
+        "summary": "Update settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/SettingsUpdateRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Updated settings",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings/api-key": {
+      "post": {
+        "summary": "Store OpenAI API key",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/ApiKeyRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "API key stored",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ApiKeyResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid API key",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/usage": {
+      "get": {
+        "summary": "Get usage stats",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "parameters": [
+          {
+            "name": "period",
+            "in": "query",
+            "schema": {
+              "type": "string",
+              "enum": [
+                "day",
+                "week",
+                "month"
+              ]
+            }
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Usage stats",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/UsageResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid period",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/health": {
+      "get": {
+        "summary": "Health check",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Health status",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/HealthResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    }
+  },
+  "components": {
+    "securitySchemes": {
+      "nonceAuth": {
+        "type": "apiKey",
+        "in": "header",
+        "name": "X-WP-Nonce"
+      }
+    },
+    "schemas": {
+      "StandardResponse": {
+        "type": "object",
+        "required": [
+          "success",
+          "data"
+        ],
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {},
+          "error": {
+            "$ref": "#/components/schemas/ErrorObject"
+          }
+        }
+      },
+      "ErrorObject": {
+        "type": "object",
+        "required": [
+          "code",
+          "message"
+        ],
+        "properties": {
+          "code": {
+            "type": "string"
+          },
+          "message": {
+            "type": "string"
+          }
+        }
+      },
+      "ErrorResponse": {
+        "allOf": [
+          {
+            "$ref": "#/components/schemas/StandardResponse"
+          }
+        ]
+      },
+      "Settings": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string"
+          },
+          "budget_limit": {
+            "type": "number"
+          },
+          "draft_ttl_minutes": {
+            "type": "integer"
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string"
+          }
+        }
+      },
+      "SettingsResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "settings": {
+                "$ref": "#/components/schemas/Settings"
+              },
+              "api_key_last4": {
+                "type": "string"
+              },
+              "has_api_key": {
+                "type": "boolean"
+              },
+              "api_key_status": {
+                "type": "string"
+              },
+              "updated": {
+                "type": "boolean"
+              },
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "SettingsUpdateRequest": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string",
+            "enum": [
+              "gpt-4o",
+              "gpt-4o-mini"
+            ]
+          },
+          "budget_limit": {
+            "type": "number",
+            "minimum": 0
+          },
+          "draft_ttl_minutes": {
+            "type": "integer",
+            "minimum": 0
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string",
+            "enum": [
+              "light",
+              "dark"
+            ]
+          },
+          "dark_mode": {
+            "type": "boolean"
+          }
+        }
+      },
+      "ApiKeyRequest": {
+        "type": "object",
+        "properties": {
+          "api_key": {
+            "type": "string"
+          }
+        }
+      },
+      "ApiKeyResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "stored": {
+                "type": "boolean"
+              },
+              "last4": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "Usage": {
+        "type": "object",
+        "properties": {
+          "total_commands_month": {
+            "type": "integer"
+          },
+          "estimated_cost": {
+            "type": "number"
+          },
+          "last_sync": {
+            "type": "string"
+          }
+        }
+      },
+      "UsageResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "IntentRequest": {
+        "type": "object",
+        "required": [
+          "prompt"
+        ],
+        "properties": {
+          "prompt": {
+            "type": "string"
+          },
+          "context": {
+            "type": "object"
+          },
+          "metadata": {
+            "type": "object"
+          }
+        }
+      },
+      "IntentResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "intent_id": {
+                "type": "string"
+              },
+              "status": {
+                "type": "string"
+              },
+              "message": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "HealthResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "status": {
+                "type": "string"
+              },
+              "time": {
+                "type": "string"
+              },
+              "version": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      }
+    }
+  }
+}
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Plugin.php b/src/Plugin.php
index 98ff7ef58454d6f962b466d44ec14f8341d83ba0..5fe2ce7777091ff9d5d68add118e7e9db98ca1a1
--- a/src/Plugin.php
+++ b/src/Plugin.php
@@ -73,6 +73,7 @@
 		add_action( 'admin_menu', array( $this, 'register_menu' ) );
 		add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_admin_assets' ) );
 		add_action( 'rest_api_init', array( $this, 'register_rest_routes' ) );
+		add_filter( 'rest_post_dispatch', array( $this, 'format_rest_response' ), 10, 3 );
 	}
 
 	/**
@@ -183,6 +184,96 @@
 			$controller = new Rest\SettingsController();
 			$controller->register_routes();
 		}
+
+		if ( class_exists( 'AgentWP\\Rest\\IntentController' ) ) {
+			$controller = new Rest\IntentController();
+			$controller->register_routes();
+		}
+
+		if ( class_exists( 'AgentWP\\Rest\\HealthController' ) ) {
+			$controller = new Rest\HealthController();
+			$controller->register_routes();
+		}
+	}
+
+	/**
+	 * Normalize REST responses and log requests.
+	 *
+	 * @param mixed           $result Response value.
+	 * @param \WP_REST_Server $server REST server instance.
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return mixed
+	 */
+	public function format_rest_response( $result, $server, $request ) {
+		if ( ! $this->is_agentwp_route( $request ) ) {
+			return $result;
+		}
+
+		$status     = 200;
+		$error_code = '';
+
+		if ( is_wp_error( $result ) ) {
+			$error_code = $result->get_error_code();
+			$message    = $result->get_error_message();
+			$data       = $result->get_error_data();
+			$status     = ( is_array( $data ) && isset( $data['status'] ) ) ? intval( $data['status'] ) : 500;
+
+			$response = rest_ensure_response(
+				array(
+					'success' => false,
+					'data'    => array(),
+					'error'   => array(
+						'code'    => $error_code,
+						'message' => $message,
+					),
+				)
+			);
+
+			if ( $response instanceof \WP_REST_Response ) {
+				$response->set_status( $status );
+				if ( is_array( $data ) && isset( $data['retry_after'] ) ) {
+					$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+				}
+			}
+
+			$result = $response;
+		} elseif ( $result instanceof \WP_REST_Response ) {
+			$status = $result->get_status();
+			$body   = $result->get_data();
+			if ( is_array( $body ) && isset( $body['error']['code'] ) ) {
+				$error_code = (string) $body['error']['code'];
+			}
+		} else {
+			$result = rest_ensure_response(
+				array(
+					'success' => true,
+					'data'    => $result,
+				)
+			);
+
+			if ( $result instanceof \WP_REST_Response ) {
+				$status = $result->get_status();
+			}
+		}
+
+		if ( class_exists( 'AgentWP\\API\\RestController' ) ) {
+			API\RestController::log_request( $request, $status, $error_code );
+		}
+
+		return $result;
+	}
+
+	/**
+	 * Check whether request targets AgentWP REST routes.
+	 *
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return bool
+	 */
+	private function is_agentwp_route( $request ) {
+		$route = $request->get_route();
+		$route = is_string( $route ) ? $route : '';
+
+		return ( 0 === strpos( $route, '/' . API\RestController::REST_NAMESPACE ) );
 	}
 
 	/**
diff --git a/src/Rest/HealthController.php b/src/Rest/HealthController.php
new file mode 100644
index 0000000000000000000000000000000000000000..4895348e00e2a1fd0e544e52c52a986c07050caa
--- /dev/null
+++ b/src/Rest/HealthController.php
@@ -0,0 +1,47 @@
+<?php
+/**
+ * Health REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class HealthController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/health',
+			array(
+				'methods'             => WP_REST_Server::READABLE,
+				'callback'            => array( $this, 'get_health' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Return health status.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function get_health( $request ) {
+		return $this->response_success(
+			array(
+				'status'  => 'ok',
+				'time'    => gmdate( 'c' ),
+				'version' => defined( 'AGENTWP_VERSION' ) ? AGENTWP_VERSION : '',
+			)
+		);
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..71b38c9ea8acfdf42086f3000283cebc8f109db0
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,76 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'     => 'object',
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..94c8bbe2a9b4f7e146df8925a0ab79f0930f4edb
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,6 +7,7 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
@@ -14,11 +15,7 @@
 use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +24,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +36,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +91,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +118,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +173,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +333,72 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
-
-		return $response;
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for API key payload.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
 				),
-			)
+			),
 		);
+	}
 
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
+	/**
+	 * Schema for usage query params.
+	 *
+	 * @return array
+	 */
+	private function get_usage_schema() {
+		return array(
+			'type'       => 'object',
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
+				),
+			),
+		);
 	}
 }


thinking
**Reviewing and refining REST response handling**

I'm examining rate limit and permission error handling in the REST API responses, especially how `format_rest_response` manages WP_REST_Response objects that contain error data versus direct WP_Error instances. I want to ensure error responses are converted to a consistent standard format with appropriate headers, carefully aligning with WordPress’s request dispatch flow and checking namespace and logging conditions without affecting unrelated endpoints. I'll adjust the logic to detect error structures inside WP_REST_Response data and handle retry headers properly.
file update
M /Users/ahmedyounis/Documents/Projects/agentwp/src/Plugin.php
@@ -242,3 +242,29 @@
 			$body   = $result->get_data();
-			if ( is_array( $body ) && isset( $body['error']['code'] ) ) {
+
+			if ( is_array( $body ) && isset( $body['code'], $body['message'] ) ) {
+				$error_code = (string) $body['code'];
+				$message    = (string) $body['message'];
+				$data       = isset( $body['data'] ) && is_array( $body['data'] ) ? $body['data'] : array();
+				$status     = isset( $data['status'] ) ? intval( $data['status'] ) : $status;
+
+				$response = rest_ensure_response(
+					array(
+						'success' => false,
+						'data'    => array(),
+						'error'   => array(
+							'code'    => $error_code,
+							'message' => $message,
+						),
+					)
+				);
+
+				if ( $response instanceof \WP_REST_Response ) {
+					$response->set_status( $status );
+					if ( isset( $data['retry_after'] ) ) {
+						$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+					}
+				}
+
+				$result = $response;
+			} elseif ( is_array( $body ) && isset( $body['error']['code'] ) ) {
 				$error_code = (string) $body['error']['code'];
apply_patch(auto_approved=true) exited 0 in 62ms:
Success. Updated the following files:
M src/Plugin.php
file update:
diff --git a/docs/openapi.json b/docs/openapi.json
new file mode 100644
index 0000000000000000000000000000000000000000..849f15d93104fabd8a394dc4195b96a609c010a0
--- /dev/null
+++ b/docs/openapi.json
@@ -0,0 +1,503 @@
+{
+  "openapi": "3.0.3",
+  "info": {
+    "title": "AgentWP REST API",
+    "version": "0.1.0",
+    "description": "OpenAPI specification for AgentWP REST endpoints."
+  },
+  "servers": [
+    {
+      "url": "/wp-json"
+    }
+  ],
+  "paths": {
+    "/agentwp/v1/intent": {
+      "post": {
+        "summary": "Submit an intent",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": true,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/IntentRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Intent accepted",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/IntentResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          },
+          "429": {
+            "description": "Rate limit exceeded",
+            "headers": {
+              "Retry-After": {
+                "schema": {
+                  "type": "integer"
+                }
+              }
+            },
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings": {
+      "get": {
+        "summary": "Get settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Settings payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          }
+        }
+      },
+      "post": {
+        "summary": "Update settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/SettingsUpdateRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Updated settings",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings/api-key": {
+      "post": {
+        "summary": "Store OpenAI API key",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/ApiKeyRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "API key stored",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ApiKeyResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid API key",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/usage": {
+      "get": {
+        "summary": "Get usage stats",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "parameters": [
+          {
+            "name": "period",
+            "in": "query",
+            "schema": {
+              "type": "string",
+              "enum": [
+                "day",
+                "week",
+                "month"
+              ]
+            }
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Usage stats",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/UsageResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid period",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/health": {
+      "get": {
+        "summary": "Health check",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Health status",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/HealthResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    }
+  },
+  "components": {
+    "securitySchemes": {
+      "nonceAuth": {
+        "type": "apiKey",
+        "in": "header",
+        "name": "X-WP-Nonce"
+      }
+    },
+    "schemas": {
+      "StandardResponse": {
+        "type": "object",
+        "required": [
+          "success",
+          "data"
+        ],
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {},
+          "error": {
+            "$ref": "#/components/schemas/ErrorObject"
+          }
+        }
+      },
+      "ErrorObject": {
+        "type": "object",
+        "required": [
+          "code",
+          "message"
+        ],
+        "properties": {
+          "code": {
+            "type": "string"
+          },
+          "message": {
+            "type": "string"
+          }
+        }
+      },
+      "ErrorResponse": {
+        "allOf": [
+          {
+            "$ref": "#/components/schemas/StandardResponse"
+          }
+        ]
+      },
+      "Settings": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string"
+          },
+          "budget_limit": {
+            "type": "number"
+          },
+          "draft_ttl_minutes": {
+            "type": "integer"
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string"
+          }
+        }
+      },
+      "SettingsResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "settings": {
+                "$ref": "#/components/schemas/Settings"
+              },
+              "api_key_last4": {
+                "type": "string"
+              },
+              "has_api_key": {
+                "type": "boolean"
+              },
+              "api_key_status": {
+                "type": "string"
+              },
+              "updated": {
+                "type": "boolean"
+              },
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "SettingsUpdateRequest": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string",
+            "enum": [
+              "gpt-4o",
+              "gpt-4o-mini"
+            ]
+          },
+          "budget_limit": {
+            "type": "number",
+            "minimum": 0
+          },
+          "draft_ttl_minutes": {
+            "type": "integer",
+            "minimum": 0
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string",
+            "enum": [
+              "light",
+              "dark"
+            ]
+          },
+          "dark_mode": {
+            "type": "boolean"
+          }
+        }
+      },
+      "ApiKeyRequest": {
+        "type": "object",
+        "properties": {
+          "api_key": {
+            "type": "string"
+          }
+        }
+      },
+      "ApiKeyResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "stored": {
+                "type": "boolean"
+              },
+              "last4": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "Usage": {
+        "type": "object",
+        "properties": {
+          "total_commands_month": {
+            "type": "integer"
+          },
+          "estimated_cost": {
+            "type": "number"
+          },
+          "last_sync": {
+            "type": "string"
+          }
+        }
+      },
+      "UsageResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "IntentRequest": {
+        "type": "object",
+        "required": [
+          "prompt"
+        ],
+        "properties": {
+          "prompt": {
+            "type": "string"
+          },
+          "context": {
+            "type": "object"
+          },
+          "metadata": {
+            "type": "object"
+          }
+        }
+      },
+      "IntentResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "intent_id": {
+                "type": "string"
+              },
+              "status": {
+                "type": "string"
+              },
+              "message": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "HealthResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "status": {
+                "type": "string"
+              },
+              "time": {
+                "type": "string"
+              },
+              "version": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      }
+    }
+  }
+}
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Plugin.php b/src/Plugin.php
index 98ff7ef58454d6f962b466d44ec14f8341d83ba0..bd440acbba688b48814b89a88c4bca62856fc56b
--- a/src/Plugin.php
+++ b/src/Plugin.php
@@ -73,6 +73,7 @@
 		add_action( 'admin_menu', array( $this, 'register_menu' ) );
 		add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_admin_assets' ) );
 		add_action( 'rest_api_init', array( $this, 'register_rest_routes' ) );
+		add_filter( 'rest_post_dispatch', array( $this, 'format_rest_response' ), 10, 3 );
 	}
 
 	/**
@@ -183,6 +184,122 @@
 			$controller = new Rest\SettingsController();
 			$controller->register_routes();
 		}
+
+		if ( class_exists( 'AgentWP\\Rest\\IntentController' ) ) {
+			$controller = new Rest\IntentController();
+			$controller->register_routes();
+		}
+
+		if ( class_exists( 'AgentWP\\Rest\\HealthController' ) ) {
+			$controller = new Rest\HealthController();
+			$controller->register_routes();
+		}
+	}
+
+	/**
+	 * Normalize REST responses and log requests.
+	 *
+	 * @param mixed           $result Response value.
+	 * @param \WP_REST_Server $server REST server instance.
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return mixed
+	 */
+	public function format_rest_response( $result, $server, $request ) {
+		if ( ! $this->is_agentwp_route( $request ) ) {
+			return $result;
+		}
+
+		$status     = 200;
+		$error_code = '';
+
+		if ( is_wp_error( $result ) ) {
+			$error_code = $result->get_error_code();
+			$message    = $result->get_error_message();
+			$data       = $result->get_error_data();
+			$status     = ( is_array( $data ) && isset( $data['status'] ) ) ? intval( $data['status'] ) : 500;
+
+			$response = rest_ensure_response(
+				array(
+					'success' => false,
+					'data'    => array(),
+					'error'   => array(
+						'code'    => $error_code,
+						'message' => $message,
+					),
+				)
+			);
+
+			if ( $response instanceof \WP_REST_Response ) {
+				$response->set_status( $status );
+				if ( is_array( $data ) && isset( $data['retry_after'] ) ) {
+					$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+				}
+			}
+
+			$result = $response;
+		} elseif ( $result instanceof \WP_REST_Response ) {
+			$status = $result->get_status();
+			$body   = $result->get_data();
+
+			if ( is_array( $body ) && isset( $body['code'], $body['message'] ) ) {
+				$error_code = (string) $body['code'];
+				$message    = (string) $body['message'];
+				$data       = isset( $body['data'] ) && is_array( $body['data'] ) ? $body['data'] : array();
+				$status     = isset( $data['status'] ) ? intval( $data['status'] ) : $status;
+
+				$response = rest_ensure_response(
+					array(
+						'success' => false,
+						'data'    => array(),
+						'error'   => array(
+							'code'    => $error_code,
+							'message' => $message,
+						),
+					)
+				);
+
+				if ( $response instanceof \WP_REST_Response ) {
+					$response->set_status( $status );
+					if ( isset( $data['retry_after'] ) ) {
+						$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+					}
+				}
+
+				$result = $response;
+			} elseif ( is_array( $body ) && isset( $body['error']['code'] ) ) {
+				$error_code = (string) $body['error']['code'];
+			}
+		} else {
+			$result = rest_ensure_response(
+				array(
+					'success' => true,
+					'data'    => $result,
+				)
+			);
+
+			if ( $result instanceof \WP_REST_Response ) {
+				$status = $result->get_status();
+			}
+		}
+
+		if ( class_exists( 'AgentWP\\API\\RestController' ) ) {
+			API\RestController::log_request( $request, $status, $error_code );
+		}
+
+		return $result;
+	}
+
+	/**
+	 * Check whether request targets AgentWP REST routes.
+	 *
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return bool
+	 */
+	private function is_agentwp_route( $request ) {
+		$route = $request->get_route();
+		$route = is_string( $route ) ? $route : '';
+
+		return ( 0 === strpos( $route, '/' . API\RestController::REST_NAMESPACE ) );
 	}
 
 	/**
diff --git a/src/Rest/HealthController.php b/src/Rest/HealthController.php
new file mode 100644
index 0000000000000000000000000000000000000000..4895348e00e2a1fd0e544e52c52a986c07050caa
--- /dev/null
+++ b/src/Rest/HealthController.php
@@ -0,0 +1,47 @@
+<?php
+/**
+ * Health REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class HealthController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/health',
+			array(
+				'methods'             => WP_REST_Server::READABLE,
+				'callback'            => array( $this, 'get_health' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Return health status.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function get_health( $request ) {
+		return $this->response_success(
+			array(
+				'status'  => 'ok',
+				'time'    => gmdate( 'c' ),
+				'version' => defined( 'AGENTWP_VERSION' ) ? AGENTWP_VERSION : '',
+			)
+		);
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..71b38c9ea8acfdf42086f3000283cebc8f109db0
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,76 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'     => 'object',
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..94c8bbe2a9b4f7e146df8925a0ab79f0930f4edb
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,6 +7,7 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
@@ -14,11 +15,7 @@
 use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +24,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +36,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +91,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +118,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +173,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +333,72 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
-
-		return $response;
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for API key payload.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
 				),
-			)
+			),
 		);
+	}
 
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
+	/**
+	 * Schema for usage query params.
+	 *
+	 * @return array
+	 */
+	private function get_usage_schema() {
+		return array(
+			'type'       => 'object',
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
+				),
+			),
+		);
 	}
 }

file update:
diff --git a/docs/openapi.json b/docs/openapi.json
new file mode 100644
index 0000000000000000000000000000000000000000..849f15d93104fabd8a394dc4195b96a609c010a0
--- /dev/null
+++ b/docs/openapi.json
@@ -0,0 +1,503 @@
+{
+  "openapi": "3.0.3",
+  "info": {
+    "title": "AgentWP REST API",
+    "version": "0.1.0",
+    "description": "OpenAPI specification for AgentWP REST endpoints."
+  },
+  "servers": [
+    {
+      "url": "/wp-json"
+    }
+  ],
+  "paths": {
+    "/agentwp/v1/intent": {
+      "post": {
+        "summary": "Submit an intent",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": true,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/IntentRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Intent accepted",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/IntentResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          },
+          "429": {
+            "description": "Rate limit exceeded",
+            "headers": {
+              "Retry-After": {
+                "schema": {
+                  "type": "integer"
+                }
+              }
+            },
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings": {
+      "get": {
+        "summary": "Get settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Settings payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          }
+        }
+      },
+      "post": {
+        "summary": "Update settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/SettingsUpdateRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Updated settings",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings/api-key": {
+      "post": {
+        "summary": "Store OpenAI API key",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/ApiKeyRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "API key stored",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ApiKeyResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid API key",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/usage": {
+      "get": {
+        "summary": "Get usage stats",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "parameters": [
+          {
+            "name": "period",
+            "in": "query",
+            "schema": {
+              "type": "string",
+              "enum": [
+                "day",
+                "week",
+                "month"
+              ]
+            }
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Usage stats",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/UsageResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid period",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/health": {
+      "get": {
+        "summary": "Health check",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Health status",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/HealthResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    }
+  },
+  "components": {
+    "securitySchemes": {
+      "nonceAuth": {
+        "type": "apiKey",
+        "in": "header",
+        "name": "X-WP-Nonce"
+      }
+    },
+    "schemas": {
+      "StandardResponse": {
+        "type": "object",
+        "required": [
+          "success",
+          "data"
+        ],
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {},
+          "error": {
+            "$ref": "#/components/schemas/ErrorObject"
+          }
+        }
+      },
+      "ErrorObject": {
+        "type": "object",
+        "required": [
+          "code",
+          "message"
+        ],
+        "properties": {
+          "code": {
+            "type": "string"
+          },
+          "message": {
+            "type": "string"
+          }
+        }
+      },
+      "ErrorResponse": {
+        "allOf": [
+          {
+            "$ref": "#/components/schemas/StandardResponse"
+          }
+        ]
+      },
+      "Settings": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string"
+          },
+          "budget_limit": {
+            "type": "number"
+          },
+          "draft_ttl_minutes": {
+            "type": "integer"
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string"
+          }
+        }
+      },
+      "SettingsResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "settings": {
+                "$ref": "#/components/schemas/Settings"
+              },
+              "api_key_last4": {
+                "type": "string"
+              },
+              "has_api_key": {
+                "type": "boolean"
+              },
+              "api_key_status": {
+                "type": "string"
+              },
+              "updated": {
+                "type": "boolean"
+              },
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "SettingsUpdateRequest": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string",
+            "enum": [
+              "gpt-4o",
+              "gpt-4o-mini"
+            ]
+          },
+          "budget_limit": {
+            "type": "number",
+            "minimum": 0
+          },
+          "draft_ttl_minutes": {
+            "type": "integer",
+            "minimum": 0
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string",
+            "enum": [
+              "light",
+              "dark"
+            ]
+          },
+          "dark_mode": {
+            "type": "boolean"
+          }
+        }
+      },
+      "ApiKeyRequest": {
+        "type": "object",
+        "properties": {
+          "api_key": {
+            "type": "string"
+          }
+        }
+      },
+      "ApiKeyResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "stored": {
+                "type": "boolean"
+              },
+              "last4": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "Usage": {
+        "type": "object",
+        "properties": {
+          "total_commands_month": {
+            "type": "integer"
+          },
+          "estimated_cost": {
+            "type": "number"
+          },
+          "last_sync": {
+            "type": "string"
+          }
+        }
+      },
+      "UsageResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "IntentRequest": {
+        "type": "object",
+        "required": [
+          "prompt"
+        ],
+        "properties": {
+          "prompt": {
+            "type": "string"
+          },
+          "context": {
+            "type": "object"
+          },
+          "metadata": {
+            "type": "object"
+          }
+        }
+      },
+      "IntentResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "intent_id": {
+                "type": "string"
+              },
+              "status": {
+                "type": "string"
+              },
+              "message": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "HealthResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "status": {
+                "type": "string"
+              },
+              "time": {
+                "type": "string"
+              },
+              "version": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      }
+    }
+  }
+}
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Plugin.php b/src/Plugin.php
index 98ff7ef58454d6f962b466d44ec14f8341d83ba0..bd440acbba688b48814b89a88c4bca62856fc56b
--- a/src/Plugin.php
+++ b/src/Plugin.php
@@ -73,6 +73,7 @@
 		add_action( 'admin_menu', array( $this, 'register_menu' ) );
 		add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_admin_assets' ) );
 		add_action( 'rest_api_init', array( $this, 'register_rest_routes' ) );
+		add_filter( 'rest_post_dispatch', array( $this, 'format_rest_response' ), 10, 3 );
 	}
 
 	/**
@@ -183,6 +184,122 @@
 			$controller = new Rest\SettingsController();
 			$controller->register_routes();
 		}
+
+		if ( class_exists( 'AgentWP\\Rest\\IntentController' ) ) {
+			$controller = new Rest\IntentController();
+			$controller->register_routes();
+		}
+
+		if ( class_exists( 'AgentWP\\Rest\\HealthController' ) ) {
+			$controller = new Rest\HealthController();
+			$controller->register_routes();
+		}
+	}
+
+	/**
+	 * Normalize REST responses and log requests.
+	 *
+	 * @param mixed           $result Response value.
+	 * @param \WP_REST_Server $server REST server instance.
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return mixed
+	 */
+	public function format_rest_response( $result, $server, $request ) {
+		if ( ! $this->is_agentwp_route( $request ) ) {
+			return $result;
+		}
+
+		$status     = 200;
+		$error_code = '';
+
+		if ( is_wp_error( $result ) ) {
+			$error_code = $result->get_error_code();
+			$message    = $result->get_error_message();
+			$data       = $result->get_error_data();
+			$status     = ( is_array( $data ) && isset( $data['status'] ) ) ? intval( $data['status'] ) : 500;
+
+			$response = rest_ensure_response(
+				array(
+					'success' => false,
+					'data'    => array(),
+					'error'   => array(
+						'code'    => $error_code,
+						'message' => $message,
+					),
+				)
+			);
+
+			if ( $response instanceof \WP_REST_Response ) {
+				$response->set_status( $status );
+				if ( is_array( $data ) && isset( $data['retry_after'] ) ) {
+					$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+				}
+			}
+
+			$result = $response;
+		} elseif ( $result instanceof \WP_REST_Response ) {
+			$status = $result->get_status();
+			$body   = $result->get_data();
+
+			if ( is_array( $body ) && isset( $body['code'], $body['message'] ) ) {
+				$error_code = (string) $body['code'];
+				$message    = (string) $body['message'];
+				$data       = isset( $body['data'] ) && is_array( $body['data'] ) ? $body['data'] : array();
+				$status     = isset( $data['status'] ) ? intval( $data['status'] ) : $status;
+
+				$response = rest_ensure_response(
+					array(
+						'success' => false,
+						'data'    => array(),
+						'error'   => array(
+							'code'    => $error_code,
+							'message' => $message,
+						),
+					)
+				);
+
+				if ( $response instanceof \WP_REST_Response ) {
+					$response->set_status( $status );
+					if ( isset( $data['retry_after'] ) ) {
+						$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+					}
+				}
+
+				$result = $response;
+			} elseif ( is_array( $body ) && isset( $body['error']['code'] ) ) {
+				$error_code = (string) $body['error']['code'];
+			}
+		} else {
+			$result = rest_ensure_response(
+				array(
+					'success' => true,
+					'data'    => $result,
+				)
+			);
+
+			if ( $result instanceof \WP_REST_Response ) {
+				$status = $result->get_status();
+			}
+		}
+
+		if ( class_exists( 'AgentWP\\API\\RestController' ) ) {
+			API\RestController::log_request( $request, $status, $error_code );
+		}
+
+		return $result;
+	}
+
+	/**
+	 * Check whether request targets AgentWP REST routes.
+	 *
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return bool
+	 */
+	private function is_agentwp_route( $request ) {
+		$route = $request->get_route();
+		$route = is_string( $route ) ? $route : '';
+
+		return ( 0 === strpos( $route, '/' . API\RestController::REST_NAMESPACE ) );
 	}
 
 	/**
diff --git a/src/Rest/HealthController.php b/src/Rest/HealthController.php
new file mode 100644
index 0000000000000000000000000000000000000000..4895348e00e2a1fd0e544e52c52a986c07050caa
--- /dev/null
+++ b/src/Rest/HealthController.php
@@ -0,0 +1,47 @@
+<?php
+/**
+ * Health REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class HealthController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/health',
+			array(
+				'methods'             => WP_REST_Server::READABLE,
+				'callback'            => array( $this, 'get_health' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Return health status.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function get_health( $request ) {
+		return $this->response_success(
+			array(
+				'status'  => 'ok',
+				'time'    => gmdate( 'c' ),
+				'version' => defined( 'AGENTWP_VERSION' ) ? AGENTWP_VERSION : '',
+			)
+		);
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..71b38c9ea8acfdf42086f3000283cebc8f109db0
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,76 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'     => 'object',
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..94c8bbe2a9b4f7e146df8925a0ab79f0930f4edb
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,6 +7,7 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
@@ -14,11 +15,7 @@
 use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +24,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +36,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +91,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +118,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +173,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +333,72 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
-
-		return $response;
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for API key payload.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
 				),
-			)
+			),
 		);
+	}
 
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
+	/**
+	 * Schema for usage query params.
+	 *
+	 * @return array
+	 */
+	private function get_usage_schema() {
+		return array(
+			'type'       => 'object',
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
+				),
+			),
+		);
 	}
 }


thinking
**Reviewing response status handling and imports**

I'm sorting through how the `status` variable is set and updated after wrapping responses, making sure it stays consistent for logging and error handling. I'm also considering tidying up imports by removing unused `WP_REST_Response` and `WP_REST_Request` statements in certain controllers to keep things clean without breaking docblock references.
file update
M /Users/ahmedyounis/Documents/Projects/agentwp/src/Rest/SettingsController.php
@@ -14,3 +14,2 @@
 use WP_REST_Request;
-use WP_REST_Response;
 use WP_REST_Server;
apply_patch(auto_approved=true) exited 0 in 64ms:
Success. Updated the following files:
M src/Rest/SettingsController.php
file update:
diff --git a/docs/openapi.json b/docs/openapi.json
new file mode 100644
index 0000000000000000000000000000000000000000..849f15d93104fabd8a394dc4195b96a609c010a0
--- /dev/null
+++ b/docs/openapi.json
@@ -0,0 +1,503 @@
+{
+  "openapi": "3.0.3",
+  "info": {
+    "title": "AgentWP REST API",
+    "version": "0.1.0",
+    "description": "OpenAPI specification for AgentWP REST endpoints."
+  },
+  "servers": [
+    {
+      "url": "/wp-json"
+    }
+  ],
+  "paths": {
+    "/agentwp/v1/intent": {
+      "post": {
+        "summary": "Submit an intent",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": true,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/IntentRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Intent accepted",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/IntentResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          },
+          "429": {
+            "description": "Rate limit exceeded",
+            "headers": {
+              "Retry-After": {
+                "schema": {
+                  "type": "integer"
+                }
+              }
+            },
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings": {
+      "get": {
+        "summary": "Get settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Settings payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          }
+        }
+      },
+      "post": {
+        "summary": "Update settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/SettingsUpdateRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Updated settings",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings/api-key": {
+      "post": {
+        "summary": "Store OpenAI API key",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/ApiKeyRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "API key stored",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ApiKeyResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid API key",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/usage": {
+      "get": {
+        "summary": "Get usage stats",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "parameters": [
+          {
+            "name": "period",
+            "in": "query",
+            "schema": {
+              "type": "string",
+              "enum": [
+                "day",
+                "week",
+                "month"
+              ]
+            }
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Usage stats",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/UsageResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid period",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/health": {
+      "get": {
+        "summary": "Health check",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Health status",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/HealthResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    }
+  },
+  "components": {
+    "securitySchemes": {
+      "nonceAuth": {
+        "type": "apiKey",
+        "in": "header",
+        "name": "X-WP-Nonce"
+      }
+    },
+    "schemas": {
+      "StandardResponse": {
+        "type": "object",
+        "required": [
+          "success",
+          "data"
+        ],
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {},
+          "error": {
+            "$ref": "#/components/schemas/ErrorObject"
+          }
+        }
+      },
+      "ErrorObject": {
+        "type": "object",
+        "required": [
+          "code",
+          "message"
+        ],
+        "properties": {
+          "code": {
+            "type": "string"
+          },
+          "message": {
+            "type": "string"
+          }
+        }
+      },
+      "ErrorResponse": {
+        "allOf": [
+          {
+            "$ref": "#/components/schemas/StandardResponse"
+          }
+        ]
+      },
+      "Settings": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string"
+          },
+          "budget_limit": {
+            "type": "number"
+          },
+          "draft_ttl_minutes": {
+            "type": "integer"
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string"
+          }
+        }
+      },
+      "SettingsResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "settings": {
+                "$ref": "#/components/schemas/Settings"
+              },
+              "api_key_last4": {
+                "type": "string"
+              },
+              "has_api_key": {
+                "type": "boolean"
+              },
+              "api_key_status": {
+                "type": "string"
+              },
+              "updated": {
+                "type": "boolean"
+              },
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "SettingsUpdateRequest": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string",
+            "enum": [
+              "gpt-4o",
+              "gpt-4o-mini"
+            ]
+          },
+          "budget_limit": {
+            "type": "number",
+            "minimum": 0
+          },
+          "draft_ttl_minutes": {
+            "type": "integer",
+            "minimum": 0
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string",
+            "enum": [
+              "light",
+              "dark"
+            ]
+          },
+          "dark_mode": {
+            "type": "boolean"
+          }
+        }
+      },
+      "ApiKeyRequest": {
+        "type": "object",
+        "properties": {
+          "api_key": {
+            "type": "string"
+          }
+        }
+      },
+      "ApiKeyResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "stored": {
+                "type": "boolean"
+              },
+              "last4": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "Usage": {
+        "type": "object",
+        "properties": {
+          "total_commands_month": {
+            "type": "integer"
+          },
+          "estimated_cost": {
+            "type": "number"
+          },
+          "last_sync": {
+            "type": "string"
+          }
+        }
+      },
+      "UsageResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "IntentRequest": {
+        "type": "object",
+        "required": [
+          "prompt"
+        ],
+        "properties": {
+          "prompt": {
+            "type": "string"
+          },
+          "context": {
+            "type": "object"
+          },
+          "metadata": {
+            "type": "object"
+          }
+        }
+      },
+      "IntentResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "intent_id": {
+                "type": "string"
+              },
+              "status": {
+                "type": "string"
+              },
+              "message": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "HealthResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "status": {
+                "type": "string"
+              },
+              "time": {
+                "type": "string"
+              },
+              "version": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      }
+    }
+  }
+}
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Plugin.php b/src/Plugin.php
index 98ff7ef58454d6f962b466d44ec14f8341d83ba0..bd440acbba688b48814b89a88c4bca62856fc56b
--- a/src/Plugin.php
+++ b/src/Plugin.php
@@ -73,6 +73,7 @@
 		add_action( 'admin_menu', array( $this, 'register_menu' ) );
 		add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_admin_assets' ) );
 		add_action( 'rest_api_init', array( $this, 'register_rest_routes' ) );
+		add_filter( 'rest_post_dispatch', array( $this, 'format_rest_response' ), 10, 3 );
 	}
 
 	/**
@@ -183,6 +184,122 @@
 			$controller = new Rest\SettingsController();
 			$controller->register_routes();
 		}
+
+		if ( class_exists( 'AgentWP\\Rest\\IntentController' ) ) {
+			$controller = new Rest\IntentController();
+			$controller->register_routes();
+		}
+
+		if ( class_exists( 'AgentWP\\Rest\\HealthController' ) ) {
+			$controller = new Rest\HealthController();
+			$controller->register_routes();
+		}
+	}
+
+	/**
+	 * Normalize REST responses and log requests.
+	 *
+	 * @param mixed           $result Response value.
+	 * @param \WP_REST_Server $server REST server instance.
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return mixed
+	 */
+	public function format_rest_response( $result, $server, $request ) {
+		if ( ! $this->is_agentwp_route( $request ) ) {
+			return $result;
+		}
+
+		$status     = 200;
+		$error_code = '';
+
+		if ( is_wp_error( $result ) ) {
+			$error_code = $result->get_error_code();
+			$message    = $result->get_error_message();
+			$data       = $result->get_error_data();
+			$status     = ( is_array( $data ) && isset( $data['status'] ) ) ? intval( $data['status'] ) : 500;
+
+			$response = rest_ensure_response(
+				array(
+					'success' => false,
+					'data'    => array(),
+					'error'   => array(
+						'code'    => $error_code,
+						'message' => $message,
+					),
+				)
+			);
+
+			if ( $response instanceof \WP_REST_Response ) {
+				$response->set_status( $status );
+				if ( is_array( $data ) && isset( $data['retry_after'] ) ) {
+					$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+				}
+			}
+
+			$result = $response;
+		} elseif ( $result instanceof \WP_REST_Response ) {
+			$status = $result->get_status();
+			$body   = $result->get_data();
+
+			if ( is_array( $body ) && isset( $body['code'], $body['message'] ) ) {
+				$error_code = (string) $body['code'];
+				$message    = (string) $body['message'];
+				$data       = isset( $body['data'] ) && is_array( $body['data'] ) ? $body['data'] : array();
+				$status     = isset( $data['status'] ) ? intval( $data['status'] ) : $status;
+
+				$response = rest_ensure_response(
+					array(
+						'success' => false,
+						'data'    => array(),
+						'error'   => array(
+							'code'    => $error_code,
+							'message' => $message,
+						),
+					)
+				);
+
+				if ( $response instanceof \WP_REST_Response ) {
+					$response->set_status( $status );
+					if ( isset( $data['retry_after'] ) ) {
+						$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+					}
+				}
+
+				$result = $response;
+			} elseif ( is_array( $body ) && isset( $body['error']['code'] ) ) {
+				$error_code = (string) $body['error']['code'];
+			}
+		} else {
+			$result = rest_ensure_response(
+				array(
+					'success' => true,
+					'data'    => $result,
+				)
+			);
+
+			if ( $result instanceof \WP_REST_Response ) {
+				$status = $result->get_status();
+			}
+		}
+
+		if ( class_exists( 'AgentWP\\API\\RestController' ) ) {
+			API\RestController::log_request( $request, $status, $error_code );
+		}
+
+		return $result;
+	}
+
+	/**
+	 * Check whether request targets AgentWP REST routes.
+	 *
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return bool
+	 */
+	private function is_agentwp_route( $request ) {
+		$route = $request->get_route();
+		$route = is_string( $route ) ? $route : '';
+
+		return ( 0 === strpos( $route, '/' . API\RestController::REST_NAMESPACE ) );
 	}
 
 	/**
diff --git a/src/Rest/HealthController.php b/src/Rest/HealthController.php
new file mode 100644
index 0000000000000000000000000000000000000000..4895348e00e2a1fd0e544e52c52a986c07050caa
--- /dev/null
+++ b/src/Rest/HealthController.php
@@ -0,0 +1,47 @@
+<?php
+/**
+ * Health REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class HealthController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/health',
+			array(
+				'methods'             => WP_REST_Server::READABLE,
+				'callback'            => array( $this, 'get_health' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Return health status.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function get_health( $request ) {
+		return $this->response_success(
+			array(
+				'status'  => 'ok',
+				'time'    => gmdate( 'c' ),
+				'version' => defined( 'AGENTWP_VERSION' ) ? AGENTWP_VERSION : '',
+			)
+		);
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..71b38c9ea8acfdf42086f3000283cebc8f109db0
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,76 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'     => 'object',
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..5667ab70fbff346da829015a43680abf8e754029
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,18 +7,14 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
 use WP_REST_Request;
-use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +23,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +35,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +90,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +117,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +172,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +332,72 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
+	}
 
-		return $response;
+	/**
+	 * Schema for API key payload.
+	 *
+	 * @return array
+	 */
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
+				),
+			),
+		);
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for usage query params.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_usage_schema() {
+		return array(
+			'type'       => 'object',
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
 	}
 }

file update:
diff --git a/docs/openapi.json b/docs/openapi.json
new file mode 100644
index 0000000000000000000000000000000000000000..849f15d93104fabd8a394dc4195b96a609c010a0
--- /dev/null
+++ b/docs/openapi.json
@@ -0,0 +1,503 @@
+{
+  "openapi": "3.0.3",
+  "info": {
+    "title": "AgentWP REST API",
+    "version": "0.1.0",
+    "description": "OpenAPI specification for AgentWP REST endpoints."
+  },
+  "servers": [
+    {
+      "url": "/wp-json"
+    }
+  ],
+  "paths": {
+    "/agentwp/v1/intent": {
+      "post": {
+        "summary": "Submit an intent",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": true,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/IntentRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Intent accepted",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/IntentResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          },
+          "429": {
+            "description": "Rate limit exceeded",
+            "headers": {
+              "Retry-After": {
+                "schema": {
+                  "type": "integer"
+                }
+              }
+            },
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings": {
+      "get": {
+        "summary": "Get settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Settings payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          }
+        }
+      },
+      "post": {
+        "summary": "Update settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/SettingsUpdateRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Updated settings",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings/api-key": {
+      "post": {
+        "summary": "Store OpenAI API key",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/ApiKeyRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "API key stored",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ApiKeyResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid API key",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/usage": {
+      "get": {
+        "summary": "Get usage stats",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "parameters": [
+          {
+            "name": "period",
+            "in": "query",
+            "schema": {
+              "type": "string",
+              "enum": [
+                "day",
+                "week",
+                "month"
+              ]
+            }
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Usage stats",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/UsageResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid period",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/health": {
+      "get": {
+        "summary": "Health check",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Health status",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/HealthResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    }
+  },
+  "components": {
+    "securitySchemes": {
+      "nonceAuth": {
+        "type": "apiKey",
+        "in": "header",
+        "name": "X-WP-Nonce"
+      }
+    },
+    "schemas": {
+      "StandardResponse": {
+        "type": "object",
+        "required": [
+          "success",
+          "data"
+        ],
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {},
+          "error": {
+            "$ref": "#/components/schemas/ErrorObject"
+          }
+        }
+      },
+      "ErrorObject": {
+        "type": "object",
+        "required": [
+          "code",
+          "message"
+        ],
+        "properties": {
+          "code": {
+            "type": "string"
+          },
+          "message": {
+            "type": "string"
+          }
+        }
+      },
+      "ErrorResponse": {
+        "allOf": [
+          {
+            "$ref": "#/components/schemas/StandardResponse"
+          }
+        ]
+      },
+      "Settings": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string"
+          },
+          "budget_limit": {
+            "type": "number"
+          },
+          "draft_ttl_minutes": {
+            "type": "integer"
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string"
+          }
+        }
+      },
+      "SettingsResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "settings": {
+                "$ref": "#/components/schemas/Settings"
+              },
+              "api_key_last4": {
+                "type": "string"
+              },
+              "has_api_key": {
+                "type": "boolean"
+              },
+              "api_key_status": {
+                "type": "string"
+              },
+              "updated": {
+                "type": "boolean"
+              },
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "SettingsUpdateRequest": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string",
+            "enum": [
+              "gpt-4o",
+              "gpt-4o-mini"
+            ]
+          },
+          "budget_limit": {
+            "type": "number",
+            "minimum": 0
+          },
+          "draft_ttl_minutes": {
+            "type": "integer",
+            "minimum": 0
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string",
+            "enum": [
+              "light",
+              "dark"
+            ]
+          },
+          "dark_mode": {
+            "type": "boolean"
+          }
+        }
+      },
+      "ApiKeyRequest": {
+        "type": "object",
+        "properties": {
+          "api_key": {
+            "type": "string"
+          }
+        }
+      },
+      "ApiKeyResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "stored": {
+                "type": "boolean"
+              },
+              "last4": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "Usage": {
+        "type": "object",
+        "properties": {
+          "total_commands_month": {
+            "type": "integer"
+          },
+          "estimated_cost": {
+            "type": "number"
+          },
+          "last_sync": {
+            "type": "string"
+          }
+        }
+      },
+      "UsageResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "IntentRequest": {
+        "type": "object",
+        "required": [
+          "prompt"
+        ],
+        "properties": {
+          "prompt": {
+            "type": "string"
+          },
+          "context": {
+            "type": "object"
+          },
+          "metadata": {
+            "type": "object"
+          }
+        }
+      },
+      "IntentResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "intent_id": {
+                "type": "string"
+              },
+              "status": {
+                "type": "string"
+              },
+              "message": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "HealthResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "status": {
+                "type": "string"
+              },
+              "time": {
+                "type": "string"
+              },
+              "version": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      }
+    }
+  }
+}
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Plugin.php b/src/Plugin.php
index 98ff7ef58454d6f962b466d44ec14f8341d83ba0..bd440acbba688b48814b89a88c4bca62856fc56b
--- a/src/Plugin.php
+++ b/src/Plugin.php
@@ -73,6 +73,7 @@
 		add_action( 'admin_menu', array( $this, 'register_menu' ) );
 		add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_admin_assets' ) );
 		add_action( 'rest_api_init', array( $this, 'register_rest_routes' ) );
+		add_filter( 'rest_post_dispatch', array( $this, 'format_rest_response' ), 10, 3 );
 	}
 
 	/**
@@ -183,6 +184,122 @@
 			$controller = new Rest\SettingsController();
 			$controller->register_routes();
 		}
+
+		if ( class_exists( 'AgentWP\\Rest\\IntentController' ) ) {
+			$controller = new Rest\IntentController();
+			$controller->register_routes();
+		}
+
+		if ( class_exists( 'AgentWP\\Rest\\HealthController' ) ) {
+			$controller = new Rest\HealthController();
+			$controller->register_routes();
+		}
+	}
+
+	/**
+	 * Normalize REST responses and log requests.
+	 *
+	 * @param mixed           $result Response value.
+	 * @param \WP_REST_Server $server REST server instance.
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return mixed
+	 */
+	public function format_rest_response( $result, $server, $request ) {
+		if ( ! $this->is_agentwp_route( $request ) ) {
+			return $result;
+		}
+
+		$status     = 200;
+		$error_code = '';
+
+		if ( is_wp_error( $result ) ) {
+			$error_code = $result->get_error_code();
+			$message    = $result->get_error_message();
+			$data       = $result->get_error_data();
+			$status     = ( is_array( $data ) && isset( $data['status'] ) ) ? intval( $data['status'] ) : 500;
+
+			$response = rest_ensure_response(
+				array(
+					'success' => false,
+					'data'    => array(),
+					'error'   => array(
+						'code'    => $error_code,
+						'message' => $message,
+					),
+				)
+			);
+
+			if ( $response instanceof \WP_REST_Response ) {
+				$response->set_status( $status );
+				if ( is_array( $data ) && isset( $data['retry_after'] ) ) {
+					$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+				}
+			}
+
+			$result = $response;
+		} elseif ( $result instanceof \WP_REST_Response ) {
+			$status = $result->get_status();
+			$body   = $result->get_data();
+
+			if ( is_array( $body ) && isset( $body['code'], $body['message'] ) ) {
+				$error_code = (string) $body['code'];
+				$message    = (string) $body['message'];
+				$data       = isset( $body['data'] ) && is_array( $body['data'] ) ? $body['data'] : array();
+				$status     = isset( $data['status'] ) ? intval( $data['status'] ) : $status;
+
+				$response = rest_ensure_response(
+					array(
+						'success' => false,
+						'data'    => array(),
+						'error'   => array(
+							'code'    => $error_code,
+							'message' => $message,
+						),
+					)
+				);
+
+				if ( $response instanceof \WP_REST_Response ) {
+					$response->set_status( $status );
+					if ( isset( $data['retry_after'] ) ) {
+						$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+					}
+				}
+
+				$result = $response;
+			} elseif ( is_array( $body ) && isset( $body['error']['code'] ) ) {
+				$error_code = (string) $body['error']['code'];
+			}
+		} else {
+			$result = rest_ensure_response(
+				array(
+					'success' => true,
+					'data'    => $result,
+				)
+			);
+
+			if ( $result instanceof \WP_REST_Response ) {
+				$status = $result->get_status();
+			}
+		}
+
+		if ( class_exists( 'AgentWP\\API\\RestController' ) ) {
+			API\RestController::log_request( $request, $status, $error_code );
+		}
+
+		return $result;
+	}
+
+	/**
+	 * Check whether request targets AgentWP REST routes.
+	 *
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return bool
+	 */
+	private function is_agentwp_route( $request ) {
+		$route = $request->get_route();
+		$route = is_string( $route ) ? $route : '';
+
+		return ( 0 === strpos( $route, '/' . API\RestController::REST_NAMESPACE ) );
 	}
 
 	/**
diff --git a/src/Rest/HealthController.php b/src/Rest/HealthController.php
new file mode 100644
index 0000000000000000000000000000000000000000..4895348e00e2a1fd0e544e52c52a986c07050caa
--- /dev/null
+++ b/src/Rest/HealthController.php
@@ -0,0 +1,47 @@
+<?php
+/**
+ * Health REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class HealthController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/health',
+			array(
+				'methods'             => WP_REST_Server::READABLE,
+				'callback'            => array( $this, 'get_health' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Return health status.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function get_health( $request ) {
+		return $this->response_success(
+			array(
+				'status'  => 'ok',
+				'time'    => gmdate( 'c' ),
+				'version' => defined( 'AGENTWP_VERSION' ) ? AGENTWP_VERSION : '',
+			)
+		);
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..71b38c9ea8acfdf42086f3000283cebc8f109db0
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,76 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'     => 'object',
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..5667ab70fbff346da829015a43680abf8e754029
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,18 +7,14 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
 use WP_REST_Request;
-use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +23,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +35,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +90,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +117,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +172,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +332,72 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
+	}
 
-		return $response;
+	/**
+	 * Schema for API key payload.
+	 *
+	 * @return array
+	 */
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
+				),
+			),
+		);
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for usage query params.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_usage_schema() {
+		return array(
+			'type'       => 'object',
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
 	}
 }


thinking
**Cleaning up unused imports**
file update
M /Users/ahmedyounis/Documents/Projects/agentwp/src/Rest/SettingsController.php
@@ -13,3 +13,2 @@
 use WP_Error;
-use WP_REST_Request;
 use WP_REST_Server;
apply_patch(auto_approved=true) exited 0 in 53ms:
Success. Updated the following files:
M src/Rest/SettingsController.php
file update:
diff --git a/docs/openapi.json b/docs/openapi.json
new file mode 100644
index 0000000000000000000000000000000000000000..849f15d93104fabd8a394dc4195b96a609c010a0
--- /dev/null
+++ b/docs/openapi.json
@@ -0,0 +1,503 @@
+{
+  "openapi": "3.0.3",
+  "info": {
+    "title": "AgentWP REST API",
+    "version": "0.1.0",
+    "description": "OpenAPI specification for AgentWP REST endpoints."
+  },
+  "servers": [
+    {
+      "url": "/wp-json"
+    }
+  ],
+  "paths": {
+    "/agentwp/v1/intent": {
+      "post": {
+        "summary": "Submit an intent",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": true,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/IntentRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Intent accepted",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/IntentResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          },
+          "429": {
+            "description": "Rate limit exceeded",
+            "headers": {
+              "Retry-After": {
+                "schema": {
+                  "type": "integer"
+                }
+              }
+            },
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings": {
+      "get": {
+        "summary": "Get settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Settings payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          }
+        }
+      },
+      "post": {
+        "summary": "Update settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/SettingsUpdateRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Updated settings",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings/api-key": {
+      "post": {
+        "summary": "Store OpenAI API key",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/ApiKeyRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "API key stored",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ApiKeyResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid API key",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/usage": {
+      "get": {
+        "summary": "Get usage stats",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "parameters": [
+          {
+            "name": "period",
+            "in": "query",
+            "schema": {
+              "type": "string",
+              "enum": [
+                "day",
+                "week",
+                "month"
+              ]
+            }
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Usage stats",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/UsageResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid period",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/health": {
+      "get": {
+        "summary": "Health check",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Health status",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/HealthResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    }
+  },
+  "components": {
+    "securitySchemes": {
+      "nonceAuth": {
+        "type": "apiKey",
+        "in": "header",
+        "name": "X-WP-Nonce"
+      }
+    },
+    "schemas": {
+      "StandardResponse": {
+        "type": "object",
+        "required": [
+          "success",
+          "data"
+        ],
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {},
+          "error": {
+            "$ref": "#/components/schemas/ErrorObject"
+          }
+        }
+      },
+      "ErrorObject": {
+        "type": "object",
+        "required": [
+          "code",
+          "message"
+        ],
+        "properties": {
+          "code": {
+            "type": "string"
+          },
+          "message": {
+            "type": "string"
+          }
+        }
+      },
+      "ErrorResponse": {
+        "allOf": [
+          {
+            "$ref": "#/components/schemas/StandardResponse"
+          }
+        ]
+      },
+      "Settings": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string"
+          },
+          "budget_limit": {
+            "type": "number"
+          },
+          "draft_ttl_minutes": {
+            "type": "integer"
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string"
+          }
+        }
+      },
+      "SettingsResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "settings": {
+                "$ref": "#/components/schemas/Settings"
+              },
+              "api_key_last4": {
+                "type": "string"
+              },
+              "has_api_key": {
+                "type": "boolean"
+              },
+              "api_key_status": {
+                "type": "string"
+              },
+              "updated": {
+                "type": "boolean"
+              },
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "SettingsUpdateRequest": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string",
+            "enum": [
+              "gpt-4o",
+              "gpt-4o-mini"
+            ]
+          },
+          "budget_limit": {
+            "type": "number",
+            "minimum": 0
+          },
+          "draft_ttl_minutes": {
+            "type": "integer",
+            "minimum": 0
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string",
+            "enum": [
+              "light",
+              "dark"
+            ]
+          },
+          "dark_mode": {
+            "type": "boolean"
+          }
+        }
+      },
+      "ApiKeyRequest": {
+        "type": "object",
+        "properties": {
+          "api_key": {
+            "type": "string"
+          }
+        }
+      },
+      "ApiKeyResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "stored": {
+                "type": "boolean"
+              },
+              "last4": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "Usage": {
+        "type": "object",
+        "properties": {
+          "total_commands_month": {
+            "type": "integer"
+          },
+          "estimated_cost": {
+            "type": "number"
+          },
+          "last_sync": {
+            "type": "string"
+          }
+        }
+      },
+      "UsageResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "IntentRequest": {
+        "type": "object",
+        "required": [
+          "prompt"
+        ],
+        "properties": {
+          "prompt": {
+            "type": "string"
+          },
+          "context": {
+            "type": "object"
+          },
+          "metadata": {
+            "type": "object"
+          }
+        }
+      },
+      "IntentResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "intent_id": {
+                "type": "string"
+              },
+              "status": {
+                "type": "string"
+              },
+              "message": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "HealthResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "status": {
+                "type": "string"
+              },
+              "time": {
+                "type": "string"
+              },
+              "version": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      }
+    }
+  }
+}
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Plugin.php b/src/Plugin.php
index 98ff7ef58454d6f962b466d44ec14f8341d83ba0..bd440acbba688b48814b89a88c4bca62856fc56b
--- a/src/Plugin.php
+++ b/src/Plugin.php
@@ -73,6 +73,7 @@
 		add_action( 'admin_menu', array( $this, 'register_menu' ) );
 		add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_admin_assets' ) );
 		add_action( 'rest_api_init', array( $this, 'register_rest_routes' ) );
+		add_filter( 'rest_post_dispatch', array( $this, 'format_rest_response' ), 10, 3 );
 	}
 
 	/**
@@ -183,6 +184,122 @@
 			$controller = new Rest\SettingsController();
 			$controller->register_routes();
 		}
+
+		if ( class_exists( 'AgentWP\\Rest\\IntentController' ) ) {
+			$controller = new Rest\IntentController();
+			$controller->register_routes();
+		}
+
+		if ( class_exists( 'AgentWP\\Rest\\HealthController' ) ) {
+			$controller = new Rest\HealthController();
+			$controller->register_routes();
+		}
+	}
+
+	/**
+	 * Normalize REST responses and log requests.
+	 *
+	 * @param mixed           $result Response value.
+	 * @param \WP_REST_Server $server REST server instance.
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return mixed
+	 */
+	public function format_rest_response( $result, $server, $request ) {
+		if ( ! $this->is_agentwp_route( $request ) ) {
+			return $result;
+		}
+
+		$status     = 200;
+		$error_code = '';
+
+		if ( is_wp_error( $result ) ) {
+			$error_code = $result->get_error_code();
+			$message    = $result->get_error_message();
+			$data       = $result->get_error_data();
+			$status     = ( is_array( $data ) && isset( $data['status'] ) ) ? intval( $data['status'] ) : 500;
+
+			$response = rest_ensure_response(
+				array(
+					'success' => false,
+					'data'    => array(),
+					'error'   => array(
+						'code'    => $error_code,
+						'message' => $message,
+					),
+				)
+			);
+
+			if ( $response instanceof \WP_REST_Response ) {
+				$response->set_status( $status );
+				if ( is_array( $data ) && isset( $data['retry_after'] ) ) {
+					$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+				}
+			}
+
+			$result = $response;
+		} elseif ( $result instanceof \WP_REST_Response ) {
+			$status = $result->get_status();
+			$body   = $result->get_data();
+
+			if ( is_array( $body ) && isset( $body['code'], $body['message'] ) ) {
+				$error_code = (string) $body['code'];
+				$message    = (string) $body['message'];
+				$data       = isset( $body['data'] ) && is_array( $body['data'] ) ? $body['data'] : array();
+				$status     = isset( $data['status'] ) ? intval( $data['status'] ) : $status;
+
+				$response = rest_ensure_response(
+					array(
+						'success' => false,
+						'data'    => array(),
+						'error'   => array(
+							'code'    => $error_code,
+							'message' => $message,
+						),
+					)
+				);
+
+				if ( $response instanceof \WP_REST_Response ) {
+					$response->set_status( $status );
+					if ( isset( $data['retry_after'] ) ) {
+						$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+					}
+				}
+
+				$result = $response;
+			} elseif ( is_array( $body ) && isset( $body['error']['code'] ) ) {
+				$error_code = (string) $body['error']['code'];
+			}
+		} else {
+			$result = rest_ensure_response(
+				array(
+					'success' => true,
+					'data'    => $result,
+				)
+			);
+
+			if ( $result instanceof \WP_REST_Response ) {
+				$status = $result->get_status();
+			}
+		}
+
+		if ( class_exists( 'AgentWP\\API\\RestController' ) ) {
+			API\RestController::log_request( $request, $status, $error_code );
+		}
+
+		return $result;
+	}
+
+	/**
+	 * Check whether request targets AgentWP REST routes.
+	 *
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return bool
+	 */
+	private function is_agentwp_route( $request ) {
+		$route = $request->get_route();
+		$route = is_string( $route ) ? $route : '';
+
+		return ( 0 === strpos( $route, '/' . API\RestController::REST_NAMESPACE ) );
 	}
 
 	/**
diff --git a/src/Rest/HealthController.php b/src/Rest/HealthController.php
new file mode 100644
index 0000000000000000000000000000000000000000..4895348e00e2a1fd0e544e52c52a986c07050caa
--- /dev/null
+++ b/src/Rest/HealthController.php
@@ -0,0 +1,47 @@
+<?php
+/**
+ * Health REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class HealthController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/health',
+			array(
+				'methods'             => WP_REST_Server::READABLE,
+				'callback'            => array( $this, 'get_health' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Return health status.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function get_health( $request ) {
+		return $this->response_success(
+			array(
+				'status'  => 'ok',
+				'time'    => gmdate( 'c' ),
+				'version' => defined( 'AGENTWP_VERSION' ) ? AGENTWP_VERSION : '',
+			)
+		);
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..71b38c9ea8acfdf42086f3000283cebc8f109db0
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,76 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'     => 'object',
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..5568099e4d147ab04844a6d3a7253f0a90c7a97a
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,18 +7,13 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
-use WP_REST_Request;
-use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +22,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +34,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +89,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +116,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +171,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +331,72 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
+	}
 
-		return $response;
+	/**
+	 * Schema for API key payload.
+	 *
+	 * @return array
+	 */
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
+				),
+			),
+		);
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for usage query params.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_usage_schema() {
+		return array(
+			'type'       => 'object',
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
 	}
 }

file update:
diff --git a/docs/openapi.json b/docs/openapi.json
new file mode 100644
index 0000000000000000000000000000000000000000..849f15d93104fabd8a394dc4195b96a609c010a0
--- /dev/null
+++ b/docs/openapi.json
@@ -0,0 +1,503 @@
+{
+  "openapi": "3.0.3",
+  "info": {
+    "title": "AgentWP REST API",
+    "version": "0.1.0",
+    "description": "OpenAPI specification for AgentWP REST endpoints."
+  },
+  "servers": [
+    {
+      "url": "/wp-json"
+    }
+  ],
+  "paths": {
+    "/agentwp/v1/intent": {
+      "post": {
+        "summary": "Submit an intent",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": true,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/IntentRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Intent accepted",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/IntentResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          },
+          "429": {
+            "description": "Rate limit exceeded",
+            "headers": {
+              "Retry-After": {
+                "schema": {
+                  "type": "integer"
+                }
+              }
+            },
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings": {
+      "get": {
+        "summary": "Get settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Settings payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          }
+        }
+      },
+      "post": {
+        "summary": "Update settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/SettingsUpdateRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Updated settings",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings/api-key": {
+      "post": {
+        "summary": "Store OpenAI API key",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/ApiKeyRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "API key stored",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ApiKeyResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid API key",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/usage": {
+      "get": {
+        "summary": "Get usage stats",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "parameters": [
+          {
+            "name": "period",
+            "in": "query",
+            "schema": {
+              "type": "string",
+              "enum": [
+                "day",
+                "week",
+                "month"
+              ]
+            }
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Usage stats",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/UsageResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid period",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/health": {
+      "get": {
+        "summary": "Health check",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Health status",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/HealthResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    }
+  },
+  "components": {
+    "securitySchemes": {
+      "nonceAuth": {
+        "type": "apiKey",
+        "in": "header",
+        "name": "X-WP-Nonce"
+      }
+    },
+    "schemas": {
+      "StandardResponse": {
+        "type": "object",
+        "required": [
+          "success",
+          "data"
+        ],
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {},
+          "error": {
+            "$ref": "#/components/schemas/ErrorObject"
+          }
+        }
+      },
+      "ErrorObject": {
+        "type": "object",
+        "required": [
+          "code",
+          "message"
+        ],
+        "properties": {
+          "code": {
+            "type": "string"
+          },
+          "message": {
+            "type": "string"
+          }
+        }
+      },
+      "ErrorResponse": {
+        "allOf": [
+          {
+            "$ref": "#/components/schemas/StandardResponse"
+          }
+        ]
+      },
+      "Settings": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string"
+          },
+          "budget_limit": {
+            "type": "number"
+          },
+          "draft_ttl_minutes": {
+            "type": "integer"
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string"
+          }
+        }
+      },
+      "SettingsResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "settings": {
+                "$ref": "#/components/schemas/Settings"
+              },
+              "api_key_last4": {
+                "type": "string"
+              },
+              "has_api_key": {
+                "type": "boolean"
+              },
+              "api_key_status": {
+                "type": "string"
+              },
+              "updated": {
+                "type": "boolean"
+              },
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "SettingsUpdateRequest": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string",
+            "enum": [
+              "gpt-4o",
+              "gpt-4o-mini"
+            ]
+          },
+          "budget_limit": {
+            "type": "number",
+            "minimum": 0
+          },
+          "draft_ttl_minutes": {
+            "type": "integer",
+            "minimum": 0
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string",
+            "enum": [
+              "light",
+              "dark"
+            ]
+          },
+          "dark_mode": {
+            "type": "boolean"
+          }
+        }
+      },
+      "ApiKeyRequest": {
+        "type": "object",
+        "properties": {
+          "api_key": {
+            "type": "string"
+          }
+        }
+      },
+      "ApiKeyResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "stored": {
+                "type": "boolean"
+              },
+              "last4": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "Usage": {
+        "type": "object",
+        "properties": {
+          "total_commands_month": {
+            "type": "integer"
+          },
+          "estimated_cost": {
+            "type": "number"
+          },
+          "last_sync": {
+            "type": "string"
+          }
+        }
+      },
+      "UsageResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "IntentRequest": {
+        "type": "object",
+        "required": [
+          "prompt"
+        ],
+        "properties": {
+          "prompt": {
+            "type": "string"
+          },
+          "context": {
+            "type": "object"
+          },
+          "metadata": {
+            "type": "object"
+          }
+        }
+      },
+      "IntentResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "intent_id": {
+                "type": "string"
+              },
+              "status": {
+                "type": "string"
+              },
+              "message": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "HealthResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "status": {
+                "type": "string"
+              },
+              "time": {
+                "type": "string"
+              },
+              "version": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      }
+    }
+  }
+}
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Plugin.php b/src/Plugin.php
index 98ff7ef58454d6f962b466d44ec14f8341d83ba0..bd440acbba688b48814b89a88c4bca62856fc56b
--- a/src/Plugin.php
+++ b/src/Plugin.php
@@ -73,6 +73,7 @@
 		add_action( 'admin_menu', array( $this, 'register_menu' ) );
 		add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_admin_assets' ) );
 		add_action( 'rest_api_init', array( $this, 'register_rest_routes' ) );
+		add_filter( 'rest_post_dispatch', array( $this, 'format_rest_response' ), 10, 3 );
 	}
 
 	/**
@@ -183,6 +184,122 @@
 			$controller = new Rest\SettingsController();
 			$controller->register_routes();
 		}
+
+		if ( class_exists( 'AgentWP\\Rest\\IntentController' ) ) {
+			$controller = new Rest\IntentController();
+			$controller->register_routes();
+		}
+
+		if ( class_exists( 'AgentWP\\Rest\\HealthController' ) ) {
+			$controller = new Rest\HealthController();
+			$controller->register_routes();
+		}
+	}
+
+	/**
+	 * Normalize REST responses and log requests.
+	 *
+	 * @param mixed           $result Response value.
+	 * @param \WP_REST_Server $server REST server instance.
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return mixed
+	 */
+	public function format_rest_response( $result, $server, $request ) {
+		if ( ! $this->is_agentwp_route( $request ) ) {
+			return $result;
+		}
+
+		$status     = 200;
+		$error_code = '';
+
+		if ( is_wp_error( $result ) ) {
+			$error_code = $result->get_error_code();
+			$message    = $result->get_error_message();
+			$data       = $result->get_error_data();
+			$status     = ( is_array( $data ) && isset( $data['status'] ) ) ? intval( $data['status'] ) : 500;
+
+			$response = rest_ensure_response(
+				array(
+					'success' => false,
+					'data'    => array(),
+					'error'   => array(
+						'code'    => $error_code,
+						'message' => $message,
+					),
+				)
+			);
+
+			if ( $response instanceof \WP_REST_Response ) {
+				$response->set_status( $status );
+				if ( is_array( $data ) && isset( $data['retry_after'] ) ) {
+					$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+				}
+			}
+
+			$result = $response;
+		} elseif ( $result instanceof \WP_REST_Response ) {
+			$status = $result->get_status();
+			$body   = $result->get_data();
+
+			if ( is_array( $body ) && isset( $body['code'], $body['message'] ) ) {
+				$error_code = (string) $body['code'];
+				$message    = (string) $body['message'];
+				$data       = isset( $body['data'] ) && is_array( $body['data'] ) ? $body['data'] : array();
+				$status     = isset( $data['status'] ) ? intval( $data['status'] ) : $status;
+
+				$response = rest_ensure_response(
+					array(
+						'success' => false,
+						'data'    => array(),
+						'error'   => array(
+							'code'    => $error_code,
+							'message' => $message,
+						),
+					)
+				);
+
+				if ( $response instanceof \WP_REST_Response ) {
+					$response->set_status( $status );
+					if ( isset( $data['retry_after'] ) ) {
+						$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+					}
+				}
+
+				$result = $response;
+			} elseif ( is_array( $body ) && isset( $body['error']['code'] ) ) {
+				$error_code = (string) $body['error']['code'];
+			}
+		} else {
+			$result = rest_ensure_response(
+				array(
+					'success' => true,
+					'data'    => $result,
+				)
+			);
+
+			if ( $result instanceof \WP_REST_Response ) {
+				$status = $result->get_status();
+			}
+		}
+
+		if ( class_exists( 'AgentWP\\API\\RestController' ) ) {
+			API\RestController::log_request( $request, $status, $error_code );
+		}
+
+		return $result;
+	}
+
+	/**
+	 * Check whether request targets AgentWP REST routes.
+	 *
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return bool
+	 */
+	private function is_agentwp_route( $request ) {
+		$route = $request->get_route();
+		$route = is_string( $route ) ? $route : '';
+
+		return ( 0 === strpos( $route, '/' . API\RestController::REST_NAMESPACE ) );
 	}
 
 	/**
diff --git a/src/Rest/HealthController.php b/src/Rest/HealthController.php
new file mode 100644
index 0000000000000000000000000000000000000000..4895348e00e2a1fd0e544e52c52a986c07050caa
--- /dev/null
+++ b/src/Rest/HealthController.php
@@ -0,0 +1,47 @@
+<?php
+/**
+ * Health REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class HealthController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/health',
+			array(
+				'methods'             => WP_REST_Server::READABLE,
+				'callback'            => array( $this, 'get_health' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Return health status.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function get_health( $request ) {
+		return $this->response_success(
+			array(
+				'status'  => 'ok',
+				'time'    => gmdate( 'c' ),
+				'version' => defined( 'AGENTWP_VERSION' ) ? AGENTWP_VERSION : '',
+			)
+		);
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..71b38c9ea8acfdf42086f3000283cebc8f109db0
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,76 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'     => 'object',
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..5568099e4d147ab04844a6d3a7253f0a90c7a97a
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,18 +7,13 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
-use WP_REST_Request;
-use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +22,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +34,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +89,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +116,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +171,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +331,72 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
+	}
 
-		return $response;
+	/**
+	 * Schema for API key payload.
+	 *
+	 * @return array
+	 */
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
+				),
+			),
+		);
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for usage query params.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_usage_schema() {
+		return array(
+			'type'       => 'object',
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
 	}
 }


thinking
**Cleaning up unused imports**
file update
M /Users/ahmedyounis/Documents/Projects/agentwp/src/Rest/IntentController.php
@@ -10,3 +10,2 @@
 use AgentWP\API\RestController;
-use WP_REST_Request;
 use WP_REST_Server;
apply_patch(auto_approved=true) exited 0 in 57ms:
Success. Updated the following files:
M src/Rest/IntentController.php
file update:
diff --git a/docs/openapi.json b/docs/openapi.json
new file mode 100644
index 0000000000000000000000000000000000000000..849f15d93104fabd8a394dc4195b96a609c010a0
--- /dev/null
+++ b/docs/openapi.json
@@ -0,0 +1,503 @@
+{
+  "openapi": "3.0.3",
+  "info": {
+    "title": "AgentWP REST API",
+    "version": "0.1.0",
+    "description": "OpenAPI specification for AgentWP REST endpoints."
+  },
+  "servers": [
+    {
+      "url": "/wp-json"
+    }
+  ],
+  "paths": {
+    "/agentwp/v1/intent": {
+      "post": {
+        "summary": "Submit an intent",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": true,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/IntentRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Intent accepted",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/IntentResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          },
+          "429": {
+            "description": "Rate limit exceeded",
+            "headers": {
+              "Retry-After": {
+                "schema": {
+                  "type": "integer"
+                }
+              }
+            },
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings": {
+      "get": {
+        "summary": "Get settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Settings payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          }
+        }
+      },
+      "post": {
+        "summary": "Update settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/SettingsUpdateRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Updated settings",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings/api-key": {
+      "post": {
+        "summary": "Store OpenAI API key",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/ApiKeyRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "API key stored",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ApiKeyResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid API key",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/usage": {
+      "get": {
+        "summary": "Get usage stats",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "parameters": [
+          {
+            "name": "period",
+            "in": "query",
+            "schema": {
+              "type": "string",
+              "enum": [
+                "day",
+                "week",
+                "month"
+              ]
+            }
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Usage stats",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/UsageResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid period",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/health": {
+      "get": {
+        "summary": "Health check",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Health status",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/HealthResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    }
+  },
+  "components": {
+    "securitySchemes": {
+      "nonceAuth": {
+        "type": "apiKey",
+        "in": "header",
+        "name": "X-WP-Nonce"
+      }
+    },
+    "schemas": {
+      "StandardResponse": {
+        "type": "object",
+        "required": [
+          "success",
+          "data"
+        ],
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {},
+          "error": {
+            "$ref": "#/components/schemas/ErrorObject"
+          }
+        }
+      },
+      "ErrorObject": {
+        "type": "object",
+        "required": [
+          "code",
+          "message"
+        ],
+        "properties": {
+          "code": {
+            "type": "string"
+          },
+          "message": {
+            "type": "string"
+          }
+        }
+      },
+      "ErrorResponse": {
+        "allOf": [
+          {
+            "$ref": "#/components/schemas/StandardResponse"
+          }
+        ]
+      },
+      "Settings": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string"
+          },
+          "budget_limit": {
+            "type": "number"
+          },
+          "draft_ttl_minutes": {
+            "type": "integer"
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string"
+          }
+        }
+      },
+      "SettingsResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "settings": {
+                "$ref": "#/components/schemas/Settings"
+              },
+              "api_key_last4": {
+                "type": "string"
+              },
+              "has_api_key": {
+                "type": "boolean"
+              },
+              "api_key_status": {
+                "type": "string"
+              },
+              "updated": {
+                "type": "boolean"
+              },
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "SettingsUpdateRequest": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string",
+            "enum": [
+              "gpt-4o",
+              "gpt-4o-mini"
+            ]
+          },
+          "budget_limit": {
+            "type": "number",
+            "minimum": 0
+          },
+          "draft_ttl_minutes": {
+            "type": "integer",
+            "minimum": 0
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string",
+            "enum": [
+              "light",
+              "dark"
+            ]
+          },
+          "dark_mode": {
+            "type": "boolean"
+          }
+        }
+      },
+      "ApiKeyRequest": {
+        "type": "object",
+        "properties": {
+          "api_key": {
+            "type": "string"
+          }
+        }
+      },
+      "ApiKeyResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "stored": {
+                "type": "boolean"
+              },
+              "last4": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "Usage": {
+        "type": "object",
+        "properties": {
+          "total_commands_month": {
+            "type": "integer"
+          },
+          "estimated_cost": {
+            "type": "number"
+          },
+          "last_sync": {
+            "type": "string"
+          }
+        }
+      },
+      "UsageResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "IntentRequest": {
+        "type": "object",
+        "required": [
+          "prompt"
+        ],
+        "properties": {
+          "prompt": {
+            "type": "string"
+          },
+          "context": {
+            "type": "object"
+          },
+          "metadata": {
+            "type": "object"
+          }
+        }
+      },
+      "IntentResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "intent_id": {
+                "type": "string"
+              },
+              "status": {
+                "type": "string"
+              },
+              "message": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "HealthResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "status": {
+                "type": "string"
+              },
+              "time": {
+                "type": "string"
+              },
+              "version": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      }
+    }
+  }
+}
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Plugin.php b/src/Plugin.php
index 98ff7ef58454d6f962b466d44ec14f8341d83ba0..bd440acbba688b48814b89a88c4bca62856fc56b
--- a/src/Plugin.php
+++ b/src/Plugin.php
@@ -73,6 +73,7 @@
 		add_action( 'admin_menu', array( $this, 'register_menu' ) );
 		add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_admin_assets' ) );
 		add_action( 'rest_api_init', array( $this, 'register_rest_routes' ) );
+		add_filter( 'rest_post_dispatch', array( $this, 'format_rest_response' ), 10, 3 );
 	}
 
 	/**
@@ -183,6 +184,122 @@
 			$controller = new Rest\SettingsController();
 			$controller->register_routes();
 		}
+
+		if ( class_exists( 'AgentWP\\Rest\\IntentController' ) ) {
+			$controller = new Rest\IntentController();
+			$controller->register_routes();
+		}
+
+		if ( class_exists( 'AgentWP\\Rest\\HealthController' ) ) {
+			$controller = new Rest\HealthController();
+			$controller->register_routes();
+		}
+	}
+
+	/**
+	 * Normalize REST responses and log requests.
+	 *
+	 * @param mixed           $result Response value.
+	 * @param \WP_REST_Server $server REST server instance.
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return mixed
+	 */
+	public function format_rest_response( $result, $server, $request ) {
+		if ( ! $this->is_agentwp_route( $request ) ) {
+			return $result;
+		}
+
+		$status     = 200;
+		$error_code = '';
+
+		if ( is_wp_error( $result ) ) {
+			$error_code = $result->get_error_code();
+			$message    = $result->get_error_message();
+			$data       = $result->get_error_data();
+			$status     = ( is_array( $data ) && isset( $data['status'] ) ) ? intval( $data['status'] ) : 500;
+
+			$response = rest_ensure_response(
+				array(
+					'success' => false,
+					'data'    => array(),
+					'error'   => array(
+						'code'    => $error_code,
+						'message' => $message,
+					),
+				)
+			);
+
+			if ( $response instanceof \WP_REST_Response ) {
+				$response->set_status( $status );
+				if ( is_array( $data ) && isset( $data['retry_after'] ) ) {
+					$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+				}
+			}
+
+			$result = $response;
+		} elseif ( $result instanceof \WP_REST_Response ) {
+			$status = $result->get_status();
+			$body   = $result->get_data();
+
+			if ( is_array( $body ) && isset( $body['code'], $body['message'] ) ) {
+				$error_code = (string) $body['code'];
+				$message    = (string) $body['message'];
+				$data       = isset( $body['data'] ) && is_array( $body['data'] ) ? $body['data'] : array();
+				$status     = isset( $data['status'] ) ? intval( $data['status'] ) : $status;
+
+				$response = rest_ensure_response(
+					array(
+						'success' => false,
+						'data'    => array(),
+						'error'   => array(
+							'code'    => $error_code,
+							'message' => $message,
+						),
+					)
+				);
+
+				if ( $response instanceof \WP_REST_Response ) {
+					$response->set_status( $status );
+					if ( isset( $data['retry_after'] ) ) {
+						$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+					}
+				}
+
+				$result = $response;
+			} elseif ( is_array( $body ) && isset( $body['error']['code'] ) ) {
+				$error_code = (string) $body['error']['code'];
+			}
+		} else {
+			$result = rest_ensure_response(
+				array(
+					'success' => true,
+					'data'    => $result,
+				)
+			);
+
+			if ( $result instanceof \WP_REST_Response ) {
+				$status = $result->get_status();
+			}
+		}
+
+		if ( class_exists( 'AgentWP\\API\\RestController' ) ) {
+			API\RestController::log_request( $request, $status, $error_code );
+		}
+
+		return $result;
+	}
+
+	/**
+	 * Check whether request targets AgentWP REST routes.
+	 *
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return bool
+	 */
+	private function is_agentwp_route( $request ) {
+		$route = $request->get_route();
+		$route = is_string( $route ) ? $route : '';
+
+		return ( 0 === strpos( $route, '/' . API\RestController::REST_NAMESPACE ) );
 	}
 
 	/**
diff --git a/src/Rest/HealthController.php b/src/Rest/HealthController.php
new file mode 100644
index 0000000000000000000000000000000000000000..4895348e00e2a1fd0e544e52c52a986c07050caa
--- /dev/null
+++ b/src/Rest/HealthController.php
@@ -0,0 +1,47 @@
+<?php
+/**
+ * Health REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class HealthController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/health',
+			array(
+				'methods'             => WP_REST_Server::READABLE,
+				'callback'            => array( $this, 'get_health' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Return health status.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function get_health( $request ) {
+		return $this->response_success(
+			array(
+				'status'  => 'ok',
+				'time'    => gmdate( 'c' ),
+				'version' => defined( 'AGENTWP_VERSION' ) ? AGENTWP_VERSION : '',
+			)
+		);
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..027bca1a35799ff06be0baeebaff07a26376a73f
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,75 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'     => 'object',
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..5568099e4d147ab04844a6d3a7253f0a90c7a97a
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,18 +7,13 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
-use WP_REST_Request;
-use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +22,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +34,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +89,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +116,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +171,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +331,72 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
+	}
 
-		return $response;
+	/**
+	 * Schema for API key payload.
+	 *
+	 * @return array
+	 */
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
+				),
+			),
+		);
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for usage query params.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_usage_schema() {
+		return array(
+			'type'       => 'object',
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
 	}
 }

file update:
diff --git a/docs/openapi.json b/docs/openapi.json
new file mode 100644
index 0000000000000000000000000000000000000000..849f15d93104fabd8a394dc4195b96a609c010a0
--- /dev/null
+++ b/docs/openapi.json
@@ -0,0 +1,503 @@
+{
+  "openapi": "3.0.3",
+  "info": {
+    "title": "AgentWP REST API",
+    "version": "0.1.0",
+    "description": "OpenAPI specification for AgentWP REST endpoints."
+  },
+  "servers": [
+    {
+      "url": "/wp-json"
+    }
+  ],
+  "paths": {
+    "/agentwp/v1/intent": {
+      "post": {
+        "summary": "Submit an intent",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": true,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/IntentRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Intent accepted",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/IntentResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          },
+          "429": {
+            "description": "Rate limit exceeded",
+            "headers": {
+              "Retry-After": {
+                "schema": {
+                  "type": "integer"
+                }
+              }
+            },
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings": {
+      "get": {
+        "summary": "Get settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Settings payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          }
+        }
+      },
+      "post": {
+        "summary": "Update settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/SettingsUpdateRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Updated settings",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings/api-key": {
+      "post": {
+        "summary": "Store OpenAI API key",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/ApiKeyRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "API key stored",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ApiKeyResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid API key",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/usage": {
+      "get": {
+        "summary": "Get usage stats",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "parameters": [
+          {
+            "name": "period",
+            "in": "query",
+            "schema": {
+              "type": "string",
+              "enum": [
+                "day",
+                "week",
+                "month"
+              ]
+            }
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Usage stats",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/UsageResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid period",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/health": {
+      "get": {
+        "summary": "Health check",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Health status",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/HealthResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    }
+  },
+  "components": {
+    "securitySchemes": {
+      "nonceAuth": {
+        "type": "apiKey",
+        "in": "header",
+        "name": "X-WP-Nonce"
+      }
+    },
+    "schemas": {
+      "StandardResponse": {
+        "type": "object",
+        "required": [
+          "success",
+          "data"
+        ],
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {},
+          "error": {
+            "$ref": "#/components/schemas/ErrorObject"
+          }
+        }
+      },
+      "ErrorObject": {
+        "type": "object",
+        "required": [
+          "code",
+          "message"
+        ],
+        "properties": {
+          "code": {
+            "type": "string"
+          },
+          "message": {
+            "type": "string"
+          }
+        }
+      },
+      "ErrorResponse": {
+        "allOf": [
+          {
+            "$ref": "#/components/schemas/StandardResponse"
+          }
+        ]
+      },
+      "Settings": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string"
+          },
+          "budget_limit": {
+            "type": "number"
+          },
+          "draft_ttl_minutes": {
+            "type": "integer"
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string"
+          }
+        }
+      },
+      "SettingsResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "settings": {
+                "$ref": "#/components/schemas/Settings"
+              },
+              "api_key_last4": {
+                "type": "string"
+              },
+              "has_api_key": {
+                "type": "boolean"
+              },
+              "api_key_status": {
+                "type": "string"
+              },
+              "updated": {
+                "type": "boolean"
+              },
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "SettingsUpdateRequest": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string",
+            "enum": [
+              "gpt-4o",
+              "gpt-4o-mini"
+            ]
+          },
+          "budget_limit": {
+            "type": "number",
+            "minimum": 0
+          },
+          "draft_ttl_minutes": {
+            "type": "integer",
+            "minimum": 0
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string",
+            "enum": [
+              "light",
+              "dark"
+            ]
+          },
+          "dark_mode": {
+            "type": "boolean"
+          }
+        }
+      },
+      "ApiKeyRequest": {
+        "type": "object",
+        "properties": {
+          "api_key": {
+            "type": "string"
+          }
+        }
+      },
+      "ApiKeyResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "stored": {
+                "type": "boolean"
+              },
+              "last4": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "Usage": {
+        "type": "object",
+        "properties": {
+          "total_commands_month": {
+            "type": "integer"
+          },
+          "estimated_cost": {
+            "type": "number"
+          },
+          "last_sync": {
+            "type": "string"
+          }
+        }
+      },
+      "UsageResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "IntentRequest": {
+        "type": "object",
+        "required": [
+          "prompt"
+        ],
+        "properties": {
+          "prompt": {
+            "type": "string"
+          },
+          "context": {
+            "type": "object"
+          },
+          "metadata": {
+            "type": "object"
+          }
+        }
+      },
+      "IntentResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "intent_id": {
+                "type": "string"
+              },
+              "status": {
+                "type": "string"
+              },
+              "message": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "HealthResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "status": {
+                "type": "string"
+              },
+              "time": {
+                "type": "string"
+              },
+              "version": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      }
+    }
+  }
+}
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Plugin.php b/src/Plugin.php
index 98ff7ef58454d6f962b466d44ec14f8341d83ba0..bd440acbba688b48814b89a88c4bca62856fc56b
--- a/src/Plugin.php
+++ b/src/Plugin.php
@@ -73,6 +73,7 @@
 		add_action( 'admin_menu', array( $this, 'register_menu' ) );
 		add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_admin_assets' ) );
 		add_action( 'rest_api_init', array( $this, 'register_rest_routes' ) );
+		add_filter( 'rest_post_dispatch', array( $this, 'format_rest_response' ), 10, 3 );
 	}
 
 	/**
@@ -183,6 +184,122 @@
 			$controller = new Rest\SettingsController();
 			$controller->register_routes();
 		}
+
+		if ( class_exists( 'AgentWP\\Rest\\IntentController' ) ) {
+			$controller = new Rest\IntentController();
+			$controller->register_routes();
+		}
+
+		if ( class_exists( 'AgentWP\\Rest\\HealthController' ) ) {
+			$controller = new Rest\HealthController();
+			$controller->register_routes();
+		}
+	}
+
+	/**
+	 * Normalize REST responses and log requests.
+	 *
+	 * @param mixed           $result Response value.
+	 * @param \WP_REST_Server $server REST server instance.
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return mixed
+	 */
+	public function format_rest_response( $result, $server, $request ) {
+		if ( ! $this->is_agentwp_route( $request ) ) {
+			return $result;
+		}
+
+		$status     = 200;
+		$error_code = '';
+
+		if ( is_wp_error( $result ) ) {
+			$error_code = $result->get_error_code();
+			$message    = $result->get_error_message();
+			$data       = $result->get_error_data();
+			$status     = ( is_array( $data ) && isset( $data['status'] ) ) ? intval( $data['status'] ) : 500;
+
+			$response = rest_ensure_response(
+				array(
+					'success' => false,
+					'data'    => array(),
+					'error'   => array(
+						'code'    => $error_code,
+						'message' => $message,
+					),
+				)
+			);
+
+			if ( $response instanceof \WP_REST_Response ) {
+				$response->set_status( $status );
+				if ( is_array( $data ) && isset( $data['retry_after'] ) ) {
+					$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+				}
+			}
+
+			$result = $response;
+		} elseif ( $result instanceof \WP_REST_Response ) {
+			$status = $result->get_status();
+			$body   = $result->get_data();
+
+			if ( is_array( $body ) && isset( $body['code'], $body['message'] ) ) {
+				$error_code = (string) $body['code'];
+				$message    = (string) $body['message'];
+				$data       = isset( $body['data'] ) && is_array( $body['data'] ) ? $body['data'] : array();
+				$status     = isset( $data['status'] ) ? intval( $data['status'] ) : $status;
+
+				$response = rest_ensure_response(
+					array(
+						'success' => false,
+						'data'    => array(),
+						'error'   => array(
+							'code'    => $error_code,
+							'message' => $message,
+						),
+					)
+				);
+
+				if ( $response instanceof \WP_REST_Response ) {
+					$response->set_status( $status );
+					if ( isset( $data['retry_after'] ) ) {
+						$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+					}
+				}
+
+				$result = $response;
+			} elseif ( is_array( $body ) && isset( $body['error']['code'] ) ) {
+				$error_code = (string) $body['error']['code'];
+			}
+		} else {
+			$result = rest_ensure_response(
+				array(
+					'success' => true,
+					'data'    => $result,
+				)
+			);
+
+			if ( $result instanceof \WP_REST_Response ) {
+				$status = $result->get_status();
+			}
+		}
+
+		if ( class_exists( 'AgentWP\\API\\RestController' ) ) {
+			API\RestController::log_request( $request, $status, $error_code );
+		}
+
+		return $result;
+	}
+
+	/**
+	 * Check whether request targets AgentWP REST routes.
+	 *
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return bool
+	 */
+	private function is_agentwp_route( $request ) {
+		$route = $request->get_route();
+		$route = is_string( $route ) ? $route : '';
+
+		return ( 0 === strpos( $route, '/' . API\RestController::REST_NAMESPACE ) );
 	}
 
 	/**
diff --git a/src/Rest/HealthController.php b/src/Rest/HealthController.php
new file mode 100644
index 0000000000000000000000000000000000000000..4895348e00e2a1fd0e544e52c52a986c07050caa
--- /dev/null
+++ b/src/Rest/HealthController.php
@@ -0,0 +1,47 @@
+<?php
+/**
+ * Health REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Request;
+use WP_REST_Server;
+
+class HealthController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/health',
+			array(
+				'methods'             => WP_REST_Server::READABLE,
+				'callback'            => array( $this, 'get_health' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Return health status.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function get_health( $request ) {
+		return $this->response_success(
+			array(
+				'status'  => 'ok',
+				'time'    => gmdate( 'c' ),
+				'version' => defined( 'AGENTWP_VERSION' ) ? AGENTWP_VERSION : '',
+			)
+		);
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..027bca1a35799ff06be0baeebaff07a26376a73f
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,75 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'     => 'object',
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..5568099e4d147ab04844a6d3a7253f0a90c7a97a
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,18 +7,13 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
-use WP_REST_Request;
-use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +22,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +34,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +89,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +116,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +171,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +331,72 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
+	}
 
-		return $response;
+	/**
+	 * Schema for API key payload.
+	 *
+	 * @return array
+	 */
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
+				),
+			),
+		);
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for usage query params.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_usage_schema() {
+		return array(
+			'type'       => 'object',
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
 	}
 }


thinking
**Examining HealthController**
file update
M /Users/ahmedyounis/Documents/Projects/agentwp/src/Rest/HealthController.php
@@ -10,3 +10,2 @@
 use AgentWP\API\RestController;
-use WP_REST_Request;
 use WP_REST_Server;
apply_patch(auto_approved=true) exited 0 in 47ms:
Success. Updated the following files:
M src/Rest/HealthController.php
file update:
diff --git a/docs/openapi.json b/docs/openapi.json
new file mode 100644
index 0000000000000000000000000000000000000000..849f15d93104fabd8a394dc4195b96a609c010a0
--- /dev/null
+++ b/docs/openapi.json
@@ -0,0 +1,503 @@
+{
+  "openapi": "3.0.3",
+  "info": {
+    "title": "AgentWP REST API",
+    "version": "0.1.0",
+    "description": "OpenAPI specification for AgentWP REST endpoints."
+  },
+  "servers": [
+    {
+      "url": "/wp-json"
+    }
+  ],
+  "paths": {
+    "/agentwp/v1/intent": {
+      "post": {
+        "summary": "Submit an intent",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": true,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/IntentRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Intent accepted",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/IntentResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          },
+          "429": {
+            "description": "Rate limit exceeded",
+            "headers": {
+              "Retry-After": {
+                "schema": {
+                  "type": "integer"
+                }
+              }
+            },
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings": {
+      "get": {
+        "summary": "Get settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Settings payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          }
+        }
+      },
+      "post": {
+        "summary": "Update settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/SettingsUpdateRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Updated settings",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings/api-key": {
+      "post": {
+        "summary": "Store OpenAI API key",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/ApiKeyRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "API key stored",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ApiKeyResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid API key",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/usage": {
+      "get": {
+        "summary": "Get usage stats",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "parameters": [
+          {
+            "name": "period",
+            "in": "query",
+            "schema": {
+              "type": "string",
+              "enum": [
+                "day",
+                "week",
+                "month"
+              ]
+            }
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Usage stats",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/UsageResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid period",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/health": {
+      "get": {
+        "summary": "Health check",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Health status",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/HealthResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    }
+  },
+  "components": {
+    "securitySchemes": {
+      "nonceAuth": {
+        "type": "apiKey",
+        "in": "header",
+        "name": "X-WP-Nonce"
+      }
+    },
+    "schemas": {
+      "StandardResponse": {
+        "type": "object",
+        "required": [
+          "success",
+          "data"
+        ],
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {},
+          "error": {
+            "$ref": "#/components/schemas/ErrorObject"
+          }
+        }
+      },
+      "ErrorObject": {
+        "type": "object",
+        "required": [
+          "code",
+          "message"
+        ],
+        "properties": {
+          "code": {
+            "type": "string"
+          },
+          "message": {
+            "type": "string"
+          }
+        }
+      },
+      "ErrorResponse": {
+        "allOf": [
+          {
+            "$ref": "#/components/schemas/StandardResponse"
+          }
+        ]
+      },
+      "Settings": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string"
+          },
+          "budget_limit": {
+            "type": "number"
+          },
+          "draft_ttl_minutes": {
+            "type": "integer"
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string"
+          }
+        }
+      },
+      "SettingsResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "settings": {
+                "$ref": "#/components/schemas/Settings"
+              },
+              "api_key_last4": {
+                "type": "string"
+              },
+              "has_api_key": {
+                "type": "boolean"
+              },
+              "api_key_status": {
+                "type": "string"
+              },
+              "updated": {
+                "type": "boolean"
+              },
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "SettingsUpdateRequest": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string",
+            "enum": [
+              "gpt-4o",
+              "gpt-4o-mini"
+            ]
+          },
+          "budget_limit": {
+            "type": "number",
+            "minimum": 0
+          },
+          "draft_ttl_minutes": {
+            "type": "integer",
+            "minimum": 0
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string",
+            "enum": [
+              "light",
+              "dark"
+            ]
+          },
+          "dark_mode": {
+            "type": "boolean"
+          }
+        }
+      },
+      "ApiKeyRequest": {
+        "type": "object",
+        "properties": {
+          "api_key": {
+            "type": "string"
+          }
+        }
+      },
+      "ApiKeyResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "stored": {
+                "type": "boolean"
+              },
+              "last4": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "Usage": {
+        "type": "object",
+        "properties": {
+          "total_commands_month": {
+            "type": "integer"
+          },
+          "estimated_cost": {
+            "type": "number"
+          },
+          "last_sync": {
+            "type": "string"
+          }
+        }
+      },
+      "UsageResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "IntentRequest": {
+        "type": "object",
+        "required": [
+          "prompt"
+        ],
+        "properties": {
+          "prompt": {
+            "type": "string"
+          },
+          "context": {
+            "type": "object"
+          },
+          "metadata": {
+            "type": "object"
+          }
+        }
+      },
+      "IntentResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "intent_id": {
+                "type": "string"
+              },
+              "status": {
+                "type": "string"
+              },
+              "message": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "HealthResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "status": {
+                "type": "string"
+              },
+              "time": {
+                "type": "string"
+              },
+              "version": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      }
+    }
+  }
+}
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Plugin.php b/src/Plugin.php
index 98ff7ef58454d6f962b466d44ec14f8341d83ba0..bd440acbba688b48814b89a88c4bca62856fc56b
--- a/src/Plugin.php
+++ b/src/Plugin.php
@@ -73,6 +73,7 @@
 		add_action( 'admin_menu', array( $this, 'register_menu' ) );
 		add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_admin_assets' ) );
 		add_action( 'rest_api_init', array( $this, 'register_rest_routes' ) );
+		add_filter( 'rest_post_dispatch', array( $this, 'format_rest_response' ), 10, 3 );
 	}
 
 	/**
@@ -183,6 +184,122 @@
 			$controller = new Rest\SettingsController();
 			$controller->register_routes();
 		}
+
+		if ( class_exists( 'AgentWP\\Rest\\IntentController' ) ) {
+			$controller = new Rest\IntentController();
+			$controller->register_routes();
+		}
+
+		if ( class_exists( 'AgentWP\\Rest\\HealthController' ) ) {
+			$controller = new Rest\HealthController();
+			$controller->register_routes();
+		}
+	}
+
+	/**
+	 * Normalize REST responses and log requests.
+	 *
+	 * @param mixed           $result Response value.
+	 * @param \WP_REST_Server $server REST server instance.
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return mixed
+	 */
+	public function format_rest_response( $result, $server, $request ) {
+		if ( ! $this->is_agentwp_route( $request ) ) {
+			return $result;
+		}
+
+		$status     = 200;
+		$error_code = '';
+
+		if ( is_wp_error( $result ) ) {
+			$error_code = $result->get_error_code();
+			$message    = $result->get_error_message();
+			$data       = $result->get_error_data();
+			$status     = ( is_array( $data ) && isset( $data['status'] ) ) ? intval( $data['status'] ) : 500;
+
+			$response = rest_ensure_response(
+				array(
+					'success' => false,
+					'data'    => array(),
+					'error'   => array(
+						'code'    => $error_code,
+						'message' => $message,
+					),
+				)
+			);
+
+			if ( $response instanceof \WP_REST_Response ) {
+				$response->set_status( $status );
+				if ( is_array( $data ) && isset( $data['retry_after'] ) ) {
+					$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+				}
+			}
+
+			$result = $response;
+		} elseif ( $result instanceof \WP_REST_Response ) {
+			$status = $result->get_status();
+			$body   = $result->get_data();
+
+			if ( is_array( $body ) && isset( $body['code'], $body['message'] ) ) {
+				$error_code = (string) $body['code'];
+				$message    = (string) $body['message'];
+				$data       = isset( $body['data'] ) && is_array( $body['data'] ) ? $body['data'] : array();
+				$status     = isset( $data['status'] ) ? intval( $data['status'] ) : $status;
+
+				$response = rest_ensure_response(
+					array(
+						'success' => false,
+						'data'    => array(),
+						'error'   => array(
+							'code'    => $error_code,
+							'message' => $message,
+						),
+					)
+				);
+
+				if ( $response instanceof \WP_REST_Response ) {
+					$response->set_status( $status );
+					if ( isset( $data['retry_after'] ) ) {
+						$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+					}
+				}
+
+				$result = $response;
+			} elseif ( is_array( $body ) && isset( $body['error']['code'] ) ) {
+				$error_code = (string) $body['error']['code'];
+			}
+		} else {
+			$result = rest_ensure_response(
+				array(
+					'success' => true,
+					'data'    => $result,
+				)
+			);
+
+			if ( $result instanceof \WP_REST_Response ) {
+				$status = $result->get_status();
+			}
+		}
+
+		if ( class_exists( 'AgentWP\\API\\RestController' ) ) {
+			API\RestController::log_request( $request, $status, $error_code );
+		}
+
+		return $result;
+	}
+
+	/**
+	 * Check whether request targets AgentWP REST routes.
+	 *
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return bool
+	 */
+	private function is_agentwp_route( $request ) {
+		$route = $request->get_route();
+		$route = is_string( $route ) ? $route : '';
+
+		return ( 0 === strpos( $route, '/' . API\RestController::REST_NAMESPACE ) );
 	}
 
 	/**
diff --git a/src/Rest/HealthController.php b/src/Rest/HealthController.php
new file mode 100644
index 0000000000000000000000000000000000000000..6b7dbdf666ad027953e52ec22de6c59a24c53f4b
--- /dev/null
+++ b/src/Rest/HealthController.php
@@ -0,0 +1,46 @@
+<?php
+/**
+ * Health REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Server;
+
+class HealthController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/health',
+			array(
+				'methods'             => WP_REST_Server::READABLE,
+				'callback'            => array( $this, 'get_health' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Return health status.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function get_health( $request ) {
+		return $this->response_success(
+			array(
+				'status'  => 'ok',
+				'time'    => gmdate( 'c' ),
+				'version' => defined( 'AGENTWP_VERSION' ) ? AGENTWP_VERSION : '',
+			)
+		);
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..027bca1a35799ff06be0baeebaff07a26376a73f
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,75 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'     => 'object',
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..5568099e4d147ab04844a6d3a7253f0a90c7a97a
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,18 +7,13 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
-use WP_REST_Request;
-use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +22,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +34,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +89,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +116,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +171,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +331,72 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
+	}
 
-		return $response;
+	/**
+	 * Schema for API key payload.
+	 *
+	 * @return array
+	 */
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
+				),
+			),
+		);
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for usage query params.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_usage_schema() {
+		return array(
+			'type'       => 'object',
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
 	}
 }

file update:
diff --git a/docs/openapi.json b/docs/openapi.json
new file mode 100644
index 0000000000000000000000000000000000000000..849f15d93104fabd8a394dc4195b96a609c010a0
--- /dev/null
+++ b/docs/openapi.json
@@ -0,0 +1,503 @@
+{
+  "openapi": "3.0.3",
+  "info": {
+    "title": "AgentWP REST API",
+    "version": "0.1.0",
+    "description": "OpenAPI specification for AgentWP REST endpoints."
+  },
+  "servers": [
+    {
+      "url": "/wp-json"
+    }
+  ],
+  "paths": {
+    "/agentwp/v1/intent": {
+      "post": {
+        "summary": "Submit an intent",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": true,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/IntentRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Intent accepted",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/IntentResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          },
+          "429": {
+            "description": "Rate limit exceeded",
+            "headers": {
+              "Retry-After": {
+                "schema": {
+                  "type": "integer"
+                }
+              }
+            },
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings": {
+      "get": {
+        "summary": "Get settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Settings payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          }
+        }
+      },
+      "post": {
+        "summary": "Update settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/SettingsUpdateRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Updated settings",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings/api-key": {
+      "post": {
+        "summary": "Store OpenAI API key",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/ApiKeyRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "API key stored",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ApiKeyResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid API key",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/usage": {
+      "get": {
+        "summary": "Get usage stats",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "parameters": [
+          {
+            "name": "period",
+            "in": "query",
+            "schema": {
+              "type": "string",
+              "enum": [
+                "day",
+                "week",
+                "month"
+              ]
+            }
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Usage stats",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/UsageResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid period",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/health": {
+      "get": {
+        "summary": "Health check",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Health status",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/HealthResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    }
+  },
+  "components": {
+    "securitySchemes": {
+      "nonceAuth": {
+        "type": "apiKey",
+        "in": "header",
+        "name": "X-WP-Nonce"
+      }
+    },
+    "schemas": {
+      "StandardResponse": {
+        "type": "object",
+        "required": [
+          "success",
+          "data"
+        ],
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {},
+          "error": {
+            "$ref": "#/components/schemas/ErrorObject"
+          }
+        }
+      },
+      "ErrorObject": {
+        "type": "object",
+        "required": [
+          "code",
+          "message"
+        ],
+        "properties": {
+          "code": {
+            "type": "string"
+          },
+          "message": {
+            "type": "string"
+          }
+        }
+      },
+      "ErrorResponse": {
+        "allOf": [
+          {
+            "$ref": "#/components/schemas/StandardResponse"
+          }
+        ]
+      },
+      "Settings": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string"
+          },
+          "budget_limit": {
+            "type": "number"
+          },
+          "draft_ttl_minutes": {
+            "type": "integer"
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string"
+          }
+        }
+      },
+      "SettingsResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "settings": {
+                "$ref": "#/components/schemas/Settings"
+              },
+              "api_key_last4": {
+                "type": "string"
+              },
+              "has_api_key": {
+                "type": "boolean"
+              },
+              "api_key_status": {
+                "type": "string"
+              },
+              "updated": {
+                "type": "boolean"
+              },
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "SettingsUpdateRequest": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string",
+            "enum": [
+              "gpt-4o",
+              "gpt-4o-mini"
+            ]
+          },
+          "budget_limit": {
+            "type": "number",
+            "minimum": 0
+          },
+          "draft_ttl_minutes": {
+            "type": "integer",
+            "minimum": 0
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string",
+            "enum": [
+              "light",
+              "dark"
+            ]
+          },
+          "dark_mode": {
+            "type": "boolean"
+          }
+        }
+      },
+      "ApiKeyRequest": {
+        "type": "object",
+        "properties": {
+          "api_key": {
+            "type": "string"
+          }
+        }
+      },
+      "ApiKeyResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "stored": {
+                "type": "boolean"
+              },
+              "last4": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "Usage": {
+        "type": "object",
+        "properties": {
+          "total_commands_month": {
+            "type": "integer"
+          },
+          "estimated_cost": {
+            "type": "number"
+          },
+          "last_sync": {
+            "type": "string"
+          }
+        }
+      },
+      "UsageResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "IntentRequest": {
+        "type": "object",
+        "required": [
+          "prompt"
+        ],
+        "properties": {
+          "prompt": {
+            "type": "string"
+          },
+          "context": {
+            "type": "object"
+          },
+          "metadata": {
+            "type": "object"
+          }
+        }
+      },
+      "IntentResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "intent_id": {
+                "type": "string"
+              },
+              "status": {
+                "type": "string"
+              },
+              "message": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "HealthResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "status": {
+                "type": "string"
+              },
+              "time": {
+                "type": "string"
+              },
+              "version": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      }
+    }
+  }
+}
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..eac56f1e329814c21a91d4df339ba79f684e40d0
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,209 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Request;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Plugin.php b/src/Plugin.php
index 98ff7ef58454d6f962b466d44ec14f8341d83ba0..bd440acbba688b48814b89a88c4bca62856fc56b
--- a/src/Plugin.php
+++ b/src/Plugin.php
@@ -73,6 +73,7 @@
 		add_action( 'admin_menu', array( $this, 'register_menu' ) );
 		add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_admin_assets' ) );
 		add_action( 'rest_api_init', array( $this, 'register_rest_routes' ) );
+		add_filter( 'rest_post_dispatch', array( $this, 'format_rest_response' ), 10, 3 );
 	}
 
 	/**
@@ -183,6 +184,122 @@
 			$controller = new Rest\SettingsController();
 			$controller->register_routes();
 		}
+
+		if ( class_exists( 'AgentWP\\Rest\\IntentController' ) ) {
+			$controller = new Rest\IntentController();
+			$controller->register_routes();
+		}
+
+		if ( class_exists( 'AgentWP\\Rest\\HealthController' ) ) {
+			$controller = new Rest\HealthController();
+			$controller->register_routes();
+		}
+	}
+
+	/**
+	 * Normalize REST responses and log requests.
+	 *
+	 * @param mixed           $result Response value.
+	 * @param \WP_REST_Server $server REST server instance.
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return mixed
+	 */
+	public function format_rest_response( $result, $server, $request ) {
+		if ( ! $this->is_agentwp_route( $request ) ) {
+			return $result;
+		}
+
+		$status     = 200;
+		$error_code = '';
+
+		if ( is_wp_error( $result ) ) {
+			$error_code = $result->get_error_code();
+			$message    = $result->get_error_message();
+			$data       = $result->get_error_data();
+			$status     = ( is_array( $data ) && isset( $data['status'] ) ) ? intval( $data['status'] ) : 500;
+
+			$response = rest_ensure_response(
+				array(
+					'success' => false,
+					'data'    => array(),
+					'error'   => array(
+						'code'    => $error_code,
+						'message' => $message,
+					),
+				)
+			);
+
+			if ( $response instanceof \WP_REST_Response ) {
+				$response->set_status( $status );
+				if ( is_array( $data ) && isset( $data['retry_after'] ) ) {
+					$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+				}
+			}
+
+			$result = $response;
+		} elseif ( $result instanceof \WP_REST_Response ) {
+			$status = $result->get_status();
+			$body   = $result->get_data();
+
+			if ( is_array( $body ) && isset( $body['code'], $body['message'] ) ) {
+				$error_code = (string) $body['code'];
+				$message    = (string) $body['message'];
+				$data       = isset( $body['data'] ) && is_array( $body['data'] ) ? $body['data'] : array();
+				$status     = isset( $data['status'] ) ? intval( $data['status'] ) : $status;
+
+				$response = rest_ensure_response(
+					array(
+						'success' => false,
+						'data'    => array(),
+						'error'   => array(
+							'code'    => $error_code,
+							'message' => $message,
+						),
+					)
+				);
+
+				if ( $response instanceof \WP_REST_Response ) {
+					$response->set_status( $status );
+					if ( isset( $data['retry_after'] ) ) {
+						$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+					}
+				}
+
+				$result = $response;
+			} elseif ( is_array( $body ) && isset( $body['error']['code'] ) ) {
+				$error_code = (string) $body['error']['code'];
+			}
+		} else {
+			$result = rest_ensure_response(
+				array(
+					'success' => true,
+					'data'    => $result,
+				)
+			);
+
+			if ( $result instanceof \WP_REST_Response ) {
+				$status = $result->get_status();
+			}
+		}
+
+		if ( class_exists( 'AgentWP\\API\\RestController' ) ) {
+			API\RestController::log_request( $request, $status, $error_code );
+		}
+
+		return $result;
+	}
+
+	/**
+	 * Check whether request targets AgentWP REST routes.
+	 *
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return bool
+	 */
+	private function is_agentwp_route( $request ) {
+		$route = $request->get_route();
+		$route = is_string( $route ) ? $route : '';
+
+		return ( 0 === strpos( $route, '/' . API\RestController::REST_NAMESPACE ) );
 	}
 
 	/**
diff --git a/src/Rest/HealthController.php b/src/Rest/HealthController.php
new file mode 100644
index 0000000000000000000000000000000000000000..6b7dbdf666ad027953e52ec22de6c59a24c53f4b
--- /dev/null
+++ b/src/Rest/HealthController.php
@@ -0,0 +1,46 @@
+<?php
+/**
+ * Health REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Server;
+
+class HealthController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/health',
+			array(
+				'methods'             => WP_REST_Server::READABLE,
+				'callback'            => array( $this, 'get_health' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Return health status.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function get_health( $request ) {
+		return $this->response_success(
+			array(
+				'status'  => 'ok',
+				'time'    => gmdate( 'c' ),
+				'version' => defined( 'AGENTWP_VERSION' ) ? AGENTWP_VERSION : '',
+			)
+		);
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..027bca1a35799ff06be0baeebaff07a26376a73f
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,75 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'     => 'object',
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..5568099e4d147ab04844a6d3a7253f0a90c7a97a
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,18 +7,13 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
-use WP_REST_Request;
-use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +22,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +34,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +89,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +116,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +171,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +331,72 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
+	}
 
-		return $response;
+	/**
+	 * Schema for API key payload.
+	 *
+	 * @return array
+	 */
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
+				),
+			),
+		);
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for usage query params.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_usage_schema() {
+		return array(
+			'type'       => 'object',
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
 	}
 }


thinking
**Reviewing and cleaning imports**
file update
M /Users/ahmedyounis/Documents/Projects/agentwp/src/API/RestController.php
@@ -12,3 +12,2 @@
 use WP_REST_Controller;
-use WP_REST_Request;
 use WP_REST_Response;
apply_patch(auto_approved=true) exited 0 in 56ms:
Success. Updated the following files:
M src/API/RestController.php
file update:
diff --git a/docs/openapi.json b/docs/openapi.json
new file mode 100644
index 0000000000000000000000000000000000000000..849f15d93104fabd8a394dc4195b96a609c010a0
--- /dev/null
+++ b/docs/openapi.json
@@ -0,0 +1,503 @@
+{
+  "openapi": "3.0.3",
+  "info": {
+    "title": "AgentWP REST API",
+    "version": "0.1.0",
+    "description": "OpenAPI specification for AgentWP REST endpoints."
+  },
+  "servers": [
+    {
+      "url": "/wp-json"
+    }
+  ],
+  "paths": {
+    "/agentwp/v1/intent": {
+      "post": {
+        "summary": "Submit an intent",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": true,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/IntentRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Intent accepted",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/IntentResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          },
+          "429": {
+            "description": "Rate limit exceeded",
+            "headers": {
+              "Retry-After": {
+                "schema": {
+                  "type": "integer"
+                }
+              }
+            },
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings": {
+      "get": {
+        "summary": "Get settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Settings payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          }
+        }
+      },
+      "post": {
+        "summary": "Update settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/SettingsUpdateRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Updated settings",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings/api-key": {
+      "post": {
+        "summary": "Store OpenAI API key",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/ApiKeyRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "API key stored",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ApiKeyResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid API key",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/usage": {
+      "get": {
+        "summary": "Get usage stats",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "parameters": [
+          {
+            "name": "period",
+            "in": "query",
+            "schema": {
+              "type": "string",
+              "enum": [
+                "day",
+                "week",
+                "month"
+              ]
+            }
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Usage stats",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/UsageResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid period",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/health": {
+      "get": {
+        "summary": "Health check",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Health status",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/HealthResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    }
+  },
+  "components": {
+    "securitySchemes": {
+      "nonceAuth": {
+        "type": "apiKey",
+        "in": "header",
+        "name": "X-WP-Nonce"
+      }
+    },
+    "schemas": {
+      "StandardResponse": {
+        "type": "object",
+        "required": [
+          "success",
+          "data"
+        ],
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {},
+          "error": {
+            "$ref": "#/components/schemas/ErrorObject"
+          }
+        }
+      },
+      "ErrorObject": {
+        "type": "object",
+        "required": [
+          "code",
+          "message"
+        ],
+        "properties": {
+          "code": {
+            "type": "string"
+          },
+          "message": {
+            "type": "string"
+          }
+        }
+      },
+      "ErrorResponse": {
+        "allOf": [
+          {
+            "$ref": "#/components/schemas/StandardResponse"
+          }
+        ]
+      },
+      "Settings": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string"
+          },
+          "budget_limit": {
+            "type": "number"
+          },
+          "draft_ttl_minutes": {
+            "type": "integer"
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string"
+          }
+        }
+      },
+      "SettingsResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "settings": {
+                "$ref": "#/components/schemas/Settings"
+              },
+              "api_key_last4": {
+                "type": "string"
+              },
+              "has_api_key": {
+                "type": "boolean"
+              },
+              "api_key_status": {
+                "type": "string"
+              },
+              "updated": {
+                "type": "boolean"
+              },
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "SettingsUpdateRequest": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string",
+            "enum": [
+              "gpt-4o",
+              "gpt-4o-mini"
+            ]
+          },
+          "budget_limit": {
+            "type": "number",
+            "minimum": 0
+          },
+          "draft_ttl_minutes": {
+            "type": "integer",
+            "minimum": 0
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string",
+            "enum": [
+              "light",
+              "dark"
+            ]
+          },
+          "dark_mode": {
+            "type": "boolean"
+          }
+        }
+      },
+      "ApiKeyRequest": {
+        "type": "object",
+        "properties": {
+          "api_key": {
+            "type": "string"
+          }
+        }
+      },
+      "ApiKeyResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "stored": {
+                "type": "boolean"
+              },
+              "last4": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "Usage": {
+        "type": "object",
+        "properties": {
+          "total_commands_month": {
+            "type": "integer"
+          },
+          "estimated_cost": {
+            "type": "number"
+          },
+          "last_sync": {
+            "type": "string"
+          }
+        }
+      },
+      "UsageResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "IntentRequest": {
+        "type": "object",
+        "required": [
+          "prompt"
+        ],
+        "properties": {
+          "prompt": {
+            "type": "string"
+          },
+          "context": {
+            "type": "object"
+          },
+          "metadata": {
+            "type": "object"
+          }
+        }
+      },
+      "IntentResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "intent_id": {
+                "type": "string"
+              },
+              "status": {
+                "type": "string"
+              },
+              "message": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "HealthResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "status": {
+                "type": "string"
+              },
+              "time": {
+                "type": "string"
+              },
+              "version": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      }
+    }
+  }
+}
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..22966275ec827a7d59fea9ef18328b922bc94cf8
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,208 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Plugin.php b/src/Plugin.php
index 98ff7ef58454d6f962b466d44ec14f8341d83ba0..bd440acbba688b48814b89a88c4bca62856fc56b
--- a/src/Plugin.php
+++ b/src/Plugin.php
@@ -73,6 +73,7 @@
 		add_action( 'admin_menu', array( $this, 'register_menu' ) );
 		add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_admin_assets' ) );
 		add_action( 'rest_api_init', array( $this, 'register_rest_routes' ) );
+		add_filter( 'rest_post_dispatch', array( $this, 'format_rest_response' ), 10, 3 );
 	}
 
 	/**
@@ -183,6 +184,122 @@
 			$controller = new Rest\SettingsController();
 			$controller->register_routes();
 		}
+
+		if ( class_exists( 'AgentWP\\Rest\\IntentController' ) ) {
+			$controller = new Rest\IntentController();
+			$controller->register_routes();
+		}
+
+		if ( class_exists( 'AgentWP\\Rest\\HealthController' ) ) {
+			$controller = new Rest\HealthController();
+			$controller->register_routes();
+		}
+	}
+
+	/**
+	 * Normalize REST responses and log requests.
+	 *
+	 * @param mixed           $result Response value.
+	 * @param \WP_REST_Server $server REST server instance.
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return mixed
+	 */
+	public function format_rest_response( $result, $server, $request ) {
+		if ( ! $this->is_agentwp_route( $request ) ) {
+			return $result;
+		}
+
+		$status     = 200;
+		$error_code = '';
+
+		if ( is_wp_error( $result ) ) {
+			$error_code = $result->get_error_code();
+			$message    = $result->get_error_message();
+			$data       = $result->get_error_data();
+			$status     = ( is_array( $data ) && isset( $data['status'] ) ) ? intval( $data['status'] ) : 500;
+
+			$response = rest_ensure_response(
+				array(
+					'success' => false,
+					'data'    => array(),
+					'error'   => array(
+						'code'    => $error_code,
+						'message' => $message,
+					),
+				)
+			);
+
+			if ( $response instanceof \WP_REST_Response ) {
+				$response->set_status( $status );
+				if ( is_array( $data ) && isset( $data['retry_after'] ) ) {
+					$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+				}
+			}
+
+			$result = $response;
+		} elseif ( $result instanceof \WP_REST_Response ) {
+			$status = $result->get_status();
+			$body   = $result->get_data();
+
+			if ( is_array( $body ) && isset( $body['code'], $body['message'] ) ) {
+				$error_code = (string) $body['code'];
+				$message    = (string) $body['message'];
+				$data       = isset( $body['data'] ) && is_array( $body['data'] ) ? $body['data'] : array();
+				$status     = isset( $data['status'] ) ? intval( $data['status'] ) : $status;
+
+				$response = rest_ensure_response(
+					array(
+						'success' => false,
+						'data'    => array(),
+						'error'   => array(
+							'code'    => $error_code,
+							'message' => $message,
+						),
+					)
+				);
+
+				if ( $response instanceof \WP_REST_Response ) {
+					$response->set_status( $status );
+					if ( isset( $data['retry_after'] ) ) {
+						$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+					}
+				}
+
+				$result = $response;
+			} elseif ( is_array( $body ) && isset( $body['error']['code'] ) ) {
+				$error_code = (string) $body['error']['code'];
+			}
+		} else {
+			$result = rest_ensure_response(
+				array(
+					'success' => true,
+					'data'    => $result,
+				)
+			);
+
+			if ( $result instanceof \WP_REST_Response ) {
+				$status = $result->get_status();
+			}
+		}
+
+		if ( class_exists( 'AgentWP\\API\\RestController' ) ) {
+			API\RestController::log_request( $request, $status, $error_code );
+		}
+
+		return $result;
+	}
+
+	/**
+	 * Check whether request targets AgentWP REST routes.
+	 *
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return bool
+	 */
+	private function is_agentwp_route( $request ) {
+		$route = $request->get_route();
+		$route = is_string( $route ) ? $route : '';
+
+		return ( 0 === strpos( $route, '/' . API\RestController::REST_NAMESPACE ) );
 	}
 
 	/**
diff --git a/src/Rest/HealthController.php b/src/Rest/HealthController.php
new file mode 100644
index 0000000000000000000000000000000000000000..6b7dbdf666ad027953e52ec22de6c59a24c53f4b
--- /dev/null
+++ b/src/Rest/HealthController.php
@@ -0,0 +1,46 @@
+<?php
+/**
+ * Health REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Server;
+
+class HealthController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/health',
+			array(
+				'methods'             => WP_REST_Server::READABLE,
+				'callback'            => array( $this, 'get_health' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Return health status.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function get_health( $request ) {
+		return $this->response_success(
+			array(
+				'status'  => 'ok',
+				'time'    => gmdate( 'c' ),
+				'version' => defined( 'AGENTWP_VERSION' ) ? AGENTWP_VERSION : '',
+			)
+		);
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..027bca1a35799ff06be0baeebaff07a26376a73f
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,75 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'     => 'object',
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..5568099e4d147ab04844a6d3a7253f0a90c7a97a
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,18 +7,13 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
-use WP_REST_Request;
-use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +22,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +34,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +89,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +116,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +171,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +331,72 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
+	}
 
-		return $response;
+	/**
+	 * Schema for API key payload.
+	 *
+	 * @return array
+	 */
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
+				),
+			),
+		);
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for usage query params.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_usage_schema() {
+		return array(
+			'type'       => 'object',
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
 	}
 }

file update:
diff --git a/docs/openapi.json b/docs/openapi.json
new file mode 100644
index 0000000000000000000000000000000000000000..849f15d93104fabd8a394dc4195b96a609c010a0
--- /dev/null
+++ b/docs/openapi.json
@@ -0,0 +1,503 @@
+{
+  "openapi": "3.0.3",
+  "info": {
+    "title": "AgentWP REST API",
+    "version": "0.1.0",
+    "description": "OpenAPI specification for AgentWP REST endpoints."
+  },
+  "servers": [
+    {
+      "url": "/wp-json"
+    }
+  ],
+  "paths": {
+    "/agentwp/v1/intent": {
+      "post": {
+        "summary": "Submit an intent",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": true,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/IntentRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Intent accepted",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/IntentResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          },
+          "429": {
+            "description": "Rate limit exceeded",
+            "headers": {
+              "Retry-After": {
+                "schema": {
+                  "type": "integer"
+                }
+              }
+            },
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings": {
+      "get": {
+        "summary": "Get settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Settings payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          }
+        }
+      },
+      "post": {
+        "summary": "Update settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/SettingsUpdateRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Updated settings",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings/api-key": {
+      "post": {
+        "summary": "Store OpenAI API key",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/ApiKeyRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "API key stored",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ApiKeyResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid API key",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/usage": {
+      "get": {
+        "summary": "Get usage stats",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "parameters": [
+          {
+            "name": "period",
+            "in": "query",
+            "schema": {
+              "type": "string",
+              "enum": [
+                "day",
+                "week",
+                "month"
+              ]
+            }
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Usage stats",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/UsageResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid period",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/health": {
+      "get": {
+        "summary": "Health check",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Health status",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/HealthResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    }
+  },
+  "components": {
+    "securitySchemes": {
+      "nonceAuth": {
+        "type": "apiKey",
+        "in": "header",
+        "name": "X-WP-Nonce"
+      }
+    },
+    "schemas": {
+      "StandardResponse": {
+        "type": "object",
+        "required": [
+          "success",
+          "data"
+        ],
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {},
+          "error": {
+            "$ref": "#/components/schemas/ErrorObject"
+          }
+        }
+      },
+      "ErrorObject": {
+        "type": "object",
+        "required": [
+          "code",
+          "message"
+        ],
+        "properties": {
+          "code": {
+            "type": "string"
+          },
+          "message": {
+            "type": "string"
+          }
+        }
+      },
+      "ErrorResponse": {
+        "allOf": [
+          {
+            "$ref": "#/components/schemas/StandardResponse"
+          }
+        ]
+      },
+      "Settings": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string"
+          },
+          "budget_limit": {
+            "type": "number"
+          },
+          "draft_ttl_minutes": {
+            "type": "integer"
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string"
+          }
+        }
+      },
+      "SettingsResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "settings": {
+                "$ref": "#/components/schemas/Settings"
+              },
+              "api_key_last4": {
+                "type": "string"
+              },
+              "has_api_key": {
+                "type": "boolean"
+              },
+              "api_key_status": {
+                "type": "string"
+              },
+              "updated": {
+                "type": "boolean"
+              },
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "SettingsUpdateRequest": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string",
+            "enum": [
+              "gpt-4o",
+              "gpt-4o-mini"
+            ]
+          },
+          "budget_limit": {
+            "type": "number",
+            "minimum": 0
+          },
+          "draft_ttl_minutes": {
+            "type": "integer",
+            "minimum": 0
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string",
+            "enum": [
+              "light",
+              "dark"
+            ]
+          },
+          "dark_mode": {
+            "type": "boolean"
+          }
+        }
+      },
+      "ApiKeyRequest": {
+        "type": "object",
+        "properties": {
+          "api_key": {
+            "type": "string"
+          }
+        }
+      },
+      "ApiKeyResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "stored": {
+                "type": "boolean"
+              },
+              "last4": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "Usage": {
+        "type": "object",
+        "properties": {
+          "total_commands_month": {
+            "type": "integer"
+          },
+          "estimated_cost": {
+            "type": "number"
+          },
+          "last_sync": {
+            "type": "string"
+          }
+        }
+      },
+      "UsageResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "IntentRequest": {
+        "type": "object",
+        "required": [
+          "prompt"
+        ],
+        "properties": {
+          "prompt": {
+            "type": "string"
+          },
+          "context": {
+            "type": "object"
+          },
+          "metadata": {
+            "type": "object"
+          }
+        }
+      },
+      "IntentResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "intent_id": {
+                "type": "string"
+              },
+              "status": {
+                "type": "string"
+              },
+              "message": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "HealthResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "status": {
+                "type": "string"
+              },
+              "time": {
+                "type": "string"
+              },
+              "version": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      }
+    }
+  }
+}
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..22966275ec827a7d59fea9ef18328b922bc94cf8
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,208 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Plugin.php b/src/Plugin.php
index 98ff7ef58454d6f962b466d44ec14f8341d83ba0..bd440acbba688b48814b89a88c4bca62856fc56b
--- a/src/Plugin.php
+++ b/src/Plugin.php
@@ -73,6 +73,7 @@
 		add_action( 'admin_menu', array( $this, 'register_menu' ) );
 		add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_admin_assets' ) );
 		add_action( 'rest_api_init', array( $this, 'register_rest_routes' ) );
+		add_filter( 'rest_post_dispatch', array( $this, 'format_rest_response' ), 10, 3 );
 	}
 
 	/**
@@ -183,6 +184,122 @@
 			$controller = new Rest\SettingsController();
 			$controller->register_routes();
 		}
+
+		if ( class_exists( 'AgentWP\\Rest\\IntentController' ) ) {
+			$controller = new Rest\IntentController();
+			$controller->register_routes();
+		}
+
+		if ( class_exists( 'AgentWP\\Rest\\HealthController' ) ) {
+			$controller = new Rest\HealthController();
+			$controller->register_routes();
+		}
+	}
+
+	/**
+	 * Normalize REST responses and log requests.
+	 *
+	 * @param mixed           $result Response value.
+	 * @param \WP_REST_Server $server REST server instance.
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return mixed
+	 */
+	public function format_rest_response( $result, $server, $request ) {
+		if ( ! $this->is_agentwp_route( $request ) ) {
+			return $result;
+		}
+
+		$status     = 200;
+		$error_code = '';
+
+		if ( is_wp_error( $result ) ) {
+			$error_code = $result->get_error_code();
+			$message    = $result->get_error_message();
+			$data       = $result->get_error_data();
+			$status     = ( is_array( $data ) && isset( $data['status'] ) ) ? intval( $data['status'] ) : 500;
+
+			$response = rest_ensure_response(
+				array(
+					'success' => false,
+					'data'    => array(),
+					'error'   => array(
+						'code'    => $error_code,
+						'message' => $message,
+					),
+				)
+			);
+
+			if ( $response instanceof \WP_REST_Response ) {
+				$response->set_status( $status );
+				if ( is_array( $data ) && isset( $data['retry_after'] ) ) {
+					$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+				}
+			}
+
+			$result = $response;
+		} elseif ( $result instanceof \WP_REST_Response ) {
+			$status = $result->get_status();
+			$body   = $result->get_data();
+
+			if ( is_array( $body ) && isset( $body['code'], $body['message'] ) ) {
+				$error_code = (string) $body['code'];
+				$message    = (string) $body['message'];
+				$data       = isset( $body['data'] ) && is_array( $body['data'] ) ? $body['data'] : array();
+				$status     = isset( $data['status'] ) ? intval( $data['status'] ) : $status;
+
+				$response = rest_ensure_response(
+					array(
+						'success' => false,
+						'data'    => array(),
+						'error'   => array(
+							'code'    => $error_code,
+							'message' => $message,
+						),
+					)
+				);
+
+				if ( $response instanceof \WP_REST_Response ) {
+					$response->set_status( $status );
+					if ( isset( $data['retry_after'] ) ) {
+						$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+					}
+				}
+
+				$result = $response;
+			} elseif ( is_array( $body ) && isset( $body['error']['code'] ) ) {
+				$error_code = (string) $body['error']['code'];
+			}
+		} else {
+			$result = rest_ensure_response(
+				array(
+					'success' => true,
+					'data'    => $result,
+				)
+			);
+
+			if ( $result instanceof \WP_REST_Response ) {
+				$status = $result->get_status();
+			}
+		}
+
+		if ( class_exists( 'AgentWP\\API\\RestController' ) ) {
+			API\RestController::log_request( $request, $status, $error_code );
+		}
+
+		return $result;
+	}
+
+	/**
+	 * Check whether request targets AgentWP REST routes.
+	 *
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return bool
+	 */
+	private function is_agentwp_route( $request ) {
+		$route = $request->get_route();
+		$route = is_string( $route ) ? $route : '';
+
+		return ( 0 === strpos( $route, '/' . API\RestController::REST_NAMESPACE ) );
 	}
 
 	/**
diff --git a/src/Rest/HealthController.php b/src/Rest/HealthController.php
new file mode 100644
index 0000000000000000000000000000000000000000..6b7dbdf666ad027953e52ec22de6c59a24c53f4b
--- /dev/null
+++ b/src/Rest/HealthController.php
@@ -0,0 +1,46 @@
+<?php
+/**
+ * Health REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Server;
+
+class HealthController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/health',
+			array(
+				'methods'             => WP_REST_Server::READABLE,
+				'callback'            => array( $this, 'get_health' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Return health status.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function get_health( $request ) {
+		return $this->response_success(
+			array(
+				'status'  => 'ok',
+				'time'    => gmdate( 'c' ),
+				'version' => defined( 'AGENTWP_VERSION' ) ? AGENTWP_VERSION : '',
+			)
+		);
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..027bca1a35799ff06be0baeebaff07a26376a73f
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,75 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'     => 'object',
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..5568099e4d147ab04844a6d3a7253f0a90c7a97a
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,18 +7,13 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
-use WP_REST_Request;
-use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +22,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +34,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +89,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +116,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +171,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +331,72 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
+	}
 
-		return $response;
+	/**
+	 * Schema for API key payload.
+	 *
+	 * @return array
+	 */
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
+				),
+			),
+		);
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for usage query params.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_usage_schema() {
+		return array(
+			'type'       => 'object',
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
 	}
 }

Reconnecting... 1/5

thinking
**Summarizing final review and response preparation**

I’m wrapping up by confirming all code cleanup, validation, and response formatting are solid, checking namespace use, rate limiting, and logging details. I’m also preparing the final formatted answer with status, summary, verification steps, and risks/follow-ups as requested, noting no tests run and potential follow-up tasks.
codex
Implemented a shared REST base controller with auth, rate limiting, schema validation, standardized responses, and logging; added intent/health endpoints and an OpenAPI spec to document the API.

**Status**
- DONE

**Summary of changes**
- Added base REST controller with auth, rate limiting, schema validation, response formatting, and transient logging in `src/API/RestController.php`.
- Updated settings/usage/api-key routes to use the base controller and JSON schema validation in `src/Rest/SettingsController.php`.
- Added new `/intent` and `/health` endpoints in `src/Rest/IntentController.php` and `src/Rest/HealthController.php`, and wired them with response normalization/logging in `src/Plugin.php`.
- Generated OpenAPI spec covering the REST endpoints in `docs/openapi.json`.

**How to verify**
- No format/lint/test commands provided.

**Risks / follow-ups**
- `/intent` currently returns a stub response (no AI processing yet) in `src/Rest/IntentController.php`.
- Settings/api-key schema validation is strict; unknown fields will be rejected in `src/Rest/SettingsController.php`.
- No automated tests were run (none specified).
file update:
diff --git a/docs/openapi.json b/docs/openapi.json
new file mode 100644
index 0000000000000000000000000000000000000000..849f15d93104fabd8a394dc4195b96a609c010a0
--- /dev/null
+++ b/docs/openapi.json
@@ -0,0 +1,503 @@
+{
+  "openapi": "3.0.3",
+  "info": {
+    "title": "AgentWP REST API",
+    "version": "0.1.0",
+    "description": "OpenAPI specification for AgentWP REST endpoints."
+  },
+  "servers": [
+    {
+      "url": "/wp-json"
+    }
+  ],
+  "paths": {
+    "/agentwp/v1/intent": {
+      "post": {
+        "summary": "Submit an intent",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": true,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/IntentRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Intent accepted",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/IntentResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          },
+          "429": {
+            "description": "Rate limit exceeded",
+            "headers": {
+              "Retry-After": {
+                "schema": {
+                  "type": "integer"
+                }
+              }
+            },
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings": {
+      "get": {
+        "summary": "Get settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Settings payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          }
+        }
+      },
+      "post": {
+        "summary": "Update settings",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/SettingsUpdateRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "Updated settings",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/SettingsResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid payload",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/settings/api-key": {
+      "post": {
+        "summary": "Store OpenAI API key",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "requestBody": {
+          "required": false,
+          "content": {
+            "application/json": {
+              "schema": {
+                "$ref": "#/components/schemas/ApiKeyRequest"
+              }
+            }
+          }
+        },
+        "responses": {
+          "200": {
+            "description": "API key stored",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ApiKeyResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid API key",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/usage": {
+      "get": {
+        "summary": "Get usage stats",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "parameters": [
+          {
+            "name": "period",
+            "in": "query",
+            "schema": {
+              "type": "string",
+              "enum": [
+                "day",
+                "week",
+                "month"
+              ]
+            }
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Usage stats",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/UsageResponse"
+                }
+              }
+            }
+          },
+          "400": {
+            "description": "Invalid period",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/ErrorResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    },
+    "/agentwp/v1/health": {
+      "get": {
+        "summary": "Health check",
+        "security": [
+          {
+            "nonceAuth": []
+          }
+        ],
+        "responses": {
+          "200": {
+            "description": "Health status",
+            "content": {
+              "application/json": {
+                "schema": {
+                  "$ref": "#/components/schemas/HealthResponse"
+                }
+              }
+            }
+          }
+        }
+      }
+    }
+  },
+  "components": {
+    "securitySchemes": {
+      "nonceAuth": {
+        "type": "apiKey",
+        "in": "header",
+        "name": "X-WP-Nonce"
+      }
+    },
+    "schemas": {
+      "StandardResponse": {
+        "type": "object",
+        "required": [
+          "success",
+          "data"
+        ],
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {},
+          "error": {
+            "$ref": "#/components/schemas/ErrorObject"
+          }
+        }
+      },
+      "ErrorObject": {
+        "type": "object",
+        "required": [
+          "code",
+          "message"
+        ],
+        "properties": {
+          "code": {
+            "type": "string"
+          },
+          "message": {
+            "type": "string"
+          }
+        }
+      },
+      "ErrorResponse": {
+        "allOf": [
+          {
+            "$ref": "#/components/schemas/StandardResponse"
+          }
+        ]
+      },
+      "Settings": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string"
+          },
+          "budget_limit": {
+            "type": "number"
+          },
+          "draft_ttl_minutes": {
+            "type": "integer"
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string"
+          }
+        }
+      },
+      "SettingsResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "settings": {
+                "$ref": "#/components/schemas/Settings"
+              },
+              "api_key_last4": {
+                "type": "string"
+              },
+              "has_api_key": {
+                "type": "boolean"
+              },
+              "api_key_status": {
+                "type": "string"
+              },
+              "updated": {
+                "type": "boolean"
+              },
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "SettingsUpdateRequest": {
+        "type": "object",
+        "properties": {
+          "model": {
+            "type": "string",
+            "enum": [
+              "gpt-4o",
+              "gpt-4o-mini"
+            ]
+          },
+          "budget_limit": {
+            "type": "number",
+            "minimum": 0
+          },
+          "draft_ttl_minutes": {
+            "type": "integer",
+            "minimum": 0
+          },
+          "hotkey": {
+            "type": "string"
+          },
+          "theme": {
+            "type": "string",
+            "enum": [
+              "light",
+              "dark"
+            ]
+          },
+          "dark_mode": {
+            "type": "boolean"
+          }
+        }
+      },
+      "ApiKeyRequest": {
+        "type": "object",
+        "properties": {
+          "api_key": {
+            "type": "string"
+          }
+        }
+      },
+      "ApiKeyResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "stored": {
+                "type": "boolean"
+              },
+              "last4": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "Usage": {
+        "type": "object",
+        "properties": {
+          "total_commands_month": {
+            "type": "integer"
+          },
+          "estimated_cost": {
+            "type": "number"
+          },
+          "last_sync": {
+            "type": "string"
+          }
+        }
+      },
+      "UsageResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "period": {
+                "type": "string"
+              },
+              "usage": {
+                "$ref": "#/components/schemas/Usage"
+              }
+            }
+          }
+        }
+      },
+      "IntentRequest": {
+        "type": "object",
+        "required": [
+          "prompt"
+        ],
+        "properties": {
+          "prompt": {
+            "type": "string"
+          },
+          "context": {
+            "type": "object"
+          },
+          "metadata": {
+            "type": "object"
+          }
+        }
+      },
+      "IntentResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "intent_id": {
+                "type": "string"
+              },
+              "status": {
+                "type": "string"
+              },
+              "message": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      },
+      "HealthResponse": {
+        "type": "object",
+        "properties": {
+          "success": {
+            "type": "boolean"
+          },
+          "data": {
+            "type": "object",
+            "properties": {
+              "status": {
+                "type": "string"
+              },
+              "time": {
+                "type": "string"
+              },
+              "version": {
+                "type": "string"
+              }
+            }
+          }
+        }
+      }
+    }
+  }
+}
diff --git a/src/API/RestController.php b/src/API/RestController.php
new file mode 100644
index 0000000000000000000000000000000000000000..22966275ec827a7d59fea9ef18328b922bc94cf8
--- /dev/null
+++ b/src/API/RestController.php
@@ -0,0 +1,208 @@
+<?php
+/**
+ * Base REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\API;
+
+use AgentWP\Plugin;
+use WP_Error;
+use WP_REST_Controller;
+use WP_REST_Response;
+
+abstract class RestController extends WP_REST_Controller {
+	const REST_NAMESPACE = 'agentwp/v1';
+	const RATE_LIMIT     = 60;
+	const RATE_WINDOW    = 60;
+	const LOG_LIMIT      = 50;
+
+	public function __construct() {
+		$this->namespace = self::REST_NAMESPACE;
+	}
+
+	/**
+	 * Permissions check for REST endpoints.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public function permissions_check( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return new WP_Error(
+				'agentwp_forbidden',
+				__( 'Sorry, you are not allowed to access AgentWP.', 'agentwp' ),
+				array( 'status' => rest_authorization_required_code() )
+			);
+		}
+
+		$rate_error = self::check_rate_limit( $request );
+		if ( is_wp_error( $rate_error ) ) {
+			return $rate_error;
+		}
+
+		return true;
+	}
+
+	/**
+	 * Validate request payload against a JSON schema.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param array           $schema JSON schema.
+	 * @param string          $source Payload source ("json" or "query").
+	 * @return array|WP_Error
+	 */
+	protected function validate_request( $request, array $schema, $source = 'json' ) {
+		$payload = ( 'query' === $source ) ? $request->get_query_params() : $request->get_json_params();
+		$payload = is_array( $payload ) ? $payload : array();
+
+		$schema['type'] = isset( $schema['type'] ) ? $schema['type'] : 'object';
+		$valid          = rest_validate_value_from_schema( $payload, $schema, 'request' );
+
+		if ( is_wp_error( $valid ) ) {
+			return $valid;
+		}
+
+		return $payload;
+	}
+
+	/**
+	 * Build success response.
+	 *
+	 * @param mixed $data Response data.
+	 * @param int   $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_success( $data, $status = 200 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => true,
+				'data'    => $data,
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Build error response.
+	 *
+	 * @param string $code Error code.
+	 * @param string $message Error message.
+	 * @param int    $status HTTP status.
+	 * @return WP_REST_Response
+	 */
+	protected function response_error( $code, $message, $status = 400 ) {
+		$response = rest_ensure_response(
+			array(
+				'success' => false,
+				'data'    => array(),
+				'error'   => array(
+					'code'    => $code,
+					'message' => $message,
+				),
+			)
+		);
+
+		if ( $response instanceof WP_REST_Response ) {
+			$response->set_status( $status );
+		}
+
+		return $response;
+	}
+
+	/**
+	 * Rate limiter using per-user transients.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return true|WP_Error
+	 */
+	public static function check_rate_limit( $request ) {
+		if ( ! current_user_can( 'manage_woocommerce' ) ) {
+			return true;
+		}
+
+		$user_id = get_current_user_id();
+		if ( $user_id <= 0 ) {
+			return true;
+		}
+
+		$key    = Plugin::TRANSIENT_PREFIX . 'rate_' . $user_id;
+		$bucket = get_transient( $key );
+		$now    = time();
+
+		if ( ! is_array( $bucket ) ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( $now - intval( $bucket['start'] ) >= self::RATE_WINDOW ) {
+			$bucket = array(
+				'start' => $now,
+				'count' => 0,
+			);
+		}
+
+		if ( intval( $bucket['count'] ) >= self::RATE_LIMIT ) {
+			$retry_after = max( 1, self::RATE_WINDOW - ( $now - intval( $bucket['start'] ) ) );
+
+			return new WP_Error(
+				'agentwp_rate_limited',
+				__( 'Rate limit exceeded. Please retry later.', 'agentwp' ),
+				array(
+					'status'      => 429,
+					'retry_after' => $retry_after,
+				)
+			);
+		}
+
+		$bucket['count'] = intval( $bucket['count'] ) + 1;
+		set_transient( $key, $bucket, self::RATE_WINDOW );
+
+		return true;
+	}
+
+	/**
+	 * Log REST request metadata for debugging.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @param int             $status HTTP status.
+	 * @param string          $error_code Optional error code.
+	 * @return void
+	 */
+	public static function log_request( $request, $status, $error_code = '' ) {
+		$user_id = get_current_user_id();
+		$key     = Plugin::TRANSIENT_PREFIX . 'rest_log_' . ( $user_id ? $user_id : 'guest' );
+		$logs    = get_transient( $key );
+		$logs    = is_array( $logs ) ? $logs : array();
+
+		$body      = $request->get_json_params();
+		$body_keys = is_array( $body ) ? array_keys( $body ) : array();
+
+		$entry = array(
+			'time'      => gmdate( 'c' ),
+			'route'     => $request->get_route(),
+			'method'    => $request->get_method(),
+			'status'    => intval( $status ),
+			'error'     => $error_code,
+			'user_id'   => intval( $user_id ),
+			'ip'        => isset( $_SERVER['REMOTE_ADDR'] ) ? sanitize_text_field( wp_unslash( $_SERVER['REMOTE_ADDR'] ) ) : '',
+			'query'     => $request->get_query_params(),
+			'body_keys' => $body_keys,
+		);
+
+		$logs[] = $entry;
+		if ( count( $logs ) > self::LOG_LIMIT ) {
+			$logs = array_slice( $logs, -1 * self::LOG_LIMIT );
+		}
+
+		set_transient( $key, $logs, DAY_IN_SECONDS );
+	}
+}
diff --git a/src/Plugin.php b/src/Plugin.php
index 98ff7ef58454d6f962b466d44ec14f8341d83ba0..bd440acbba688b48814b89a88c4bca62856fc56b
--- a/src/Plugin.php
+++ b/src/Plugin.php
@@ -73,6 +73,7 @@
 		add_action( 'admin_menu', array( $this, 'register_menu' ) );
 		add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_admin_assets' ) );
 		add_action( 'rest_api_init', array( $this, 'register_rest_routes' ) );
+		add_filter( 'rest_post_dispatch', array( $this, 'format_rest_response' ), 10, 3 );
 	}
 
 	/**
@@ -183,6 +184,122 @@
 			$controller = new Rest\SettingsController();
 			$controller->register_routes();
 		}
+
+		if ( class_exists( 'AgentWP\\Rest\\IntentController' ) ) {
+			$controller = new Rest\IntentController();
+			$controller->register_routes();
+		}
+
+		if ( class_exists( 'AgentWP\\Rest\\HealthController' ) ) {
+			$controller = new Rest\HealthController();
+			$controller->register_routes();
+		}
+	}
+
+	/**
+	 * Normalize REST responses and log requests.
+	 *
+	 * @param mixed           $result Response value.
+	 * @param \WP_REST_Server $server REST server instance.
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return mixed
+	 */
+	public function format_rest_response( $result, $server, $request ) {
+		if ( ! $this->is_agentwp_route( $request ) ) {
+			return $result;
+		}
+
+		$status     = 200;
+		$error_code = '';
+
+		if ( is_wp_error( $result ) ) {
+			$error_code = $result->get_error_code();
+			$message    = $result->get_error_message();
+			$data       = $result->get_error_data();
+			$status     = ( is_array( $data ) && isset( $data['status'] ) ) ? intval( $data['status'] ) : 500;
+
+			$response = rest_ensure_response(
+				array(
+					'success' => false,
+					'data'    => array(),
+					'error'   => array(
+						'code'    => $error_code,
+						'message' => $message,
+					),
+				)
+			);
+
+			if ( $response instanceof \WP_REST_Response ) {
+				$response->set_status( $status );
+				if ( is_array( $data ) && isset( $data['retry_after'] ) ) {
+					$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+				}
+			}
+
+			$result = $response;
+		} elseif ( $result instanceof \WP_REST_Response ) {
+			$status = $result->get_status();
+			$body   = $result->get_data();
+
+			if ( is_array( $body ) && isset( $body['code'], $body['message'] ) ) {
+				$error_code = (string) $body['code'];
+				$message    = (string) $body['message'];
+				$data       = isset( $body['data'] ) && is_array( $body['data'] ) ? $body['data'] : array();
+				$status     = isset( $data['status'] ) ? intval( $data['status'] ) : $status;
+
+				$response = rest_ensure_response(
+					array(
+						'success' => false,
+						'data'    => array(),
+						'error'   => array(
+							'code'    => $error_code,
+							'message' => $message,
+						),
+					)
+				);
+
+				if ( $response instanceof \WP_REST_Response ) {
+					$response->set_status( $status );
+					if ( isset( $data['retry_after'] ) ) {
+						$response->header( 'Retry-After', (string) intval( $data['retry_after'] ) );
+					}
+				}
+
+				$result = $response;
+			} elseif ( is_array( $body ) && isset( $body['error']['code'] ) ) {
+				$error_code = (string) $body['error']['code'];
+			}
+		} else {
+			$result = rest_ensure_response(
+				array(
+					'success' => true,
+					'data'    => $result,
+				)
+			);
+
+			if ( $result instanceof \WP_REST_Response ) {
+				$status = $result->get_status();
+			}
+		}
+
+		if ( class_exists( 'AgentWP\\API\\RestController' ) ) {
+			API\RestController::log_request( $request, $status, $error_code );
+		}
+
+		return $result;
+	}
+
+	/**
+	 * Check whether request targets AgentWP REST routes.
+	 *
+	 * @param \WP_REST_Request $request Request instance.
+	 * @return bool
+	 */
+	private function is_agentwp_route( $request ) {
+		$route = $request->get_route();
+		$route = is_string( $route ) ? $route : '';
+
+		return ( 0 === strpos( $route, '/' . API\RestController::REST_NAMESPACE ) );
 	}
 
 	/**
diff --git a/src/Rest/HealthController.php b/src/Rest/HealthController.php
new file mode 100644
index 0000000000000000000000000000000000000000..6b7dbdf666ad027953e52ec22de6c59a24c53f4b
--- /dev/null
+++ b/src/Rest/HealthController.php
@@ -0,0 +1,46 @@
+<?php
+/**
+ * Health REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Server;
+
+class HealthController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/health',
+			array(
+				'methods'             => WP_REST_Server::READABLE,
+				'callback'            => array( $this, 'get_health' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Return health status.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function get_health( $request ) {
+		return $this->response_success(
+			array(
+				'status'  => 'ok',
+				'time'    => gmdate( 'c' ),
+				'version' => defined( 'AGENTWP_VERSION' ) ? AGENTWP_VERSION : '',
+			)
+		);
+	}
+}
diff --git a/src/Rest/IntentController.php b/src/Rest/IntentController.php
new file mode 100644
index 0000000000000000000000000000000000000000..027bca1a35799ff06be0baeebaff07a26376a73f
--- /dev/null
+++ b/src/Rest/IntentController.php
@@ -0,0 +1,75 @@
+<?php
+/**
+ * Intent REST controller.
+ *
+ * @package AgentWP
+ */
+
+namespace AgentWP\Rest;
+
+use AgentWP\API\RestController;
+use WP_REST_Server;
+
+class IntentController extends RestController {
+	/**
+	 * Register REST routes.
+	 *
+	 * @return void
+	 */
+	public function register_routes() {
+		register_rest_route(
+			$this->namespace,
+			'/intent',
+			array(
+				'methods'             => WP_REST_Server::CREATABLE,
+				'callback'            => array( $this, 'create_intent' ),
+				'permission_callback' => array( $this, 'permissions_check' ),
+			)
+		);
+	}
+
+	/**
+	 * Handle intent requests.
+	 *
+	 * @param WP_REST_Request $request Request instance.
+	 * @return \WP_REST_Response
+	 */
+	public function create_intent( $request ) {
+		$validation = $this->validate_request( $request, $this->get_intent_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
+		return $this->response_success(
+			array(
+				'intent_id' => wp_generate_uuid4(),
+				'status'    => 'received',
+				'message'   => __( 'Intent received for processing.', 'agentwp' ),
+			)
+		);
+	}
+
+	/**
+	 * Schema for intent payload.
+	 *
+	 * @return array
+	 */
+	private function get_intent_schema() {
+		return array(
+			'type'     => 'object',
+			'required'             => array( 'prompt' ),
+			'properties'           => array(
+				'prompt'   => array(
+					'type'      => 'string',
+					'minLength' => 1,
+				),
+				'context'  => array(
+					'type' => 'object',
+				),
+				'metadata' => array(
+					'type' => 'object',
+				),
+			),
+		);
+	}
+}
diff --git a/src/Rest/SettingsController.php b/src/Rest/SettingsController.php
index 4902eb7c7562806eb5166753f39c2cbc83e85a81..5568099e4d147ab04844a6d3a7253f0a90c7a97a
--- a/src/Rest/SettingsController.php
+++ b/src/Rest/SettingsController.php
@@ -7,18 +7,13 @@
 
 namespace AgentWP\Rest;
 
+use AgentWP\API\RestController;
 use AgentWP\Plugin;
 use AgentWP\Security\Encryption;
 use WP_Error;
-use WP_REST_Request;
-use WP_REST_Response;
 use WP_REST_Server;
 
-class SettingsController {
-	/**
-	 * REST namespace.
-	 */
-	const REST_NAMESPACE = 'agentwp/v1';
+class SettingsController extends RestController {
 
 	/**
 	 * Register REST routes.
@@ -27,7 +22,7 @@
 	 */
 	public function register_routes() {
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings',
 			array(
 				array(
@@ -39,69 +34,29 @@
 					'methods'             => WP_REST_Server::EDITABLE,
 					'callback'            => array( $this, 'update_settings' ),
 					'permission_callback' => array( $this, 'permissions_check' ),
-					'args'                => array(
-						'model'     => array(
-							'type' => 'string',
-						),
-						'budget_limit' => array(
-							'type' => 'number',
-						),
-						'draft_ttl_minutes' => array(
-							'type' => 'integer',
-						),
-						'hotkey'    => array(
-							'type' => 'string',
-						),
-						'theme'     => array(
-							'type' => 'string',
-						),
-						'dark_mode' => array(
-							'type' => 'boolean',
-						),
-					),
 				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/settings/api-key',
 			array(
 				'methods'             => WP_REST_Server::EDITABLE,
 				'callback'            => array( $this, 'update_api_key' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'api_key' => array(
-						'type' => 'string',
-					),
-				),
 			)
 		);
 
 		register_rest_route(
-			self::REST_NAMESPACE,
+			$this->namespace,
 			'/usage',
 			array(
 				'methods'             => WP_REST_Server::READABLE,
 				'callback'            => array( $this, 'get_usage' ),
 				'permission_callback' => array( $this, 'permissions_check' ),
-				'args'                => array(
-					'period' => array(
-						'type'    => 'string',
-						'default' => 'month',
-					),
-				),
 			)
 		);
-	}
-
-	/**
-	 * Permissions check for settings routes.
-	 *
-	 * @return bool
-	 */
-	public function permissions_check() {
-		return current_user_can( 'manage_woocommerce' );
 	}
 
 	/**
@@ -134,6 +89,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_settings( $request ) {
+		$validation = $this->validate_request( $request, $this->get_settings_update_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload  = $request->get_json_params();
 		$payload  = is_array( $payload ) ? $payload : array();
 		$settings = $this->read_settings();
@@ -156,6 +116,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function update_api_key( $request ) {
+		$validation = $this->validate_request( $request, $this->get_api_key_schema() );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$payload = $request->get_json_params();
 		$payload = is_array( $payload ) ? $payload : array();
 		$api_key = isset( $payload['api_key'] ) ? sanitize_text_field( wp_unslash( $payload['api_key'] ) ) : '';
@@ -206,6 +171,11 @@
 	 * @return WP_REST_Response
 	 */
 	public function get_usage( $request ) {
+		$validation = $this->validate_request( $request, $this->get_usage_schema(), 'query' );
+		if ( is_wp_error( $validation ) ) {
+			return $this->response_error( 'agentwp_invalid_request', $validation->get_error_message(), 400 );
+		}
+
 		$period = $request->get_param( 'period' );
 		$period = is_string( $period ) ? sanitize_text_field( $period ) : 'month';
 
@@ -361,47 +331,72 @@
 	}
 
 	/**
-	 * Format success response.
+	 * Schema for settings update payload.
 	 *
-	 * @param array $data Response data.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_success( array $data ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => true,
-				'data'    => $data,
-				'error'   => (object) array(),
-			)
+	private function get_settings_update_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'model'             => array(
+					'type' => 'string',
+					'enum' => array( 'gpt-4o', 'gpt-4o-mini' ),
+				),
+				'budget_limit'      => array(
+					'type'    => 'number',
+					'minimum' => 0,
+				),
+				'draft_ttl_minutes' => array(
+					'type'    => 'integer',
+					'minimum' => 0,
+				),
+				'hotkey'            => array(
+					'type' => 'string',
+				),
+				'theme'             => array(
+					'type' => 'string',
+					'enum' => array( 'light', 'dark' ),
+				),
+				'dark_mode'         => array(
+					'type' => 'boolean',
+				),
+			),
 		);
+	}
 
-		return $response;
+	/**
+	 * Schema for API key payload.
+	 *
+	 * @return array
+	 */
+	private function get_api_key_schema() {
+		return array(
+			'type'                 => 'object',
+			'additionalProperties' => false,
+			'properties'           => array(
+				'api_key' => array(
+					'type' => 'string',
+				),
+			),
+		);
 	}
 
 	/**
-	 * Format error response.
+	 * Schema for usage query params.
 	 *
-	 * @param string $code Error code.
-	 * @param string $message Error message.
-	 * @param int    $status HTTP status.
-	 * @return WP_REST_Response
+	 * @return array
 	 */
-	private function response_error( $code, $message, $status = 400 ) {
-		$response = rest_ensure_response(
-			array(
-				'success' => false,
-				'data'    => array(),
-				'error'   => array(
-					'code'    => $code,
-					'message' => $message,
+	private function get_usage_schema() {
+		return array(
+			'type'       => 'object',
+			'properties'           => array(
+				'period' => array(
+					'type' => 'string',
+					'enum' => array( 'day', 'week', 'month' ),
 				),
-			)
+			),
 		);
-
-		if ( $response instanceof WP_REST_Response ) {
-			$response->set_status( $status );
-		}
-
-		return $response;
 	}
 }

tokens used
130,938
