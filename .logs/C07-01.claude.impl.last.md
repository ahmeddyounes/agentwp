PHPStan passes with no errors. Let me summarize the implementation.

---

**Status: DONE**

## Summary of Changes

### New Files Created:
1. **`src/Contracts/PolicyInterface.php`** - Interface defining capability/policy checks for WooCommerce operations (6 methods: `canManageOrders`, `canManageProducts`, `canRefundOrders`, `canUpdateOrderStatus`, `canManageStock`, `canDraftEmails`)

2. **`src/Security/Policy/WooCommercePolicy.php`** - Implementation of `PolicyInterface` that uses `WPFunctions` wrapper to check capabilities via `manage_woocommerce`

3. **`tests/Fakes/FakePolicy.php`** - Test double for `PolicyInterface` with configurable capability results

### Modified Files:
1. **`src/Services/OrderRefundService.php`** - Injected `PolicyInterface`, replaced `current_user_can()` calls with `$this->policy->canRefundOrders()`

2. **`src/Services/OrderStatusService.php`** - Injected `PolicyInterface`, replaced `current_user_can()` calls with `$this->policy->canUpdateOrderStatus()`

3. **`src/Services/ProductStockService.php`** - Injected `PolicyInterface`, replaced `current_user_can()` calls with `$this->policy->canManageStock()`

4. **`src/Services/EmailDraftService.php`** - Injected `PolicyInterface`, added capability check with `$this->policy->canDraftEmails()`

5. **`src/Providers/InfrastructureServiceProvider.php`** - Registered `PolicyInterface` binding to `WooCommercePolicy`

6. **`src/Providers/ServicesServiceProvider.php`** - Updated service registrations to inject `PolicyInterface` into all domain services

7. **`tests/Integration/Container/ContainerWiringTest.php`** - Added `PolicyInterface` to expected bindings test

## How to Verify

```bash
# Run all tests (344 tests pass)
vendor/bin/phpunit --testdox

# Run specific container wiring tests
vendor/bin/phpunit tests/Integration/Container/ContainerWiringTest.php --testdox

# Verify no direct current_user_can() calls in services
grep -r "current_user_can" src/Services/

# Run PHPCS
vendor/bin/phpcs src/Contracts/PolicyInterface.php src/Security/Policy/WooCommercePolicy.php src/Services/

# Run PHPStan
vendor/bin/phpstan analyse src/Contracts/PolicyInterface.php src/Security/Policy/WooCommercePolicy.php src/Services/ --memory-limit=512M
```

## Risks / Follow-ups

1. **Application layer permission checks remain** - Files like `src/API/RestController.php`, `src/Plugin/AdminMenuManager.php`, and `src/Compatibility/Environment.php` still use direct `current_user_can()` calls. This is acceptable since they are in the application layer, not domain services. However, they could be refactored to use the policy layer in a future task for consistency.

2. **Email capability added** - `EmailDraftService` previously had no capability check; it now has one. This is a behavioral change but aligns with the security model of other services.

3. **Future extensibility** - The policy layer currently maps all capabilities to `manage_woocommerce`. The interface design allows for fine-grained capability mapping in the future (e.g., separate capabilities for refunds vs stock management).
